import os,requests,pdfplumber,boto3,ast,random,re,secrets,string
from project import settings
import pandas as pd
from dashboard import views,models as dshb_models,Connections,columns_extract,clickhouse,Filters
from quickbooks import models,serializers,endpoints_data
import datetime
from io import BytesIO
from pytz import utc
from requests.auth import HTTPBasicAuth
from django.db import transaction
from django.views.decorators.csrf import csrf_exempt
from rest_framework.generics import CreateAPIView
from rest_framework.response import Response
from rest_framework import status
from rest_framework.decorators import api_view
from django.template.loader import render_to_string
from django.core.mail import send_mail
from urllib.parse import urlparse, parse_qs
from requests_oauthlib import OAuth2Session
import json,io
from sqlalchemy import create_engine, Column, Integer, String, VARCHAR, Float, text
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker
import requests
from base64 import b64encode
from django.test import Client,RequestFactory
from django.urls import reverse
from template_dashboards import quickbooks


#### querysets_query
query_table = '''SELECT "Campaign"."type" AS "type", "Campaign"."url" AS "url", "Campaign"."Id" AS "Id", "Campaign"."IsDeleted" AS "IsDeleted", "Campaign"."Name" AS "Name", "Campaign"."ParentId" AS "ParentId", "Campaign"."Type_2" AS "Type_2", "Campaign"."Status" AS "Status", "Campaign"."StartDate" AS "StartDate", "Campaign"."EndDate" AS "EndDate", "Campaign"."ExpectedRevenue" AS "ExpectedRevenue", "Campaign"."BudgetedCost" AS "BudgetedCost", "Campaign"."ActualCost" AS "ActualCost", "Campaign"."ExpectedResponse" AS "ExpectedResponse", "Campaign"."NumberSent" AS "NumberSent", "Campaign"."IsActive" AS "IsActive", "Campaign"."Description" AS "Description", "Campaign"."NumberOfLeads" AS "NumberOfLeads", "Campaign"."NumberOfConvertedLeads" AS "NumberOfConvertedLeads", "Campaign"."NumberOfContacts" AS "NumberOfContacts", "Campaign"."NumberOfResponses" AS "NumberOfResponses", "Campaign"."NumberOfOpportunities" AS "NumberOfOpportunities", "Campaign"."NumberOfWonOpportunities" AS "NumberOfWonOpportunities", "Campaign"."AmountAllOpportunities" AS "AmountAllOpportunities", "Campaign"."AmountWonOpportunities" AS "AmountWonOpportunities", "Campaign"."OwnerId" AS "OwnerId", "Campaign"."CreatedDate" AS "CreatedDate", "Campaign"."CreatedById" AS "CreatedById", "Campaign"."LastModifiedDate" AS "LastModifiedDate", "Campaign"."LastModifiedById" AS "LastModifiedById", "Campaign"."SystemModstamp" AS "SystemModstamp", "Campaign"."LastActivityDate" AS "LastActivityDate", "Campaign"."LastViewedDate" AS "LastViewedDate", "Campaign"."LastReferencedDate" AS "LastReferencedDate", "Campaign"."CampaignMemberRecordTypeId" AS "CampaignMemberRecordTypeId", "AppMenuItem"."type" AS "type(AppMenuItem)", "AppMenuItem"."url" AS "url(AppMenuItem)", "AppMenuItem"."Id" AS "Id(AppMenuItem)", "AppMenuItem"."IsDeleted" AS "IsDeleted(AppMenuItem)", "AppMenuItem"."CreatedDate" AS "CreatedDate(AppMenuItem)", "AppMenuItem"."CreatedById" AS "CreatedById(AppMenuItem)", "AppMenuItem"."LastModifiedDate" AS "LastModifiedDate(AppMenuItem)", "AppMenuItem"."LastModifiedById" AS "LastModifiedById(AppMenuItem)", "AppMenuItem"."SystemModstamp" AS "SystemModstamp(AppMenuItem)", "AppMenuItem"."SortOrder" AS "SortOrder", "AppMenuItem"."Name" AS "Name(AppMenuItem)", "AppMenuItem"."NamespacePrefix" AS "NamespacePrefix", "AppMenuItem"."Label" AS "Label", "AppMenuItem"."Description" AS "Description(AppMenuItem)", "AppMenuItem"."StartUrl" AS "StartUrl", "AppMenuItem"."MobileStartUrl" AS "MobileStartUrl", "AppMenuItem"."LogoUrl" AS "LogoUrl", "AppMenuItem"."IconUrl" AS "IconUrl", "AppMenuItem"."InfoUrl" AS "InfoUrl", "AppMenuItem"."IsUsingAdminAuthorization" AS "IsUsingAdminAuthorization", "AppMenuItem"."MobilePlatform" AS "MobilePlatform", "AppMenuItem"."MobileMinOsVer" AS "MobileMinOsVer", "AppMenuItem"."MobileDeviceType" AS "MobileDeviceType", "AppMenuItem"."IsRegisteredDeviceOnly" AS "IsRegisteredDeviceOnly", "AppMenuItem"."MobileAppVer" AS "MobileAppVer", "AppMenuItem"."MobileAppInstalledDate" AS "MobileAppInstalledDate", "AppMenuItem"."MobileAppInstalledVersion" AS "MobileAppInstalledVersion", "AppMenuItem"."MobileAppBinaryId" AS "MobileAppBinaryId", "AppMenuItem"."MobileAppInstallUrl" AS "MobileAppInstallUrl", "AppMenuItem"."CanvasEnabled" AS "CanvasEnabled", "AppMenuItem"."CanvasReferenceId" AS "CanvasReferenceId", "AppMenuItem"."CanvasUrl" AS "CanvasUrl", "AppMenuItem"."CanvasAccessMethod" AS "CanvasAccessMethod", "AppMenuItem"."CanvasSelectedLocations" AS "CanvasSelectedLocations", "AppMenuItem"."CanvasOptions" AS "CanvasOptions", "AppMenuItem"."Type_2" AS "Type_2(AppMenuItem)", "AppMenuItem"."ApplicationId" AS "ApplicationId", "AppMenuItem"."UserSortOrder" AS "UserSortOrder", "AppMenuItem"."IsVisible" AS "IsVisible", "AppMenuItem"."IsAccessible" AS "IsAccessible", "Contact"."type" AS "type(Contact)", "Contact"."url" AS "url(Contact)", "Contact"."Id" AS "Id(Contact)", "Contact"."IsDeleted" AS "IsDeleted(Contact)", "Contact"."MasterRecordId" AS "MasterRecordId", "Contact"."AccountId" AS "AccountId", "Contact"."LastName" AS "LastName", "Contact"."FirstName" AS "FirstName", "Contact"."Salutation" AS "Salutation", "Contact"."Name" AS "Name(Contact)", "Contact"."OtherStreet" AS "OtherStreet", "Contact"."OtherCity" AS "OtherCity", "Contact"."OtherState" AS "OtherState", "Contact"."OtherPostalCode" AS "OtherPostalCode", "Contact"."OtherCountry" AS "OtherCountry", "Contact"."OtherLatitude" AS "OtherLatitude", "Contact"."OtherLongitude" AS "OtherLongitude", "Contact"."OtherGeocodeAccuracy" AS "OtherGeocodeAccuracy", "Contact"."city" AS "city", "Contact"."country" AS "country", "Contact"."geocodeAccuracy" AS "geocodeAccuracy", "Contact"."latitude" AS "latitude", "Contact"."longitude" AS "longitude", "Contact"."postalCode" AS "postalCode", "Contact"."state" AS "state", "Contact"."street" AS "street", "Contact"."MailingStreet" AS "MailingStreet", "Contact"."MailingCity" AS "MailingCity", "Contact"."MailingState" AS "MailingState", "Contact"."MailingPostalCode" AS "MailingPostalCode", "Contact"."MailingCountry" AS "MailingCountry", "Contact"."MailingLatitude" AS "MailingLatitude", "Contact"."MailingLongitude" AS "MailingLongitude", "Contact"."MailingGeocodeAccuracy" AS "MailingGeocodeAccuracy", "Contact"."Phone" AS "Phone", "Contact"."Fax" AS "Fax", "Contact"."MobilePhone" AS "MobilePhone", "Contact"."HomePhone" AS "HomePhone", "Contact"."OtherPhone" AS "OtherPhone", "Contact"."AssistantPhone" AS "AssistantPhone", "Contact"."ReportsToId" AS "ReportsToId", "Contact"."Email" AS "Email", "Contact"."Title" AS "Title", "Contact"."Department" AS "Department", "Contact"."AssistantName" AS "AssistantName", "Contact"."LeadSource" AS "LeadSource", "Contact"."Birthdate" AS "Birthdate", "Contact"."Description" AS "Description(Contact)", "Contact"."OwnerId" AS "OwnerId(Contact)", "Contact"."CreatedDate" AS "CreatedDate(Contact)", "Contact"."CreatedById" AS "CreatedById(Contact)", "Contact"."LastModifiedDate" AS "LastModifiedDate(Contact)", "Contact"."LastModifiedById" AS "LastModifiedById(Contact)", "Contact"."SystemModstamp" AS "SystemModstamp(Contact)", "Contact"."LastActivityDate" AS "LastActivityDate(Contact)", "Contact"."LastCURequestDate" AS "LastCURequestDate", "Contact"."LastCUUpdateDate" AS "LastCUUpdateDate", "Contact"."LastViewedDate" AS "LastViewedDate(Contact)", "Contact"."LastReferencedDate" AS "LastReferencedDate(Contact)", "Contact"."EmailBouncedReason" AS "EmailBouncedReason", "Contact"."EmailBouncedDate" AS "EmailBouncedDate", "Contact"."IsEmailBounced" AS "IsEmailBounced", "Contact"."PhotoUrl" AS "PhotoUrl", "Contact"."Jigsaw" AS "Jigsaw", "Contact"."JigsawContactId" AS "JigsawContactId", "Contact"."CleanStatus" AS "CleanStatus", "Contact"."IndividualId" AS "IndividualId", "Contact"."Level__c" AS "Level__c", "Contact"."Languages__c" AS "Languages__c", "Contact"."OtherAddress" AS "OtherAddress", "Contact"."MailingAddress" AS "MailingAddress", "Group"."type" AS "type(Group)", "Group"."url" AS "url(Group)", "Group"."Id" AS "Id(Group)", "Group"."Name" AS "Name(Group)", "Group"."DeveloperName" AS "DeveloperName", "Group"."RelatedId" AS "RelatedId", "Group"."Type_2" AS "Type_2(Group)", "Group"."Email" AS "Email(Group)", "Group"."QueueRoutingConfigId" AS "QueueRoutingConfigId", "Group"."OwnerId" AS "OwnerId(Group)", "Group"."DoesSendEmailToMembers" AS "DoesSendEmailToMembers", "Group"."DoesIncludeBosses" AS "DoesIncludeBosses", "Group"."CreatedDate" AS "CreatedDate(Group)", "Group"."CreatedById" AS "CreatedById(Group)", "Group"."LastModifiedDate" AS "LastModifiedDate(Group)", "Group"."LastModifiedById" AS "LastModifiedById(Group)", "Group"."SystemModstamp" AS "SystemModstamp(Group)" FROM "kmadhu@stratapps.com"."Campaign" AS "Campaign" INNER JOIN "kmadhu@stratapps.com"."AppMenuItem" AS "AppMenuItem" ON "Campaign"."SystemModstamp" = "AppMenuItem"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Contact" AS "Contact" ON "Campaign"."SystemModstamp" = "Contact"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Group" AS "Group" ON "Campaign"."SystemModstamp" = "Group"."SystemModstamp"
'''


#### Sheetfilter_query
shft_q1 = '''SELECT "Name(Group)" AS "Name(Group)", COUNT(DISTINCT "Id(Contact)") AS "CNTD(Id(Contact))" FROM (SELECT "Campaign"."type" AS "type", "Campaign"."url" AS "url", "Campaign"."Id" AS "Id", "Campaign"."IsDeleted" AS "IsDeleted", "Campaign"."Name" AS "Name", "Campaign"."ParentId" AS "ParentId", "Campaign"."Type_2" AS "Type_2", "Campaign"."Status" AS "Status", "Campaign"."StartDate" AS "StartDate", "Campaign"."EndDate" AS "EndDate", "Campaign"."ExpectedRevenue" AS "ExpectedRevenue", "Campaign"."BudgetedCost" AS "BudgetedCost", "Campaign"."ActualCost" AS "ActualCost", "Campaign"."ExpectedResponse" AS "ExpectedResponse", "Campaign"."NumberSent" AS "NumberSent", "Campaign"."IsActive" AS "IsActive", "Campaign"."Description" AS "Description", "Campaign"."NumberOfLeads" AS "NumberOfLeads", "Campaign"."NumberOfConvertedLeads" AS "NumberOfConvertedLeads", "Campaign"."NumberOfContacts" AS "NumberOfContacts", "Campaign"."NumberOfResponses" AS "NumberOfResponses", "Campaign"."NumberOfOpportunities" AS "NumberOfOpportunities", "Campaign"."NumberOfWonOpportunities" AS "NumberOfWonOpportunities", "Campaign"."AmountAllOpportunities" AS "AmountAllOpportunities", "Campaign"."AmountWonOpportunities" AS "AmountWonOpportunities", "Campaign"."OwnerId" AS "OwnerId", "Campaign"."CreatedDate" AS "CreatedDate", "Campaign"."CreatedById" AS "CreatedById", "Campaign"."LastModifiedDate" AS "LastModifiedDate", "Campaign"."LastModifiedById" AS "LastModifiedById", "Campaign"."SystemModstamp" AS "SystemModstamp", "Campaign"."LastActivityDate" AS "LastActivityDate", "Campaign"."LastViewedDate" AS "LastViewedDate", "Campaign"."LastReferencedDate" AS "LastReferencedDate", "Campaign"."CampaignMemberRecordTypeId" AS "CampaignMemberRecordTypeId", "AppMenuItem"."type" AS "type(AppMenuItem)", "AppMenuItem"."url" AS "url(AppMenuItem)", "AppMenuItem"."Id" AS "Id(AppMenuItem)", "AppMenuItem"."IsDeleted" AS "IsDeleted(AppMenuItem)", "AppMenuItem"."CreatedDate" AS "CreatedDate(AppMenuItem)", "AppMenuItem"."CreatedById" AS "CreatedById(AppMenuItem)", "AppMenuItem"."LastModifiedDate" AS "LastModifiedDate(AppMenuItem)", "AppMenuItem"."LastModifiedById" AS "LastModifiedById(AppMenuItem)", "AppMenuItem"."SystemModstamp" AS "SystemModstamp(AppMenuItem)", "AppMenuItem"."SortOrder" AS "SortOrder", "AppMenuItem"."Name" AS "Name(AppMenuItem)", "AppMenuItem"."NamespacePrefix" AS "NamespacePrefix", "AppMenuItem"."Label" AS "Label", "AppMenuItem"."Description" AS "Description(AppMenuItem)", "AppMenuItem"."StartUrl" AS "StartUrl", "AppMenuItem"."MobileStartUrl" AS "MobileStartUrl", "AppMenuItem"."LogoUrl" AS "LogoUrl", "AppMenuItem"."IconUrl" AS "IconUrl", "AppMenuItem"."InfoUrl" AS "InfoUrl", "AppMenuItem"."IsUsingAdminAuthorization" AS "IsUsingAdminAuthorization", "AppMenuItem"."MobilePlatform" AS "MobilePlatform", "AppMenuItem"."MobileMinOsVer" AS "MobileMinOsVer", "AppMenuItem"."MobileDeviceType" AS "MobileDeviceType", "AppMenuItem"."IsRegisteredDeviceOnly" AS "IsRegisteredDeviceOnly", "AppMenuItem"."MobileAppVer" AS "MobileAppVer", "AppMenuItem"."MobileAppInstalledDate" AS "MobileAppInstalledDate", "AppMenuItem"."MobileAppInstalledVersion" AS "MobileAppInstalledVersion", "AppMenuItem"."MobileAppBinaryId" AS "MobileAppBinaryId", "AppMenuItem"."MobileAppInstallUrl" AS "MobileAppInstallUrl", "AppMenuItem"."CanvasEnabled" AS "CanvasEnabled", "AppMenuItem"."CanvasReferenceId" AS "CanvasReferenceId", "AppMenuItem"."CanvasUrl" AS "CanvasUrl", "AppMenuItem"."CanvasAccessMethod" AS "CanvasAccessMethod", "AppMenuItem"."CanvasSelectedLocations" AS "CanvasSelectedLocations", "AppMenuItem"."CanvasOptions" AS "CanvasOptions", "AppMenuItem"."Type_2" AS "Type_2(AppMenuItem)", "AppMenuItem"."ApplicationId" AS "ApplicationId", "AppMenuItem"."UserSortOrder" AS "UserSortOrder", "AppMenuItem"."IsVisible" AS "IsVisible", "AppMenuItem"."IsAccessible" AS "IsAccessible", "Contact"."type" AS "type(Contact)", "Contact"."url" AS "url(Contact)", "Contact"."Id" AS "Id(Contact)", "Contact"."IsDeleted" AS "IsDeleted(Contact)", "Contact"."MasterRecordId" AS "MasterRecordId", "Contact"."AccountId" AS "AccountId", "Contact"."LastName" AS "LastName", "Contact"."FirstName" AS "FirstName", "Contact"."Salutation" AS "Salutation", "Contact"."Name" AS "Name(Contact)", "Contact"."OtherStreet" AS "OtherStreet", "Contact"."OtherCity" AS "OtherCity", "Contact"."OtherState" AS "OtherState", "Contact"."OtherPostalCode" AS "OtherPostalCode", "Contact"."OtherCountry" AS "OtherCountry", "Contact"."OtherLatitude" AS "OtherLatitude", "Contact"."OtherLongitude" AS "OtherLongitude", "Contact"."OtherGeocodeAccuracy" AS "OtherGeocodeAccuracy", "Contact"."city" AS "city", "Contact"."country" AS "country", "Contact"."geocodeAccuracy" AS "geocodeAccuracy", "Contact"."latitude" AS "latitude", "Contact"."longitude" AS "longitude", "Contact"."postalCode" AS "postalCode", "Contact"."state" AS "state", "Contact"."street" AS "street", "Contact"."MailingStreet" AS "MailingStreet", "Contact"."MailingCity" AS "MailingCity", "Contact"."MailingState" AS "MailingState", "Contact"."MailingPostalCode" AS "MailingPostalCode", "Contact"."MailingCountry" AS "MailingCountry", "Contact"."MailingLatitude" AS "MailingLatitude", "Contact"."MailingLongitude" AS "MailingLongitude", "Contact"."MailingGeocodeAccuracy" AS "MailingGeocodeAccuracy", "Contact"."Phone" AS "Phone", "Contact"."Fax" AS "Fax", "Contact"."MobilePhone" AS "MobilePhone", "Contact"."HomePhone" AS "HomePhone", "Contact"."OtherPhone" AS "OtherPhone", "Contact"."AssistantPhone" AS "AssistantPhone", "Contact"."ReportsToId" AS "ReportsToId", "Contact"."Email" AS "Email", "Contact"."Title" AS "Title", "Contact"."Department" AS "Department", "Contact"."AssistantName" AS "AssistantName", "Contact"."LeadSource" AS "LeadSource", "Contact"."Birthdate" AS "Birthdate", "Contact"."Description" AS "Description(Contact)", "Contact"."OwnerId" AS "OwnerId(Contact)", "Contact"."CreatedDate" AS "CreatedDate(Contact)", "Contact"."CreatedById" AS "CreatedById(Contact)", "Contact"."LastModifiedDate" AS "LastModifiedDate(Contact)", "Contact"."LastModifiedById" AS "LastModifiedById(Contact)", "Contact"."SystemModstamp" AS "SystemModstamp(Contact)", "Contact"."LastActivityDate" AS "LastActivityDate(Contact)", "Contact"."LastCURequestDate" AS "LastCURequestDate", "Contact"."LastCUUpdateDate" AS "LastCUUpdateDate", "Contact"."LastViewedDate" AS "LastViewedDate(Contact)", "Contact"."LastReferencedDate" AS "LastReferencedDate(Contact)", "Contact"."EmailBouncedReason" AS "EmailBouncedReason", "Contact"."EmailBouncedDate" AS "EmailBouncedDate", "Contact"."IsEmailBounced" AS "IsEmailBounced", "Contact"."PhotoUrl" AS "PhotoUrl", "Contact"."Jigsaw" AS "Jigsaw", "Contact"."JigsawContactId" AS "JigsawContactId", "Contact"."CleanStatus" AS "CleanStatus", "Contact"."IndividualId" AS "IndividualId", "Contact"."Level__c" AS "Level__c", "Contact"."Languages__c" AS "Languages__c", "Contact"."OtherAddress" AS "OtherAddress", "Contact"."MailingAddress" AS "MailingAddress", "Group"."type" AS "type(Group)", "Group"."url" AS "url(Group)", "Group"."Id" AS "Id(Group)", "Group"."Name" AS "Name(Group)", "Group"."DeveloperName" AS "DeveloperName", "Group"."RelatedId" AS "RelatedId", "Group"."Type_2" AS "Type_2(Group)", "Group"."Email" AS "Email(Group)", "Group"."QueueRoutingConfigId" AS "QueueRoutingConfigId", "Group"."OwnerId" AS "OwnerId(Group)", "Group"."DoesSendEmailToMembers" AS "DoesSendEmailToMembers", "Group"."DoesIncludeBosses" AS "DoesIncludeBosses", "Group"."CreatedDate" AS "CreatedDate(Group)", "Group"."CreatedById" AS "CreatedById(Group)", "Group"."LastModifiedDate" AS "LastModifiedDate(Group)", "Group"."LastModifiedById" AS "LastModifiedById(Group)", "Group"."SystemModstamp" AS "SystemModstamp(Group)" FROM "kmadhu@stratapps.com"."Campaign" AS "Campaign" INNER JOIN "kmadhu@stratapps.com"."AppMenuItem" AS "AppMenuItem" ON "Campaign"."SystemModstamp" = "AppMenuItem"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Contact" AS "Contact" ON "Campaign"."SystemModstamp" = "Contact"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Group" AS "Group" ON "Campaign"."SystemModstamp" = "Group"."SystemModstamp") temp_table GROUP BY "Name(Group)", "Name(Group)" ORDER BY "Name(Group)" ASC NULLS FIRST
'''

shft_q2 = '''SELECT "Name" AS "Name", COUNT(DISTINCT "NumberOfLeads") AS "CNTD(NumberOfLeads)", COUNT(DISTINCT "NumberOfConvertedLeads") AS "CNTD(NumberOfConvertedLeads)" FROM (SELECT "Campaign"."type" AS "type", "Campaign"."url" AS "url", "Campaign"."Id" AS "Id", "Campaign"."IsDeleted" AS "IsDeleted", "Campaign"."Name" AS "Name", "Campaign"."ParentId" AS "ParentId", "Campaign"."Type_2" AS "Type_2", "Campaign"."Status" AS "Status", "Campaign"."StartDate" AS "StartDate", "Campaign"."EndDate" AS "EndDate", "Campaign"."ExpectedRevenue" AS "ExpectedRevenue", "Campaign"."BudgetedCost" AS "BudgetedCost", "Campaign"."ActualCost" AS "ActualCost", "Campaign"."ExpectedResponse" AS "ExpectedResponse", "Campaign"."NumberSent" AS "NumberSent", "Campaign"."IsActive" AS "IsActive", "Campaign"."Description" AS "Description", "Campaign"."NumberOfLeads" AS "NumberOfLeads", "Campaign"."NumberOfConvertedLeads" AS "NumberOfConvertedLeads", "Campaign"."NumberOfContacts" AS "NumberOfContacts", "Campaign"."NumberOfResponses" AS "NumberOfResponses", "Campaign"."NumberOfOpportunities" AS "NumberOfOpportunities", "Campaign"."NumberOfWonOpportunities" AS "NumberOfWonOpportunities", "Campaign"."AmountAllOpportunities" AS "AmountAllOpportunities", "Campaign"."AmountWonOpportunities" AS "AmountWonOpportunities", "Campaign"."OwnerId" AS "OwnerId", "Campaign"."CreatedDate" AS "CreatedDate", "Campaign"."CreatedById" AS "CreatedById", "Campaign"."LastModifiedDate" AS "LastModifiedDate", "Campaign"."LastModifiedById" AS "LastModifiedById", "Campaign"."SystemModstamp" AS "SystemModstamp", "Campaign"."LastActivityDate" AS "LastActivityDate", "Campaign"."LastViewedDate" AS "LastViewedDate", "Campaign"."LastReferencedDate" AS "LastReferencedDate", "Campaign"."CampaignMemberRecordTypeId" AS "CampaignMemberRecordTypeId", "AppMenuItem"."type" AS "type(AppMenuItem)", "AppMenuItem"."url" AS "url(AppMenuItem)", "AppMenuItem"."Id" AS "Id(AppMenuItem)", "AppMenuItem"."IsDeleted" AS "IsDeleted(AppMenuItem)", "AppMenuItem"."CreatedDate" AS "CreatedDate(AppMenuItem)", "AppMenuItem"."CreatedById" AS "CreatedById(AppMenuItem)", "AppMenuItem"."LastModifiedDate" AS "LastModifiedDate(AppMenuItem)", "AppMenuItem"."LastModifiedById" AS "LastModifiedById(AppMenuItem)", "AppMenuItem"."SystemModstamp" AS "SystemModstamp(AppMenuItem)", "AppMenuItem"."SortOrder" AS "SortOrder", "AppMenuItem"."Name" AS "Name(AppMenuItem)", "AppMenuItem"."NamespacePrefix" AS "NamespacePrefix", "AppMenuItem"."Label" AS "Label", "AppMenuItem"."Description" AS "Description(AppMenuItem)", "AppMenuItem"."StartUrl" AS "StartUrl", "AppMenuItem"."MobileStartUrl" AS "MobileStartUrl", "AppMenuItem"."LogoUrl" AS "LogoUrl", "AppMenuItem"."IconUrl" AS "IconUrl", "AppMenuItem"."InfoUrl" AS "InfoUrl", "AppMenuItem"."IsUsingAdminAuthorization" AS "IsUsingAdminAuthorization", "AppMenuItem"."MobilePlatform" AS "MobilePlatform", "AppMenuItem"."MobileMinOsVer" AS "MobileMinOsVer", "AppMenuItem"."MobileDeviceType" AS "MobileDeviceType", "AppMenuItem"."IsRegisteredDeviceOnly" AS "IsRegisteredDeviceOnly", "AppMenuItem"."MobileAppVer" AS "MobileAppVer", "AppMenuItem"."MobileAppInstalledDate" AS "MobileAppInstalledDate", "AppMenuItem"."MobileAppInstalledVersion" AS "MobileAppInstalledVersion", "AppMenuItem"."MobileAppBinaryId" AS "MobileAppBinaryId", "AppMenuItem"."MobileAppInstallUrl" AS "MobileAppInstallUrl", "AppMenuItem"."CanvasEnabled" AS "CanvasEnabled", "AppMenuItem"."CanvasReferenceId" AS "CanvasReferenceId", "AppMenuItem"."CanvasUrl" AS "CanvasUrl", "AppMenuItem"."CanvasAccessMethod" AS "CanvasAccessMethod", "AppMenuItem"."CanvasSelectedLocations" AS "CanvasSelectedLocations", "AppMenuItem"."CanvasOptions" AS "CanvasOptions", "AppMenuItem"."Type_2" AS "Type_2(AppMenuItem)", "AppMenuItem"."ApplicationId" AS "ApplicationId", "AppMenuItem"."UserSortOrder" AS "UserSortOrder", "AppMenuItem"."IsVisible" AS "IsVisible", "AppMenuItem"."IsAccessible" AS "IsAccessible", "Contact"."type" AS "type(Contact)", "Contact"."url" AS "url(Contact)", "Contact"."Id" AS "Id(Contact)", "Contact"."IsDeleted" AS "IsDeleted(Contact)", "Contact"."MasterRecordId" AS "MasterRecordId", "Contact"."AccountId" AS "AccountId", "Contact"."LastName" AS "LastName", "Contact"."FirstName" AS "FirstName", "Contact"."Salutation" AS "Salutation", "Contact"."Name" AS "Name(Contact)", "Contact"."OtherStreet" AS "OtherStreet", "Contact"."OtherCity" AS "OtherCity", "Contact"."OtherState" AS "OtherState", "Contact"."OtherPostalCode" AS "OtherPostalCode", "Contact"."OtherCountry" AS "OtherCountry", "Contact"."OtherLatitude" AS "OtherLatitude", "Contact"."OtherLongitude" AS "OtherLongitude", "Contact"."OtherGeocodeAccuracy" AS "OtherGeocodeAccuracy", "Contact"."city" AS "city", "Contact"."country" AS "country", "Contact"."geocodeAccuracy" AS "geocodeAccuracy", "Contact"."latitude" AS "latitude", "Contact"."longitude" AS "longitude", "Contact"."postalCode" AS "postalCode", "Contact"."state" AS "state", "Contact"."street" AS "street", "Contact"."MailingStreet" AS "MailingStreet", "Contact"."MailingCity" AS "MailingCity", "Contact"."MailingState" AS "MailingState", "Contact"."MailingPostalCode" AS "MailingPostalCode", "Contact"."MailingCountry" AS "MailingCountry", "Contact"."MailingLatitude" AS "MailingLatitude", "Contact"."MailingLongitude" AS "MailingLongitude", "Contact"."MailingGeocodeAccuracy" AS "MailingGeocodeAccuracy", "Contact"."Phone" AS "Phone", "Contact"."Fax" AS "Fax", "Contact"."MobilePhone" AS "MobilePhone", "Contact"."HomePhone" AS "HomePhone", "Contact"."OtherPhone" AS "OtherPhone", "Contact"."AssistantPhone" AS "AssistantPhone", "Contact"."ReportsToId" AS "ReportsToId", "Contact"."Email" AS "Email", "Contact"."Title" AS "Title", "Contact"."Department" AS "Department", "Contact"."AssistantName" AS "AssistantName", "Contact"."LeadSource" AS "LeadSource", "Contact"."Birthdate" AS "Birthdate", "Contact"."Description" AS "Description(Contact)", "Contact"."OwnerId" AS "OwnerId(Contact)", "Contact"."CreatedDate" AS "CreatedDate(Contact)", "Contact"."CreatedById" AS "CreatedById(Contact)", "Contact"."LastModifiedDate" AS "LastModifiedDate(Contact)", "Contact"."LastModifiedById" AS "LastModifiedById(Contact)", "Contact"."SystemModstamp" AS "SystemModstamp(Contact)", "Contact"."LastActivityDate" AS "LastActivityDate(Contact)", "Contact"."LastCURequestDate" AS "LastCURequestDate", "Contact"."LastCUUpdateDate" AS "LastCUUpdateDate", "Contact"."LastViewedDate" AS "LastViewedDate(Contact)", "Contact"."LastReferencedDate" AS "LastReferencedDate(Contact)", "Contact"."EmailBouncedReason" AS "EmailBouncedReason", "Contact"."EmailBouncedDate" AS "EmailBouncedDate", "Contact"."IsEmailBounced" AS "IsEmailBounced", "Contact"."PhotoUrl" AS "PhotoUrl", "Contact"."Jigsaw" AS "Jigsaw", "Contact"."JigsawContactId" AS "JigsawContactId", "Contact"."CleanStatus" AS "CleanStatus", "Contact"."IndividualId" AS "IndividualId", "Contact"."Level__c" AS "Level__c", "Contact"."Languages__c" AS "Languages__c", "Contact"."OtherAddress" AS "OtherAddress", "Contact"."MailingAddress" AS "MailingAddress", "Group"."type" AS "type(Group)", "Group"."url" AS "url(Group)", "Group"."Id" AS "Id(Group)", "Group"."Name" AS "Name(Group)", "Group"."DeveloperName" AS "DeveloperName", "Group"."RelatedId" AS "RelatedId", "Group"."Type_2" AS "Type_2(Group)", "Group"."Email" AS "Email(Group)", "Group"."QueueRoutingConfigId" AS "QueueRoutingConfigId", "Group"."OwnerId" AS "OwnerId(Group)", "Group"."DoesSendEmailToMembers" AS "DoesSendEmailToMembers", "Group"."DoesIncludeBosses" AS "DoesIncludeBosses", "Group"."CreatedDate" AS "CreatedDate(Group)", "Group"."CreatedById" AS "CreatedById(Group)", "Group"."LastModifiedDate" AS "LastModifiedDate(Group)", "Group"."LastModifiedById" AS "LastModifiedById(Group)", "Group"."SystemModstamp" AS "SystemModstamp(Group)" FROM "kmadhu@stratapps.com"."Campaign" AS "Campaign" INNER JOIN "kmadhu@stratapps.com"."AppMenuItem" AS "AppMenuItem" ON "Campaign"."SystemModstamp" = "AppMenuItem"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Contact" AS "Contact" ON "Campaign"."SystemModstamp" = "Contact"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Group" AS "Group" ON "Campaign"."SystemModstamp" = "Group"."SystemModstamp") temp_table GROUP BY "Name", "Name" ORDER BY "Name" ASC NULLS FIRST
'''

shft_q3 = '''SELECT "Name" AS "Name", CASE WHEN "IsDeleted" THEN 'True' ELSE 'False' END AS "IsDeleted", "Status" AS "Status", "StartDate" AS "StartDate", "EndDate" AS "EndDate", CASE WHEN "IsActive" THEN 'True' ELSE 'False' END AS "IsActive", "LastViewedDate" AS "LastViewedDate", "ActualCost" AS "ActualCost", "ExpectedRevenue" AS "ExpectedRevenue" FROM (SELECT "Campaign"."type" AS "type", "Campaign"."url" AS "url", "Campaign"."Id" AS "Id", "Campaign"."IsDeleted" AS "IsDeleted", "Campaign"."Name" AS "Name", "Campaign"."ParentId" AS "ParentId", "Campaign"."Type_2" AS "Type_2", "Campaign"."Status" AS "Status", "Campaign"."StartDate" AS "StartDate", "Campaign"."EndDate" AS "EndDate", "Campaign"."ExpectedRevenue" AS "ExpectedRevenue", "Campaign"."BudgetedCost" AS "BudgetedCost", "Campaign"."ActualCost" AS "ActualCost", "Campaign"."ExpectedResponse" AS "ExpectedResponse", "Campaign"."NumberSent" AS "NumberSent", "Campaign"."IsActive" AS "IsActive", "Campaign"."Description" AS "Description", "Campaign"."NumberOfLeads" AS "NumberOfLeads", "Campaign"."NumberOfConvertedLeads" AS "NumberOfConvertedLeads", "Campaign"."NumberOfContacts" AS "NumberOfContacts", "Campaign"."NumberOfResponses" AS "NumberOfResponses", "Campaign"."NumberOfOpportunities" AS "NumberOfOpportunities", "Campaign"."NumberOfWonOpportunities" AS "NumberOfWonOpportunities", "Campaign"."AmountAllOpportunities" AS "AmountAllOpportunities", "Campaign"."AmountWonOpportunities" AS "AmountWonOpportunities", "Campaign"."OwnerId" AS "OwnerId", "Campaign"."CreatedDate" AS "CreatedDate", "Campaign"."CreatedById" AS "CreatedById", "Campaign"."LastModifiedDate" AS "LastModifiedDate", "Campaign"."LastModifiedById" AS "LastModifiedById", "Campaign"."SystemModstamp" AS "SystemModstamp", "Campaign"."LastActivityDate" AS "LastActivityDate", "Campaign"."LastViewedDate" AS "LastViewedDate", "Campaign"."LastReferencedDate" AS "LastReferencedDate", "Campaign"."CampaignMemberRecordTypeId" AS "CampaignMemberRecordTypeId", "AppMenuItem"."type" AS "type(AppMenuItem)", "AppMenuItem"."url" AS "url(AppMenuItem)", "AppMenuItem"."Id" AS "Id(AppMenuItem)", "AppMenuItem"."IsDeleted" AS "IsDeleted(AppMenuItem)", "AppMenuItem"."CreatedDate" AS "CreatedDate(AppMenuItem)", "AppMenuItem"."CreatedById" AS "CreatedById(AppMenuItem)", "AppMenuItem"."LastModifiedDate" AS "LastModifiedDate(AppMenuItem)", "AppMenuItem"."LastModifiedById" AS "LastModifiedById(AppMenuItem)", "AppMenuItem"."SystemModstamp" AS "SystemModstamp(AppMenuItem)", "AppMenuItem"."SortOrder" AS "SortOrder", "AppMenuItem"."Name" AS "Name(AppMenuItem)", "AppMenuItem"."NamespacePrefix" AS "NamespacePrefix", "AppMenuItem"."Label" AS "Label", "AppMenuItem"."Description" AS "Description(AppMenuItem)", "AppMenuItem"."StartUrl" AS "StartUrl", "AppMenuItem"."MobileStartUrl" AS "MobileStartUrl", "AppMenuItem"."LogoUrl" AS "LogoUrl", "AppMenuItem"."IconUrl" AS "IconUrl", "AppMenuItem"."InfoUrl" AS "InfoUrl", "AppMenuItem"."IsUsingAdminAuthorization" AS "IsUsingAdminAuthorization", "AppMenuItem"."MobilePlatform" AS "MobilePlatform", "AppMenuItem"."MobileMinOsVer" AS "MobileMinOsVer", "AppMenuItem"."MobileDeviceType" AS "MobileDeviceType", "AppMenuItem"."IsRegisteredDeviceOnly" AS "IsRegisteredDeviceOnly", "AppMenuItem"."MobileAppVer" AS "MobileAppVer", "AppMenuItem"."MobileAppInstalledDate" AS "MobileAppInstalledDate", "AppMenuItem"."MobileAppInstalledVersion" AS "MobileAppInstalledVersion", "AppMenuItem"."MobileAppBinaryId" AS "MobileAppBinaryId", "AppMenuItem"."MobileAppInstallUrl" AS "MobileAppInstallUrl", "AppMenuItem"."CanvasEnabled" AS "CanvasEnabled", "AppMenuItem"."CanvasReferenceId" AS "CanvasReferenceId", "AppMenuItem"."CanvasUrl" AS "CanvasUrl", "AppMenuItem"."CanvasAccessMethod" AS "CanvasAccessMethod", "AppMenuItem"."CanvasSelectedLocations" AS "CanvasSelectedLocations", "AppMenuItem"."CanvasOptions" AS "CanvasOptions", "AppMenuItem"."Type_2" AS "Type_2(AppMenuItem)", "AppMenuItem"."ApplicationId" AS "ApplicationId", "AppMenuItem"."UserSortOrder" AS "UserSortOrder", "AppMenuItem"."IsVisible" AS "IsVisible", "AppMenuItem"."IsAccessible" AS "IsAccessible", "Contact"."type" AS "type(Contact)", "Contact"."url" AS "url(Contact)", "Contact"."Id" AS "Id(Contact)", "Contact"."IsDeleted" AS "IsDeleted(Contact)", "Contact"."MasterRecordId" AS "MasterRecordId", "Contact"."AccountId" AS "AccountId", "Contact"."LastName" AS "LastName", "Contact"."FirstName" AS "FirstName", "Contact"."Salutation" AS "Salutation", "Contact"."Name" AS "Name(Contact)", "Contact"."OtherStreet" AS "OtherStreet", "Contact"."OtherCity" AS "OtherCity", "Contact"."OtherState" AS "OtherState", "Contact"."OtherPostalCode" AS "OtherPostalCode", "Contact"."OtherCountry" AS "OtherCountry", "Contact"."OtherLatitude" AS "OtherLatitude", "Contact"."OtherLongitude" AS "OtherLongitude", "Contact"."OtherGeocodeAccuracy" AS "OtherGeocodeAccuracy", "Contact"."city" AS "city", "Contact"."country" AS "country", "Contact"."geocodeAccuracy" AS "geocodeAccuracy", "Contact"."latitude" AS "latitude", "Contact"."longitude" AS "longitude", "Contact"."postalCode" AS "postalCode", "Contact"."state" AS "state", "Contact"."street" AS "street", "Contact"."MailingStreet" AS "MailingStreet", "Contact"."MailingCity" AS "MailingCity", "Contact"."MailingState" AS "MailingState", "Contact"."MailingPostalCode" AS "MailingPostalCode", "Contact"."MailingCountry" AS "MailingCountry", "Contact"."MailingLatitude" AS "MailingLatitude", "Contact"."MailingLongitude" AS "MailingLongitude", "Contact"."MailingGeocodeAccuracy" AS "MailingGeocodeAccuracy", "Contact"."Phone" AS "Phone", "Contact"."Fax" AS "Fax", "Contact"."MobilePhone" AS "MobilePhone", "Contact"."HomePhone" AS "HomePhone", "Contact"."OtherPhone" AS "OtherPhone", "Contact"."AssistantPhone" AS "AssistantPhone", "Contact"."ReportsToId" AS "ReportsToId", "Contact"."Email" AS "Email", "Contact"."Title" AS "Title", "Contact"."Department" AS "Department", "Contact"."AssistantName" AS "AssistantName", "Contact"."LeadSource" AS "LeadSource", "Contact"."Birthdate" AS "Birthdate", "Contact"."Description" AS "Description(Contact)", "Contact"."OwnerId" AS "OwnerId(Contact)", "Contact"."CreatedDate" AS "CreatedDate(Contact)", "Contact"."CreatedById" AS "CreatedById(Contact)", "Contact"."LastModifiedDate" AS "LastModifiedDate(Contact)", "Contact"."LastModifiedById" AS "LastModifiedById(Contact)", "Contact"."SystemModstamp" AS "SystemModstamp(Contact)", "Contact"."LastActivityDate" AS "LastActivityDate(Contact)", "Contact"."LastCURequestDate" AS "LastCURequestDate", "Contact"."LastCUUpdateDate" AS "LastCUUpdateDate", "Contact"."LastViewedDate" AS "LastViewedDate(Contact)", "Contact"."LastReferencedDate" AS "LastReferencedDate(Contact)", "Contact"."EmailBouncedReason" AS "EmailBouncedReason", "Contact"."EmailBouncedDate" AS "EmailBouncedDate", "Contact"."IsEmailBounced" AS "IsEmailBounced", "Contact"."PhotoUrl" AS "PhotoUrl", "Contact"."Jigsaw" AS "Jigsaw", "Contact"."JigsawContactId" AS "JigsawContactId", "Contact"."CleanStatus" AS "CleanStatus", "Contact"."IndividualId" AS "IndividualId", "Contact"."Level__c" AS "Level__c", "Contact"."Languages__c" AS "Languages__c", "Contact"."OtherAddress" AS "OtherAddress", "Contact"."MailingAddress" AS "MailingAddress", "Group"."type" AS "type(Group)", "Group"."url" AS "url(Group)", "Group"."Id" AS "Id(Group)", "Group"."Name" AS "Name(Group)", "Group"."DeveloperName" AS "DeveloperName", "Group"."RelatedId" AS "RelatedId", "Group"."Type_2" AS "Type_2(Group)", "Group"."Email" AS "Email(Group)", "Group"."QueueRoutingConfigId" AS "QueueRoutingConfigId", "Group"."OwnerId" AS "OwnerId(Group)", "Group"."DoesSendEmailToMembers" AS "DoesSendEmailToMembers", "Group"."DoesIncludeBosses" AS "DoesIncludeBosses", "Group"."CreatedDate" AS "CreatedDate(Group)", "Group"."CreatedById" AS "CreatedById(Group)", "Group"."LastModifiedDate" AS "LastModifiedDate(Group)", "Group"."LastModifiedById" AS "LastModifiedById(Group)", "Group"."SystemModstamp" AS "SystemModstamp(Group)" FROM "kmadhu@stratapps.com"."Campaign" AS "Campaign" INNER JOIN "kmadhu@stratapps.com"."AppMenuItem" AS "AppMenuItem" ON "Campaign"."SystemModstamp" = "AppMenuItem"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Contact" AS "Contact" ON "Campaign"."SystemModstamp" = "Contact"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Group" AS "Group" ON "Campaign"."SystemModstamp" = "Group"."SystemModstamp") temp_table GROUP BY "Name", "IsDeleted", "Status", "StartDate", "EndDate", "IsActive", "LastViewedDate", "ActualCost", "ExpectedRevenue", "Name", "IsDeleted", "Status", "StartDate", "EndDate", "IsActive", "LastViewedDate", "ActualCost", "ExpectedRevenue" ORDER BY "Name" ASC NULLS FIRST
'''

shft_q4 = '''SELECT "Department" AS "Department", COUNT(DISTINCT "Id") AS "CNTD(Id)" FROM (SELECT "Campaign"."type" AS "type", "Campaign"."url" AS "url", "Campaign"."Id" AS "Id", "Campaign"."IsDeleted" AS "IsDeleted", "Campaign"."Name" AS "Name", "Campaign"."ParentId" AS "ParentId", "Campaign"."Type_2" AS "Type_2", "Campaign"."Status" AS "Status", "Campaign"."StartDate" AS "StartDate", "Campaign"."EndDate" AS "EndDate", "Campaign"."ExpectedRevenue" AS "ExpectedRevenue", "Campaign"."BudgetedCost" AS "BudgetedCost", "Campaign"."ActualCost" AS "ActualCost", "Campaign"."ExpectedResponse" AS "ExpectedResponse", "Campaign"."NumberSent" AS "NumberSent", "Campaign"."IsActive" AS "IsActive", "Campaign"."Description" AS "Description", "Campaign"."NumberOfLeads" AS "NumberOfLeads", "Campaign"."NumberOfConvertedLeads" AS "NumberOfConvertedLeads", "Campaign"."NumberOfContacts" AS "NumberOfContacts", "Campaign"."NumberOfResponses" AS "NumberOfResponses", "Campaign"."NumberOfOpportunities" AS "NumberOfOpportunities", "Campaign"."NumberOfWonOpportunities" AS "NumberOfWonOpportunities", "Campaign"."AmountAllOpportunities" AS "AmountAllOpportunities", "Campaign"."AmountWonOpportunities" AS "AmountWonOpportunities", "Campaign"."OwnerId" AS "OwnerId", "Campaign"."CreatedDate" AS "CreatedDate", "Campaign"."CreatedById" AS "CreatedById", "Campaign"."LastModifiedDate" AS "LastModifiedDate", "Campaign"."LastModifiedById" AS "LastModifiedById", "Campaign"."SystemModstamp" AS "SystemModstamp", "Campaign"."LastActivityDate" AS "LastActivityDate", "Campaign"."LastViewedDate" AS "LastViewedDate", "Campaign"."LastReferencedDate" AS "LastReferencedDate", "Campaign"."CampaignMemberRecordTypeId" AS "CampaignMemberRecordTypeId", "AppMenuItem"."type" AS "type(AppMenuItem)", "AppMenuItem"."url" AS "url(AppMenuItem)", "AppMenuItem"."Id" AS "Id(AppMenuItem)", "AppMenuItem"."IsDeleted" AS "IsDeleted(AppMenuItem)", "AppMenuItem"."CreatedDate" AS "CreatedDate(AppMenuItem)", "AppMenuItem"."CreatedById" AS "CreatedById(AppMenuItem)", "AppMenuItem"."LastModifiedDate" AS "LastModifiedDate(AppMenuItem)", "AppMenuItem"."LastModifiedById" AS "LastModifiedById(AppMenuItem)", "AppMenuItem"."SystemModstamp" AS "SystemModstamp(AppMenuItem)", "AppMenuItem"."SortOrder" AS "SortOrder", "AppMenuItem"."Name" AS "Name(AppMenuItem)", "AppMenuItem"."NamespacePrefix" AS "NamespacePrefix", "AppMenuItem"."Label" AS "Label", "AppMenuItem"."Description" AS "Description(AppMenuItem)", "AppMenuItem"."StartUrl" AS "StartUrl", "AppMenuItem"."MobileStartUrl" AS "MobileStartUrl", "AppMenuItem"."LogoUrl" AS "LogoUrl", "AppMenuItem"."IconUrl" AS "IconUrl", "AppMenuItem"."InfoUrl" AS "InfoUrl", "AppMenuItem"."IsUsingAdminAuthorization" AS "IsUsingAdminAuthorization", "AppMenuItem"."MobilePlatform" AS "MobilePlatform", "AppMenuItem"."MobileMinOsVer" AS "MobileMinOsVer", "AppMenuItem"."MobileDeviceType" AS "MobileDeviceType", "AppMenuItem"."IsRegisteredDeviceOnly" AS "IsRegisteredDeviceOnly", "AppMenuItem"."MobileAppVer" AS "MobileAppVer", "AppMenuItem"."MobileAppInstalledDate" AS "MobileAppInstalledDate", "AppMenuItem"."MobileAppInstalledVersion" AS "MobileAppInstalledVersion", "AppMenuItem"."MobileAppBinaryId" AS "MobileAppBinaryId", "AppMenuItem"."MobileAppInstallUrl" AS "MobileAppInstallUrl", "AppMenuItem"."CanvasEnabled" AS "CanvasEnabled", "AppMenuItem"."CanvasReferenceId" AS "CanvasReferenceId", "AppMenuItem"."CanvasUrl" AS "CanvasUrl", "AppMenuItem"."CanvasAccessMethod" AS "CanvasAccessMethod", "AppMenuItem"."CanvasSelectedLocations" AS "CanvasSelectedLocations", "AppMenuItem"."CanvasOptions" AS "CanvasOptions", "AppMenuItem"."Type_2" AS "Type_2(AppMenuItem)", "AppMenuItem"."ApplicationId" AS "ApplicationId", "AppMenuItem"."UserSortOrder" AS "UserSortOrder", "AppMenuItem"."IsVisible" AS "IsVisible", "AppMenuItem"."IsAccessible" AS "IsAccessible", "Contact"."type" AS "type(Contact)", "Contact"."url" AS "url(Contact)", "Contact"."Id" AS "Id(Contact)", "Contact"."IsDeleted" AS "IsDeleted(Contact)", "Contact"."MasterRecordId" AS "MasterRecordId", "Contact"."AccountId" AS "AccountId", "Contact"."LastName" AS "LastName", "Contact"."FirstName" AS "FirstName", "Contact"."Salutation" AS "Salutation", "Contact"."Name" AS "Name(Contact)", "Contact"."OtherStreet" AS "OtherStreet", "Contact"."OtherCity" AS "OtherCity", "Contact"."OtherState" AS "OtherState", "Contact"."OtherPostalCode" AS "OtherPostalCode", "Contact"."OtherCountry" AS "OtherCountry", "Contact"."OtherLatitude" AS "OtherLatitude", "Contact"."OtherLongitude" AS "OtherLongitude", "Contact"."OtherGeocodeAccuracy" AS "OtherGeocodeAccuracy", "Contact"."city" AS "city", "Contact"."country" AS "country", "Contact"."geocodeAccuracy" AS "geocodeAccuracy", "Contact"."latitude" AS "latitude", "Contact"."longitude" AS "longitude", "Contact"."postalCode" AS "postalCode", "Contact"."state" AS "state", "Contact"."street" AS "street", "Contact"."MailingStreet" AS "MailingStreet", "Contact"."MailingCity" AS "MailingCity", "Contact"."MailingState" AS "MailingState", "Contact"."MailingPostalCode" AS "MailingPostalCode", "Contact"."MailingCountry" AS "MailingCountry", "Contact"."MailingLatitude" AS "MailingLatitude", "Contact"."MailingLongitude" AS "MailingLongitude", "Contact"."MailingGeocodeAccuracy" AS "MailingGeocodeAccuracy", "Contact"."Phone" AS "Phone", "Contact"."Fax" AS "Fax", "Contact"."MobilePhone" AS "MobilePhone", "Contact"."HomePhone" AS "HomePhone", "Contact"."OtherPhone" AS "OtherPhone", "Contact"."AssistantPhone" AS "AssistantPhone", "Contact"."ReportsToId" AS "ReportsToId", "Contact"."Email" AS "Email", "Contact"."Title" AS "Title", "Contact"."Department" AS "Department", "Contact"."AssistantName" AS "AssistantName", "Contact"."LeadSource" AS "LeadSource", "Contact"."Birthdate" AS "Birthdate", "Contact"."Description" AS "Description(Contact)", "Contact"."OwnerId" AS "OwnerId(Contact)", "Contact"."CreatedDate" AS "CreatedDate(Contact)", "Contact"."CreatedById" AS "CreatedById(Contact)", "Contact"."LastModifiedDate" AS "LastModifiedDate(Contact)", "Contact"."LastModifiedById" AS "LastModifiedById(Contact)", "Contact"."SystemModstamp" AS "SystemModstamp(Contact)", "Contact"."LastActivityDate" AS "LastActivityDate(Contact)", "Contact"."LastCURequestDate" AS "LastCURequestDate", "Contact"."LastCUUpdateDate" AS "LastCUUpdateDate", "Contact"."LastViewedDate" AS "LastViewedDate(Contact)", "Contact"."LastReferencedDate" AS "LastReferencedDate(Contact)", "Contact"."EmailBouncedReason" AS "EmailBouncedReason", "Contact"."EmailBouncedDate" AS "EmailBouncedDate", "Contact"."IsEmailBounced" AS "IsEmailBounced", "Contact"."PhotoUrl" AS "PhotoUrl", "Contact"."Jigsaw" AS "Jigsaw", "Contact"."JigsawContactId" AS "JigsawContactId", "Contact"."CleanStatus" AS "CleanStatus", "Contact"."IndividualId" AS "IndividualId", "Contact"."Level__c" AS "Level__c", "Contact"."Languages__c" AS "Languages__c", "Contact"."OtherAddress" AS "OtherAddress", "Contact"."MailingAddress" AS "MailingAddress", "Group"."type" AS "type(Group)", "Group"."url" AS "url(Group)", "Group"."Id" AS "Id(Group)", "Group"."Name" AS "Name(Group)", "Group"."DeveloperName" AS "DeveloperName", "Group"."RelatedId" AS "RelatedId", "Group"."Type_2" AS "Type_2(Group)", "Group"."Email" AS "Email(Group)", "Group"."QueueRoutingConfigId" AS "QueueRoutingConfigId", "Group"."OwnerId" AS "OwnerId(Group)", "Group"."DoesSendEmailToMembers" AS "DoesSendEmailToMembers", "Group"."DoesIncludeBosses" AS "DoesIncludeBosses", "Group"."CreatedDate" AS "CreatedDate(Group)", "Group"."CreatedById" AS "CreatedById(Group)", "Group"."LastModifiedDate" AS "LastModifiedDate(Group)", "Group"."LastModifiedById" AS "LastModifiedById(Group)", "Group"."SystemModstamp" AS "SystemModstamp(Group)" FROM "kmadhu@stratapps.com"."Campaign" AS "Campaign" INNER JOIN "kmadhu@stratapps.com"."AppMenuItem" AS "AppMenuItem" ON "Campaign"."SystemModstamp" = "AppMenuItem"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Contact" AS "Contact" ON "Campaign"."SystemModstamp" = "Contact"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Group" AS "Group" ON "Campaign"."SystemModstamp" = "Group"."SystemModstamp") temp_table GROUP BY "Department", "Department" ORDER BY "Department" ASC NULLS FIRST
'''

shft_q5 = '''SELECT "Department" AS "Department", COUNT(DISTINCT "Name(Contact)") AS "CNTD(Name(Contact))" FROM (SELECT "Campaign"."type" AS "type", "Campaign"."url" AS "url", "Campaign"."Id" AS "Id", "Campaign"."IsDeleted" AS "IsDeleted", "Campaign"."Name" AS "Name", "Campaign"."ParentId" AS "ParentId", "Campaign"."Type_2" AS "Type_2", "Campaign"."Status" AS "Status", "Campaign"."StartDate" AS "StartDate", "Campaign"."EndDate" AS "EndDate", "Campaign"."ExpectedRevenue" AS "ExpectedRevenue", "Campaign"."BudgetedCost" AS "BudgetedCost", "Campaign"."ActualCost" AS "ActualCost", "Campaign"."ExpectedResponse" AS "ExpectedResponse", "Campaign"."NumberSent" AS "NumberSent", "Campaign"."IsActive" AS "IsActive", "Campaign"."Description" AS "Description", "Campaign"."NumberOfLeads" AS "NumberOfLeads", "Campaign"."NumberOfConvertedLeads" AS "NumberOfConvertedLeads", "Campaign"."NumberOfContacts" AS "NumberOfContacts", "Campaign"."NumberOfResponses" AS "NumberOfResponses", "Campaign"."NumberOfOpportunities" AS "NumberOfOpportunities", "Campaign"."NumberOfWonOpportunities" AS "NumberOfWonOpportunities", "Campaign"."AmountAllOpportunities" AS "AmountAllOpportunities", "Campaign"."AmountWonOpportunities" AS "AmountWonOpportunities", "Campaign"."OwnerId" AS "OwnerId", "Campaign"."CreatedDate" AS "CreatedDate", "Campaign"."CreatedById" AS "CreatedById", "Campaign"."LastModifiedDate" AS "LastModifiedDate", "Campaign"."LastModifiedById" AS "LastModifiedById", "Campaign"."SystemModstamp" AS "SystemModstamp", "Campaign"."LastActivityDate" AS "LastActivityDate", "Campaign"."LastViewedDate" AS "LastViewedDate", "Campaign"."LastReferencedDate" AS "LastReferencedDate", "Campaign"."CampaignMemberRecordTypeId" AS "CampaignMemberRecordTypeId", "AppMenuItem"."type" AS "type(AppMenuItem)", "AppMenuItem"."url" AS "url(AppMenuItem)", "AppMenuItem"."Id" AS "Id(AppMenuItem)", "AppMenuItem"."IsDeleted" AS "IsDeleted(AppMenuItem)", "AppMenuItem"."CreatedDate" AS "CreatedDate(AppMenuItem)", "AppMenuItem"."CreatedById" AS "CreatedById(AppMenuItem)", "AppMenuItem"."LastModifiedDate" AS "LastModifiedDate(AppMenuItem)", "AppMenuItem"."LastModifiedById" AS "LastModifiedById(AppMenuItem)", "AppMenuItem"."SystemModstamp" AS "SystemModstamp(AppMenuItem)", "AppMenuItem"."SortOrder" AS "SortOrder", "AppMenuItem"."Name" AS "Name(AppMenuItem)", "AppMenuItem"."NamespacePrefix" AS "NamespacePrefix", "AppMenuItem"."Label" AS "Label", "AppMenuItem"."Description" AS "Description(AppMenuItem)", "AppMenuItem"."StartUrl" AS "StartUrl", "AppMenuItem"."MobileStartUrl" AS "MobileStartUrl", "AppMenuItem"."LogoUrl" AS "LogoUrl", "AppMenuItem"."IconUrl" AS "IconUrl", "AppMenuItem"."InfoUrl" AS "InfoUrl", "AppMenuItem"."IsUsingAdminAuthorization" AS "IsUsingAdminAuthorization", "AppMenuItem"."MobilePlatform" AS "MobilePlatform", "AppMenuItem"."MobileMinOsVer" AS "MobileMinOsVer", "AppMenuItem"."MobileDeviceType" AS "MobileDeviceType", "AppMenuItem"."IsRegisteredDeviceOnly" AS "IsRegisteredDeviceOnly", "AppMenuItem"."MobileAppVer" AS "MobileAppVer", "AppMenuItem"."MobileAppInstalledDate" AS "MobileAppInstalledDate", "AppMenuItem"."MobileAppInstalledVersion" AS "MobileAppInstalledVersion", "AppMenuItem"."MobileAppBinaryId" AS "MobileAppBinaryId", "AppMenuItem"."MobileAppInstallUrl" AS "MobileAppInstallUrl", "AppMenuItem"."CanvasEnabled" AS "CanvasEnabled", "AppMenuItem"."CanvasReferenceId" AS "CanvasReferenceId", "AppMenuItem"."CanvasUrl" AS "CanvasUrl", "AppMenuItem"."CanvasAccessMethod" AS "CanvasAccessMethod", "AppMenuItem"."CanvasSelectedLocations" AS "CanvasSelectedLocations", "AppMenuItem"."CanvasOptions" AS "CanvasOptions", "AppMenuItem"."Type_2" AS "Type_2(AppMenuItem)", "AppMenuItem"."ApplicationId" AS "ApplicationId", "AppMenuItem"."UserSortOrder" AS "UserSortOrder", "AppMenuItem"."IsVisible" AS "IsVisible", "AppMenuItem"."IsAccessible" AS "IsAccessible", "Contact"."type" AS "type(Contact)", "Contact"."url" AS "url(Contact)", "Contact"."Id" AS "Id(Contact)", "Contact"."IsDeleted" AS "IsDeleted(Contact)", "Contact"."MasterRecordId" AS "MasterRecordId", "Contact"."AccountId" AS "AccountId", "Contact"."LastName" AS "LastName", "Contact"."FirstName" AS "FirstName", "Contact"."Salutation" AS "Salutation", "Contact"."Name" AS "Name(Contact)", "Contact"."OtherStreet" AS "OtherStreet", "Contact"."OtherCity" AS "OtherCity", "Contact"."OtherState" AS "OtherState", "Contact"."OtherPostalCode" AS "OtherPostalCode", "Contact"."OtherCountry" AS "OtherCountry", "Contact"."OtherLatitude" AS "OtherLatitude", "Contact"."OtherLongitude" AS "OtherLongitude", "Contact"."OtherGeocodeAccuracy" AS "OtherGeocodeAccuracy", "Contact"."city" AS "city", "Contact"."country" AS "country", "Contact"."geocodeAccuracy" AS "geocodeAccuracy", "Contact"."latitude" AS "latitude", "Contact"."longitude" AS "longitude", "Contact"."postalCode" AS "postalCode", "Contact"."state" AS "state", "Contact"."street" AS "street", "Contact"."MailingStreet" AS "MailingStreet", "Contact"."MailingCity" AS "MailingCity", "Contact"."MailingState" AS "MailingState", "Contact"."MailingPostalCode" AS "MailingPostalCode", "Contact"."MailingCountry" AS "MailingCountry", "Contact"."MailingLatitude" AS "MailingLatitude", "Contact"."MailingLongitude" AS "MailingLongitude", "Contact"."MailingGeocodeAccuracy" AS "MailingGeocodeAccuracy", "Contact"."Phone" AS "Phone", "Contact"."Fax" AS "Fax", "Contact"."MobilePhone" AS "MobilePhone", "Contact"."HomePhone" AS "HomePhone", "Contact"."OtherPhone" AS "OtherPhone", "Contact"."AssistantPhone" AS "AssistantPhone", "Contact"."ReportsToId" AS "ReportsToId", "Contact"."Email" AS "Email", "Contact"."Title" AS "Title", "Contact"."Department" AS "Department", "Contact"."AssistantName" AS "AssistantName", "Contact"."LeadSource" AS "LeadSource", "Contact"."Birthdate" AS "Birthdate", "Contact"."Description" AS "Description(Contact)", "Contact"."OwnerId" AS "OwnerId(Contact)", "Contact"."CreatedDate" AS "CreatedDate(Contact)", "Contact"."CreatedById" AS "CreatedById(Contact)", "Contact"."LastModifiedDate" AS "LastModifiedDate(Contact)", "Contact"."LastModifiedById" AS "LastModifiedById(Contact)", "Contact"."SystemModstamp" AS "SystemModstamp(Contact)", "Contact"."LastActivityDate" AS "LastActivityDate(Contact)", "Contact"."LastCURequestDate" AS "LastCURequestDate", "Contact"."LastCUUpdateDate" AS "LastCUUpdateDate", "Contact"."LastViewedDate" AS "LastViewedDate(Contact)", "Contact"."LastReferencedDate" AS "LastReferencedDate(Contact)", "Contact"."EmailBouncedReason" AS "EmailBouncedReason", "Contact"."EmailBouncedDate" AS "EmailBouncedDate", "Contact"."IsEmailBounced" AS "IsEmailBounced", "Contact"."PhotoUrl" AS "PhotoUrl", "Contact"."Jigsaw" AS "Jigsaw", "Contact"."JigsawContactId" AS "JigsawContactId", "Contact"."CleanStatus" AS "CleanStatus", "Contact"."IndividualId" AS "IndividualId", "Contact"."Level__c" AS "Level__c", "Contact"."Languages__c" AS "Languages__c", "Contact"."OtherAddress" AS "OtherAddress", "Contact"."MailingAddress" AS "MailingAddress", "Group"."type" AS "type(Group)", "Group"."url" AS "url(Group)", "Group"."Id" AS "Id(Group)", "Group"."Name" AS "Name(Group)", "Group"."DeveloperName" AS "DeveloperName", "Group"."RelatedId" AS "RelatedId", "Group"."Type_2" AS "Type_2(Group)", "Group"."Email" AS "Email(Group)", "Group"."QueueRoutingConfigId" AS "QueueRoutingConfigId", "Group"."OwnerId" AS "OwnerId(Group)", "Group"."DoesSendEmailToMembers" AS "DoesSendEmailToMembers", "Group"."DoesIncludeBosses" AS "DoesIncludeBosses", "Group"."CreatedDate" AS "CreatedDate(Group)", "Group"."CreatedById" AS "CreatedById(Group)", "Group"."LastModifiedDate" AS "LastModifiedDate(Group)", "Group"."LastModifiedById" AS "LastModifiedById(Group)", "Group"."SystemModstamp" AS "SystemModstamp(Group)" FROM "kmadhu@stratapps.com"."Campaign" AS "Campaign" INNER JOIN "kmadhu@stratapps.com"."AppMenuItem" AS "AppMenuItem" ON "Campaign"."SystemModstamp" = "AppMenuItem"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Contact" AS "Contact" ON "Campaign"."SystemModstamp" = "Contact"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Group" AS "Group" ON "Campaign"."SystemModstamp" = "Group"."SystemModstamp") temp_table GROUP BY "Department", "Department" ORDER BY "Department" ASC NULLS FIRST
'''

shft_q6 = '''SELECT COUNT(DISTINCT "IsActive") AS "CNTD(IsActive)" FROM (SELECT "Campaign"."type" AS "type", "Campaign"."url" AS "url", "Campaign"."Id" AS "Id", "Campaign"."IsDeleted" AS "IsDeleted", "Campaign"."Name" AS "Name", "Campaign"."ParentId" AS "ParentId", "Campaign"."Type_2" AS "Type_2", "Campaign"."Status" AS "Status", "Campaign"."StartDate" AS "StartDate", "Campaign"."EndDate" AS "EndDate", "Campaign"."ExpectedRevenue" AS "ExpectedRevenue", "Campaign"."BudgetedCost" AS "BudgetedCost", "Campaign"."ActualCost" AS "ActualCost", "Campaign"."ExpectedResponse" AS "ExpectedResponse", "Campaign"."NumberSent" AS "NumberSent", "Campaign"."IsActive" AS "IsActive", "Campaign"."Description" AS "Description", "Campaign"."NumberOfLeads" AS "NumberOfLeads", "Campaign"."NumberOfConvertedLeads" AS "NumberOfConvertedLeads", "Campaign"."NumberOfContacts" AS "NumberOfContacts", "Campaign"."NumberOfResponses" AS "NumberOfResponses", "Campaign"."NumberOfOpportunities" AS "NumberOfOpportunities", "Campaign"."NumberOfWonOpportunities" AS "NumberOfWonOpportunities", "Campaign"."AmountAllOpportunities" AS "AmountAllOpportunities", "Campaign"."AmountWonOpportunities" AS "AmountWonOpportunities", "Campaign"."OwnerId" AS "OwnerId", "Campaign"."CreatedDate" AS "CreatedDate", "Campaign"."CreatedById" AS "CreatedById", "Campaign"."LastModifiedDate" AS "LastModifiedDate", "Campaign"."LastModifiedById" AS "LastModifiedById", "Campaign"."SystemModstamp" AS "SystemModstamp", "Campaign"."LastActivityDate" AS "LastActivityDate", "Campaign"."LastViewedDate" AS "LastViewedDate", "Campaign"."LastReferencedDate" AS "LastReferencedDate", "Campaign"."CampaignMemberRecordTypeId" AS "CampaignMemberRecordTypeId", "AppMenuItem"."type" AS "type(AppMenuItem)", "AppMenuItem"."url" AS "url(AppMenuItem)", "AppMenuItem"."Id" AS "Id(AppMenuItem)", "AppMenuItem"."IsDeleted" AS "IsDeleted(AppMenuItem)", "AppMenuItem"."CreatedDate" AS "CreatedDate(AppMenuItem)", "AppMenuItem"."CreatedById" AS "CreatedById(AppMenuItem)", "AppMenuItem"."LastModifiedDate" AS "LastModifiedDate(AppMenuItem)", "AppMenuItem"."LastModifiedById" AS "LastModifiedById(AppMenuItem)", "AppMenuItem"."SystemModstamp" AS "SystemModstamp(AppMenuItem)", "AppMenuItem"."SortOrder" AS "SortOrder", "AppMenuItem"."Name" AS "Name(AppMenuItem)", "AppMenuItem"."NamespacePrefix" AS "NamespacePrefix", "AppMenuItem"."Label" AS "Label", "AppMenuItem"."Description" AS "Description(AppMenuItem)", "AppMenuItem"."StartUrl" AS "StartUrl", "AppMenuItem"."MobileStartUrl" AS "MobileStartUrl", "AppMenuItem"."LogoUrl" AS "LogoUrl", "AppMenuItem"."IconUrl" AS "IconUrl", "AppMenuItem"."InfoUrl" AS "InfoUrl", "AppMenuItem"."IsUsingAdminAuthorization" AS "IsUsingAdminAuthorization", "AppMenuItem"."MobilePlatform" AS "MobilePlatform", "AppMenuItem"."MobileMinOsVer" AS "MobileMinOsVer", "AppMenuItem"."MobileDeviceType" AS "MobileDeviceType", "AppMenuItem"."IsRegisteredDeviceOnly" AS "IsRegisteredDeviceOnly", "AppMenuItem"."MobileAppVer" AS "MobileAppVer", "AppMenuItem"."MobileAppInstalledDate" AS "MobileAppInstalledDate", "AppMenuItem"."MobileAppInstalledVersion" AS "MobileAppInstalledVersion", "AppMenuItem"."MobileAppBinaryId" AS "MobileAppBinaryId", "AppMenuItem"."MobileAppInstallUrl" AS "MobileAppInstallUrl", "AppMenuItem"."CanvasEnabled" AS "CanvasEnabled", "AppMenuItem"."CanvasReferenceId" AS "CanvasReferenceId", "AppMenuItem"."CanvasUrl" AS "CanvasUrl", "AppMenuItem"."CanvasAccessMethod" AS "CanvasAccessMethod", "AppMenuItem"."CanvasSelectedLocations" AS "CanvasSelectedLocations", "AppMenuItem"."CanvasOptions" AS "CanvasOptions", "AppMenuItem"."Type_2" AS "Type_2(AppMenuItem)", "AppMenuItem"."ApplicationId" AS "ApplicationId", "AppMenuItem"."UserSortOrder" AS "UserSortOrder", "AppMenuItem"."IsVisible" AS "IsVisible", "AppMenuItem"."IsAccessible" AS "IsAccessible", "Contact"."type" AS "type(Contact)", "Contact"."url" AS "url(Contact)", "Contact"."Id" AS "Id(Contact)", "Contact"."IsDeleted" AS "IsDeleted(Contact)", "Contact"."MasterRecordId" AS "MasterRecordId", "Contact"."AccountId" AS "AccountId", "Contact"."LastName" AS "LastName", "Contact"."FirstName" AS "FirstName", "Contact"."Salutation" AS "Salutation", "Contact"."Name" AS "Name(Contact)", "Contact"."OtherStreet" AS "OtherStreet", "Contact"."OtherCity" AS "OtherCity", "Contact"."OtherState" AS "OtherState", "Contact"."OtherPostalCode" AS "OtherPostalCode", "Contact"."OtherCountry" AS "OtherCountry", "Contact"."OtherLatitude" AS "OtherLatitude", "Contact"."OtherLongitude" AS "OtherLongitude", "Contact"."OtherGeocodeAccuracy" AS "OtherGeocodeAccuracy", "Contact"."city" AS "city", "Contact"."country" AS "country", "Contact"."geocodeAccuracy" AS "geocodeAccuracy", "Contact"."latitude" AS "latitude", "Contact"."longitude" AS "longitude", "Contact"."postalCode" AS "postalCode", "Contact"."state" AS "state", "Contact"."street" AS "street", "Contact"."MailingStreet" AS "MailingStreet", "Contact"."MailingCity" AS "MailingCity", "Contact"."MailingState" AS "MailingState", "Contact"."MailingPostalCode" AS "MailingPostalCode", "Contact"."MailingCountry" AS "MailingCountry", "Contact"."MailingLatitude" AS "MailingLatitude", "Contact"."MailingLongitude" AS "MailingLongitude", "Contact"."MailingGeocodeAccuracy" AS "MailingGeocodeAccuracy", "Contact"."Phone" AS "Phone", "Contact"."Fax" AS "Fax", "Contact"."MobilePhone" AS "MobilePhone", "Contact"."HomePhone" AS "HomePhone", "Contact"."OtherPhone" AS "OtherPhone", "Contact"."AssistantPhone" AS "AssistantPhone", "Contact"."ReportsToId" AS "ReportsToId", "Contact"."Email" AS "Email", "Contact"."Title" AS "Title", "Contact"."Department" AS "Department", "Contact"."AssistantName" AS "AssistantName", "Contact"."LeadSource" AS "LeadSource", "Contact"."Birthdate" AS "Birthdate", "Contact"."Description" AS "Description(Contact)", "Contact"."OwnerId" AS "OwnerId(Contact)", "Contact"."CreatedDate" AS "CreatedDate(Contact)", "Contact"."CreatedById" AS "CreatedById(Contact)", "Contact"."LastModifiedDate" AS "LastModifiedDate(Contact)", "Contact"."LastModifiedById" AS "LastModifiedById(Contact)", "Contact"."SystemModstamp" AS "SystemModstamp(Contact)", "Contact"."LastActivityDate" AS "LastActivityDate(Contact)", "Contact"."LastCURequestDate" AS "LastCURequestDate", "Contact"."LastCUUpdateDate" AS "LastCUUpdateDate", "Contact"."LastViewedDate" AS "LastViewedDate(Contact)", "Contact"."LastReferencedDate" AS "LastReferencedDate(Contact)", "Contact"."EmailBouncedReason" AS "EmailBouncedReason", "Contact"."EmailBouncedDate" AS "EmailBouncedDate", "Contact"."IsEmailBounced" AS "IsEmailBounced", "Contact"."PhotoUrl" AS "PhotoUrl", "Contact"."Jigsaw" AS "Jigsaw", "Contact"."JigsawContactId" AS "JigsawContactId", "Contact"."CleanStatus" AS "CleanStatus", "Contact"."IndividualId" AS "IndividualId", "Contact"."Level__c" AS "Level__c", "Contact"."Languages__c" AS "Languages__c", "Contact"."OtherAddress" AS "OtherAddress", "Contact"."MailingAddress" AS "MailingAddress", "Group"."type" AS "type(Group)", "Group"."url" AS "url(Group)", "Group"."Id" AS "Id(Group)", "Group"."Name" AS "Name(Group)", "Group"."DeveloperName" AS "DeveloperName", "Group"."RelatedId" AS "RelatedId", "Group"."Type_2" AS "Type_2(Group)", "Group"."Email" AS "Email(Group)", "Group"."QueueRoutingConfigId" AS "QueueRoutingConfigId", "Group"."OwnerId" AS "OwnerId(Group)", "Group"."DoesSendEmailToMembers" AS "DoesSendEmailToMembers", "Group"."DoesIncludeBosses" AS "DoesIncludeBosses", "Group"."CreatedDate" AS "CreatedDate(Group)", "Group"."CreatedById" AS "CreatedById(Group)", "Group"."LastModifiedDate" AS "LastModifiedDate(Group)", "Group"."LastModifiedById" AS "LastModifiedById(Group)", "Group"."SystemModstamp" AS "SystemModstamp(Group)" FROM "kmadhu@stratapps.com"."Campaign" AS "Campaign" INNER JOIN "kmadhu@stratapps.com"."AppMenuItem" AS "AppMenuItem" ON "Campaign"."SystemModstamp" = "AppMenuItem"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Contact" AS "Contact" ON "Campaign"."SystemModstamp" = "Contact"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Group" AS "Group" ON "Campaign"."SystemModstamp" = "Group"."SystemModstamp") temp_table ORDER BY "CNTD(IsActive)" ASC NULLS FIRST
'''

shft_q7 = '''SELECT COUNT(DISTINCT "Department") AS "CNTD(Department)" FROM (SELECT "Campaign"."type" AS "type", "Campaign"."url" AS "url", "Campaign"."Id" AS "Id", "Campaign"."IsDeleted" AS "IsDeleted", "Campaign"."Name" AS "Name", "Campaign"."ParentId" AS "ParentId", "Campaign"."Type_2" AS "Type_2", "Campaign"."Status" AS "Status", "Campaign"."StartDate" AS "StartDate", "Campaign"."EndDate" AS "EndDate", "Campaign"."ExpectedRevenue" AS "ExpectedRevenue", "Campaign"."BudgetedCost" AS "BudgetedCost", "Campaign"."ActualCost" AS "ActualCost", "Campaign"."ExpectedResponse" AS "ExpectedResponse", "Campaign"."NumberSent" AS "NumberSent", "Campaign"."IsActive" AS "IsActive", "Campaign"."Description" AS "Description", "Campaign"."NumberOfLeads" AS "NumberOfLeads", "Campaign"."NumberOfConvertedLeads" AS "NumberOfConvertedLeads", "Campaign"."NumberOfContacts" AS "NumberOfContacts", "Campaign"."NumberOfResponses" AS "NumberOfResponses", "Campaign"."NumberOfOpportunities" AS "NumberOfOpportunities", "Campaign"."NumberOfWonOpportunities" AS "NumberOfWonOpportunities", "Campaign"."AmountAllOpportunities" AS "AmountAllOpportunities", "Campaign"."AmountWonOpportunities" AS "AmountWonOpportunities", "Campaign"."OwnerId" AS "OwnerId", "Campaign"."CreatedDate" AS "CreatedDate", "Campaign"."CreatedById" AS "CreatedById", "Campaign"."LastModifiedDate" AS "LastModifiedDate", "Campaign"."LastModifiedById" AS "LastModifiedById", "Campaign"."SystemModstamp" AS "SystemModstamp", "Campaign"."LastActivityDate" AS "LastActivityDate", "Campaign"."LastViewedDate" AS "LastViewedDate", "Campaign"."LastReferencedDate" AS "LastReferencedDate", "Campaign"."CampaignMemberRecordTypeId" AS "CampaignMemberRecordTypeId", "AppMenuItem"."type" AS "type(AppMenuItem)", "AppMenuItem"."url" AS "url(AppMenuItem)", "AppMenuItem"."Id" AS "Id(AppMenuItem)", "AppMenuItem"."IsDeleted" AS "IsDeleted(AppMenuItem)", "AppMenuItem"."CreatedDate" AS "CreatedDate(AppMenuItem)", "AppMenuItem"."CreatedById" AS "CreatedById(AppMenuItem)", "AppMenuItem"."LastModifiedDate" AS "LastModifiedDate(AppMenuItem)", "AppMenuItem"."LastModifiedById" AS "LastModifiedById(AppMenuItem)", "AppMenuItem"."SystemModstamp" AS "SystemModstamp(AppMenuItem)", "AppMenuItem"."SortOrder" AS "SortOrder", "AppMenuItem"."Name" AS "Name(AppMenuItem)", "AppMenuItem"."NamespacePrefix" AS "NamespacePrefix", "AppMenuItem"."Label" AS "Label", "AppMenuItem"."Description" AS "Description(AppMenuItem)", "AppMenuItem"."StartUrl" AS "StartUrl", "AppMenuItem"."MobileStartUrl" AS "MobileStartUrl", "AppMenuItem"."LogoUrl" AS "LogoUrl", "AppMenuItem"."IconUrl" AS "IconUrl", "AppMenuItem"."InfoUrl" AS "InfoUrl", "AppMenuItem"."IsUsingAdminAuthorization" AS "IsUsingAdminAuthorization", "AppMenuItem"."MobilePlatform" AS "MobilePlatform", "AppMenuItem"."MobileMinOsVer" AS "MobileMinOsVer", "AppMenuItem"."MobileDeviceType" AS "MobileDeviceType", "AppMenuItem"."IsRegisteredDeviceOnly" AS "IsRegisteredDeviceOnly", "AppMenuItem"."MobileAppVer" AS "MobileAppVer", "AppMenuItem"."MobileAppInstalledDate" AS "MobileAppInstalledDate", "AppMenuItem"."MobileAppInstalledVersion" AS "MobileAppInstalledVersion", "AppMenuItem"."MobileAppBinaryId" AS "MobileAppBinaryId", "AppMenuItem"."MobileAppInstallUrl" AS "MobileAppInstallUrl", "AppMenuItem"."CanvasEnabled" AS "CanvasEnabled", "AppMenuItem"."CanvasReferenceId" AS "CanvasReferenceId", "AppMenuItem"."CanvasUrl" AS "CanvasUrl", "AppMenuItem"."CanvasAccessMethod" AS "CanvasAccessMethod", "AppMenuItem"."CanvasSelectedLocations" AS "CanvasSelectedLocations", "AppMenuItem"."CanvasOptions" AS "CanvasOptions", "AppMenuItem"."Type_2" AS "Type_2(AppMenuItem)", "AppMenuItem"."ApplicationId" AS "ApplicationId", "AppMenuItem"."UserSortOrder" AS "UserSortOrder", "AppMenuItem"."IsVisible" AS "IsVisible", "AppMenuItem"."IsAccessible" AS "IsAccessible", "Contact"."type" AS "type(Contact)", "Contact"."url" AS "url(Contact)", "Contact"."Id" AS "Id(Contact)", "Contact"."IsDeleted" AS "IsDeleted(Contact)", "Contact"."MasterRecordId" AS "MasterRecordId", "Contact"."AccountId" AS "AccountId", "Contact"."LastName" AS "LastName", "Contact"."FirstName" AS "FirstName", "Contact"."Salutation" AS "Salutation", "Contact"."Name" AS "Name(Contact)", "Contact"."OtherStreet" AS "OtherStreet", "Contact"."OtherCity" AS "OtherCity", "Contact"."OtherState" AS "OtherState", "Contact"."OtherPostalCode" AS "OtherPostalCode", "Contact"."OtherCountry" AS "OtherCountry", "Contact"."OtherLatitude" AS "OtherLatitude", "Contact"."OtherLongitude" AS "OtherLongitude", "Contact"."OtherGeocodeAccuracy" AS "OtherGeocodeAccuracy", "Contact"."city" AS "city", "Contact"."country" AS "country", "Contact"."geocodeAccuracy" AS "geocodeAccuracy", "Contact"."latitude" AS "latitude", "Contact"."longitude" AS "longitude", "Contact"."postalCode" AS "postalCode", "Contact"."state" AS "state", "Contact"."street" AS "street", "Contact"."MailingStreet" AS "MailingStreet", "Contact"."MailingCity" AS "MailingCity", "Contact"."MailingState" AS "MailingState", "Contact"."MailingPostalCode" AS "MailingPostalCode", "Contact"."MailingCountry" AS "MailingCountry", "Contact"."MailingLatitude" AS "MailingLatitude", "Contact"."MailingLongitude" AS "MailingLongitude", "Contact"."MailingGeocodeAccuracy" AS "MailingGeocodeAccuracy", "Contact"."Phone" AS "Phone", "Contact"."Fax" AS "Fax", "Contact"."MobilePhone" AS "MobilePhone", "Contact"."HomePhone" AS "HomePhone", "Contact"."OtherPhone" AS "OtherPhone", "Contact"."AssistantPhone" AS "AssistantPhone", "Contact"."ReportsToId" AS "ReportsToId", "Contact"."Email" AS "Email", "Contact"."Title" AS "Title", "Contact"."Department" AS "Department", "Contact"."AssistantName" AS "AssistantName", "Contact"."LeadSource" AS "LeadSource", "Contact"."Birthdate" AS "Birthdate", "Contact"."Description" AS "Description(Contact)", "Contact"."OwnerId" AS "OwnerId(Contact)", "Contact"."CreatedDate" AS "CreatedDate(Contact)", "Contact"."CreatedById" AS "CreatedById(Contact)", "Contact"."LastModifiedDate" AS "LastModifiedDate(Contact)", "Contact"."LastModifiedById" AS "LastModifiedById(Contact)", "Contact"."SystemModstamp" AS "SystemModstamp(Contact)", "Contact"."LastActivityDate" AS "LastActivityDate(Contact)", "Contact"."LastCURequestDate" AS "LastCURequestDate", "Contact"."LastCUUpdateDate" AS "LastCUUpdateDate", "Contact"."LastViewedDate" AS "LastViewedDate(Contact)", "Contact"."LastReferencedDate" AS "LastReferencedDate(Contact)", "Contact"."EmailBouncedReason" AS "EmailBouncedReason", "Contact"."EmailBouncedDate" AS "EmailBouncedDate", "Contact"."IsEmailBounced" AS "IsEmailBounced", "Contact"."PhotoUrl" AS "PhotoUrl", "Contact"."Jigsaw" AS "Jigsaw", "Contact"."JigsawContactId" AS "JigsawContactId", "Contact"."CleanStatus" AS "CleanStatus", "Contact"."IndividualId" AS "IndividualId", "Contact"."Level__c" AS "Level__c", "Contact"."Languages__c" AS "Languages__c", "Contact"."OtherAddress" AS "OtherAddress", "Contact"."MailingAddress" AS "MailingAddress", "Group"."type" AS "type(Group)", "Group"."url" AS "url(Group)", "Group"."Id" AS "Id(Group)", "Group"."Name" AS "Name(Group)", "Group"."DeveloperName" AS "DeveloperName", "Group"."RelatedId" AS "RelatedId", "Group"."Type_2" AS "Type_2(Group)", "Group"."Email" AS "Email(Group)", "Group"."QueueRoutingConfigId" AS "QueueRoutingConfigId", "Group"."OwnerId" AS "OwnerId(Group)", "Group"."DoesSendEmailToMembers" AS "DoesSendEmailToMembers", "Group"."DoesIncludeBosses" AS "DoesIncludeBosses", "Group"."CreatedDate" AS "CreatedDate(Group)", "Group"."CreatedById" AS "CreatedById(Group)", "Group"."LastModifiedDate" AS "LastModifiedDate(Group)", "Group"."LastModifiedById" AS "LastModifiedById(Group)", "Group"."SystemModstamp" AS "SystemModstamp(Group)" FROM "kmadhu@stratapps.com"."Campaign" AS "Campaign" INNER JOIN "kmadhu@stratapps.com"."AppMenuItem" AS "AppMenuItem" ON "Campaign"."SystemModstamp" = "AppMenuItem"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Contact" AS "Contact" ON "Campaign"."SystemModstamp" = "Contact"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Group" AS "Group" ON "Campaign"."SystemModstamp" = "Group"."SystemModstamp") temp_table ORDER BY "CNTD(Department)" ASC NULLS FIRST
'''

shft_q8 = '''SELECT COUNT(DISTINCT "Id(Group)") AS "CNTD(Id(Group))" FROM (SELECT "Campaign"."type" AS "type", "Campaign"."url" AS "url", "Campaign"."Id" AS "Id", "Campaign"."IsDeleted" AS "IsDeleted", "Campaign"."Name" AS "Name", "Campaign"."ParentId" AS "ParentId", "Campaign"."Type_2" AS "Type_2", "Campaign"."Status" AS "Status", "Campaign"."StartDate" AS "StartDate", "Campaign"."EndDate" AS "EndDate", "Campaign"."ExpectedRevenue" AS "ExpectedRevenue", "Campaign"."BudgetedCost" AS "BudgetedCost", "Campaign"."ActualCost" AS "ActualCost", "Campaign"."ExpectedResponse" AS "ExpectedResponse", "Campaign"."NumberSent" AS "NumberSent", "Campaign"."IsActive" AS "IsActive", "Campaign"."Description" AS "Description", "Campaign"."NumberOfLeads" AS "NumberOfLeads", "Campaign"."NumberOfConvertedLeads" AS "NumberOfConvertedLeads", "Campaign"."NumberOfContacts" AS "NumberOfContacts", "Campaign"."NumberOfResponses" AS "NumberOfResponses", "Campaign"."NumberOfOpportunities" AS "NumberOfOpportunities", "Campaign"."NumberOfWonOpportunities" AS "NumberOfWonOpportunities", "Campaign"."AmountAllOpportunities" AS "AmountAllOpportunities", "Campaign"."AmountWonOpportunities" AS "AmountWonOpportunities", "Campaign"."OwnerId" AS "OwnerId", "Campaign"."CreatedDate" AS "CreatedDate", "Campaign"."CreatedById" AS "CreatedById", "Campaign"."LastModifiedDate" AS "LastModifiedDate", "Campaign"."LastModifiedById" AS "LastModifiedById", "Campaign"."SystemModstamp" AS "SystemModstamp", "Campaign"."LastActivityDate" AS "LastActivityDate", "Campaign"."LastViewedDate" AS "LastViewedDate", "Campaign"."LastReferencedDate" AS "LastReferencedDate", "Campaign"."CampaignMemberRecordTypeId" AS "CampaignMemberRecordTypeId", "AppMenuItem"."type" AS "type(AppMenuItem)", "AppMenuItem"."url" AS "url(AppMenuItem)", "AppMenuItem"."Id" AS "Id(AppMenuItem)", "AppMenuItem"."IsDeleted" AS "IsDeleted(AppMenuItem)", "AppMenuItem"."CreatedDate" AS "CreatedDate(AppMenuItem)", "AppMenuItem"."CreatedById" AS "CreatedById(AppMenuItem)", "AppMenuItem"."LastModifiedDate" AS "LastModifiedDate(AppMenuItem)", "AppMenuItem"."LastModifiedById" AS "LastModifiedById(AppMenuItem)", "AppMenuItem"."SystemModstamp" AS "SystemModstamp(AppMenuItem)", "AppMenuItem"."SortOrder" AS "SortOrder", "AppMenuItem"."Name" AS "Name(AppMenuItem)", "AppMenuItem"."NamespacePrefix" AS "NamespacePrefix", "AppMenuItem"."Label" AS "Label", "AppMenuItem"."Description" AS "Description(AppMenuItem)", "AppMenuItem"."StartUrl" AS "StartUrl", "AppMenuItem"."MobileStartUrl" AS "MobileStartUrl", "AppMenuItem"."LogoUrl" AS "LogoUrl", "AppMenuItem"."IconUrl" AS "IconUrl", "AppMenuItem"."InfoUrl" AS "InfoUrl", "AppMenuItem"."IsUsingAdminAuthorization" AS "IsUsingAdminAuthorization", "AppMenuItem"."MobilePlatform" AS "MobilePlatform", "AppMenuItem"."MobileMinOsVer" AS "MobileMinOsVer", "AppMenuItem"."MobileDeviceType" AS "MobileDeviceType", "AppMenuItem"."IsRegisteredDeviceOnly" AS "IsRegisteredDeviceOnly", "AppMenuItem"."MobileAppVer" AS "MobileAppVer", "AppMenuItem"."MobileAppInstalledDate" AS "MobileAppInstalledDate", "AppMenuItem"."MobileAppInstalledVersion" AS "MobileAppInstalledVersion", "AppMenuItem"."MobileAppBinaryId" AS "MobileAppBinaryId", "AppMenuItem"."MobileAppInstallUrl" AS "MobileAppInstallUrl", "AppMenuItem"."CanvasEnabled" AS "CanvasEnabled", "AppMenuItem"."CanvasReferenceId" AS "CanvasReferenceId", "AppMenuItem"."CanvasUrl" AS "CanvasUrl", "AppMenuItem"."CanvasAccessMethod" AS "CanvasAccessMethod", "AppMenuItem"."CanvasSelectedLocations" AS "CanvasSelectedLocations", "AppMenuItem"."CanvasOptions" AS "CanvasOptions", "AppMenuItem"."Type_2" AS "Type_2(AppMenuItem)", "AppMenuItem"."ApplicationId" AS "ApplicationId", "AppMenuItem"."UserSortOrder" AS "UserSortOrder", "AppMenuItem"."IsVisible" AS "IsVisible", "AppMenuItem"."IsAccessible" AS "IsAccessible", "Contact"."type" AS "type(Contact)", "Contact"."url" AS "url(Contact)", "Contact"."Id" AS "Id(Contact)", "Contact"."IsDeleted" AS "IsDeleted(Contact)", "Contact"."MasterRecordId" AS "MasterRecordId", "Contact"."AccountId" AS "AccountId", "Contact"."LastName" AS "LastName", "Contact"."FirstName" AS "FirstName", "Contact"."Salutation" AS "Salutation", "Contact"."Name" AS "Name(Contact)", "Contact"."OtherStreet" AS "OtherStreet", "Contact"."OtherCity" AS "OtherCity", "Contact"."OtherState" AS "OtherState", "Contact"."OtherPostalCode" AS "OtherPostalCode", "Contact"."OtherCountry" AS "OtherCountry", "Contact"."OtherLatitude" AS "OtherLatitude", "Contact"."OtherLongitude" AS "OtherLongitude", "Contact"."OtherGeocodeAccuracy" AS "OtherGeocodeAccuracy", "Contact"."city" AS "city", "Contact"."country" AS "country", "Contact"."geocodeAccuracy" AS "geocodeAccuracy", "Contact"."latitude" AS "latitude", "Contact"."longitude" AS "longitude", "Contact"."postalCode" AS "postalCode", "Contact"."state" AS "state", "Contact"."street" AS "street", "Contact"."MailingStreet" AS "MailingStreet", "Contact"."MailingCity" AS "MailingCity", "Contact"."MailingState" AS "MailingState", "Contact"."MailingPostalCode" AS "MailingPostalCode", "Contact"."MailingCountry" AS "MailingCountry", "Contact"."MailingLatitude" AS "MailingLatitude", "Contact"."MailingLongitude" AS "MailingLongitude", "Contact"."MailingGeocodeAccuracy" AS "MailingGeocodeAccuracy", "Contact"."Phone" AS "Phone", "Contact"."Fax" AS "Fax", "Contact"."MobilePhone" AS "MobilePhone", "Contact"."HomePhone" AS "HomePhone", "Contact"."OtherPhone" AS "OtherPhone", "Contact"."AssistantPhone" AS "AssistantPhone", "Contact"."ReportsToId" AS "ReportsToId", "Contact"."Email" AS "Email", "Contact"."Title" AS "Title", "Contact"."Department" AS "Department", "Contact"."AssistantName" AS "AssistantName", "Contact"."LeadSource" AS "LeadSource", "Contact"."Birthdate" AS "Birthdate", "Contact"."Description" AS "Description(Contact)", "Contact"."OwnerId" AS "OwnerId(Contact)", "Contact"."CreatedDate" AS "CreatedDate(Contact)", "Contact"."CreatedById" AS "CreatedById(Contact)", "Contact"."LastModifiedDate" AS "LastModifiedDate(Contact)", "Contact"."LastModifiedById" AS "LastModifiedById(Contact)", "Contact"."SystemModstamp" AS "SystemModstamp(Contact)", "Contact"."LastActivityDate" AS "LastActivityDate(Contact)", "Contact"."LastCURequestDate" AS "LastCURequestDate", "Contact"."LastCUUpdateDate" AS "LastCUUpdateDate", "Contact"."LastViewedDate" AS "LastViewedDate(Contact)", "Contact"."LastReferencedDate" AS "LastReferencedDate(Contact)", "Contact"."EmailBouncedReason" AS "EmailBouncedReason", "Contact"."EmailBouncedDate" AS "EmailBouncedDate", "Contact"."IsEmailBounced" AS "IsEmailBounced", "Contact"."PhotoUrl" AS "PhotoUrl", "Contact"."Jigsaw" AS "Jigsaw", "Contact"."JigsawContactId" AS "JigsawContactId", "Contact"."CleanStatus" AS "CleanStatus", "Contact"."IndividualId" AS "IndividualId", "Contact"."Level__c" AS "Level__c", "Contact"."Languages__c" AS "Languages__c", "Contact"."OtherAddress" AS "OtherAddress", "Contact"."MailingAddress" AS "MailingAddress", "Group"."type" AS "type(Group)", "Group"."url" AS "url(Group)", "Group"."Id" AS "Id(Group)", "Group"."Name" AS "Name(Group)", "Group"."DeveloperName" AS "DeveloperName", "Group"."RelatedId" AS "RelatedId", "Group"."Type_2" AS "Type_2(Group)", "Group"."Email" AS "Email(Group)", "Group"."QueueRoutingConfigId" AS "QueueRoutingConfigId", "Group"."OwnerId" AS "OwnerId(Group)", "Group"."DoesSendEmailToMembers" AS "DoesSendEmailToMembers", "Group"."DoesIncludeBosses" AS "DoesIncludeBosses", "Group"."CreatedDate" AS "CreatedDate(Group)", "Group"."CreatedById" AS "CreatedById(Group)", "Group"."LastModifiedDate" AS "LastModifiedDate(Group)", "Group"."LastModifiedById" AS "LastModifiedById(Group)", "Group"."SystemModstamp" AS "SystemModstamp(Group)" FROM "kmadhu@stratapps.com"."Campaign" AS "Campaign" INNER JOIN "kmadhu@stratapps.com"."AppMenuItem" AS "AppMenuItem" ON "Campaign"."SystemModstamp" = "AppMenuItem"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Contact" AS "Contact" ON "Campaign"."SystemModstamp" = "Contact"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Group" AS "Group" ON "Campaign"."SystemModstamp" = "Group"."SystemModstamp") temp_table ORDER BY "CNTD(Id(Group))" ASC NULLS FIRST
'''

shft_q9 = '''SELECT COUNT(DISTINCT "Id(Contact)") AS "CNTD(Id(Contact))" FROM (SELECT "Campaign"."type" AS "type", "Campaign"."url" AS "url", "Campaign"."Id" AS "Id", "Campaign"."IsDeleted" AS "IsDeleted", "Campaign"."Name" AS "Name", "Campaign"."ParentId" AS "ParentId", "Campaign"."Type_2" AS "Type_2", "Campaign"."Status" AS "Status", "Campaign"."StartDate" AS "StartDate", "Campaign"."EndDate" AS "EndDate", "Campaign"."ExpectedRevenue" AS "ExpectedRevenue", "Campaign"."BudgetedCost" AS "BudgetedCost", "Campaign"."ActualCost" AS "ActualCost", "Campaign"."ExpectedResponse" AS "ExpectedResponse", "Campaign"."NumberSent" AS "NumberSent", "Campaign"."IsActive" AS "IsActive", "Campaign"."Description" AS "Description", "Campaign"."NumberOfLeads" AS "NumberOfLeads", "Campaign"."NumberOfConvertedLeads" AS "NumberOfConvertedLeads", "Campaign"."NumberOfContacts" AS "NumberOfContacts", "Campaign"."NumberOfResponses" AS "NumberOfResponses", "Campaign"."NumberOfOpportunities" AS "NumberOfOpportunities", "Campaign"."NumberOfWonOpportunities" AS "NumberOfWonOpportunities", "Campaign"."AmountAllOpportunities" AS "AmountAllOpportunities", "Campaign"."AmountWonOpportunities" AS "AmountWonOpportunities", "Campaign"."OwnerId" AS "OwnerId", "Campaign"."CreatedDate" AS "CreatedDate", "Campaign"."CreatedById" AS "CreatedById", "Campaign"."LastModifiedDate" AS "LastModifiedDate", "Campaign"."LastModifiedById" AS "LastModifiedById", "Campaign"."SystemModstamp" AS "SystemModstamp", "Campaign"."LastActivityDate" AS "LastActivityDate", "Campaign"."LastViewedDate" AS "LastViewedDate", "Campaign"."LastReferencedDate" AS "LastReferencedDate", "Campaign"."CampaignMemberRecordTypeId" AS "CampaignMemberRecordTypeId", "AppMenuItem"."type" AS "type(AppMenuItem)", "AppMenuItem"."url" AS "url(AppMenuItem)", "AppMenuItem"."Id" AS "Id(AppMenuItem)", "AppMenuItem"."IsDeleted" AS "IsDeleted(AppMenuItem)", "AppMenuItem"."CreatedDate" AS "CreatedDate(AppMenuItem)", "AppMenuItem"."CreatedById" AS "CreatedById(AppMenuItem)", "AppMenuItem"."LastModifiedDate" AS "LastModifiedDate(AppMenuItem)", "AppMenuItem"."LastModifiedById" AS "LastModifiedById(AppMenuItem)", "AppMenuItem"."SystemModstamp" AS "SystemModstamp(AppMenuItem)", "AppMenuItem"."SortOrder" AS "SortOrder", "AppMenuItem"."Name" AS "Name(AppMenuItem)", "AppMenuItem"."NamespacePrefix" AS "NamespacePrefix", "AppMenuItem"."Label" AS "Label", "AppMenuItem"."Description" AS "Description(AppMenuItem)", "AppMenuItem"."StartUrl" AS "StartUrl", "AppMenuItem"."MobileStartUrl" AS "MobileStartUrl", "AppMenuItem"."LogoUrl" AS "LogoUrl", "AppMenuItem"."IconUrl" AS "IconUrl", "AppMenuItem"."InfoUrl" AS "InfoUrl", "AppMenuItem"."IsUsingAdminAuthorization" AS "IsUsingAdminAuthorization", "AppMenuItem"."MobilePlatform" AS "MobilePlatform", "AppMenuItem"."MobileMinOsVer" AS "MobileMinOsVer", "AppMenuItem"."MobileDeviceType" AS "MobileDeviceType", "AppMenuItem"."IsRegisteredDeviceOnly" AS "IsRegisteredDeviceOnly", "AppMenuItem"."MobileAppVer" AS "MobileAppVer", "AppMenuItem"."MobileAppInstalledDate" AS "MobileAppInstalledDate", "AppMenuItem"."MobileAppInstalledVersion" AS "MobileAppInstalledVersion", "AppMenuItem"."MobileAppBinaryId" AS "MobileAppBinaryId", "AppMenuItem"."MobileAppInstallUrl" AS "MobileAppInstallUrl", "AppMenuItem"."CanvasEnabled" AS "CanvasEnabled", "AppMenuItem"."CanvasReferenceId" AS "CanvasReferenceId", "AppMenuItem"."CanvasUrl" AS "CanvasUrl", "AppMenuItem"."CanvasAccessMethod" AS "CanvasAccessMethod", "AppMenuItem"."CanvasSelectedLocations" AS "CanvasSelectedLocations", "AppMenuItem"."CanvasOptions" AS "CanvasOptions", "AppMenuItem"."Type_2" AS "Type_2(AppMenuItem)", "AppMenuItem"."ApplicationId" AS "ApplicationId", "AppMenuItem"."UserSortOrder" AS "UserSortOrder", "AppMenuItem"."IsVisible" AS "IsVisible", "AppMenuItem"."IsAccessible" AS "IsAccessible", "Contact"."type" AS "type(Contact)", "Contact"."url" AS "url(Contact)", "Contact"."Id" AS "Id(Contact)", "Contact"."IsDeleted" AS "IsDeleted(Contact)", "Contact"."MasterRecordId" AS "MasterRecordId", "Contact"."AccountId" AS "AccountId", "Contact"."LastName" AS "LastName", "Contact"."FirstName" AS "FirstName", "Contact"."Salutation" AS "Salutation", "Contact"."Name" AS "Name(Contact)", "Contact"."OtherStreet" AS "OtherStreet", "Contact"."OtherCity" AS "OtherCity", "Contact"."OtherState" AS "OtherState", "Contact"."OtherPostalCode" AS "OtherPostalCode", "Contact"."OtherCountry" AS "OtherCountry", "Contact"."OtherLatitude" AS "OtherLatitude", "Contact"."OtherLongitude" AS "OtherLongitude", "Contact"."OtherGeocodeAccuracy" AS "OtherGeocodeAccuracy", "Contact"."city" AS "city", "Contact"."country" AS "country", "Contact"."geocodeAccuracy" AS "geocodeAccuracy", "Contact"."latitude" AS "latitude", "Contact"."longitude" AS "longitude", "Contact"."postalCode" AS "postalCode", "Contact"."state" AS "state", "Contact"."street" AS "street", "Contact"."MailingStreet" AS "MailingStreet", "Contact"."MailingCity" AS "MailingCity", "Contact"."MailingState" AS "MailingState", "Contact"."MailingPostalCode" AS "MailingPostalCode", "Contact"."MailingCountry" AS "MailingCountry", "Contact"."MailingLatitude" AS "MailingLatitude", "Contact"."MailingLongitude" AS "MailingLongitude", "Contact"."MailingGeocodeAccuracy" AS "MailingGeocodeAccuracy", "Contact"."Phone" AS "Phone", "Contact"."Fax" AS "Fax", "Contact"."MobilePhone" AS "MobilePhone", "Contact"."HomePhone" AS "HomePhone", "Contact"."OtherPhone" AS "OtherPhone", "Contact"."AssistantPhone" AS "AssistantPhone", "Contact"."ReportsToId" AS "ReportsToId", "Contact"."Email" AS "Email", "Contact"."Title" AS "Title", "Contact"."Department" AS "Department", "Contact"."AssistantName" AS "AssistantName", "Contact"."LeadSource" AS "LeadSource", "Contact"."Birthdate" AS "Birthdate", "Contact"."Description" AS "Description(Contact)", "Contact"."OwnerId" AS "OwnerId(Contact)", "Contact"."CreatedDate" AS "CreatedDate(Contact)", "Contact"."CreatedById" AS "CreatedById(Contact)", "Contact"."LastModifiedDate" AS "LastModifiedDate(Contact)", "Contact"."LastModifiedById" AS "LastModifiedById(Contact)", "Contact"."SystemModstamp" AS "SystemModstamp(Contact)", "Contact"."LastActivityDate" AS "LastActivityDate(Contact)", "Contact"."LastCURequestDate" AS "LastCURequestDate", "Contact"."LastCUUpdateDate" AS "LastCUUpdateDate", "Contact"."LastViewedDate" AS "LastViewedDate(Contact)", "Contact"."LastReferencedDate" AS "LastReferencedDate(Contact)", "Contact"."EmailBouncedReason" AS "EmailBouncedReason", "Contact"."EmailBouncedDate" AS "EmailBouncedDate", "Contact"."IsEmailBounced" AS "IsEmailBounced", "Contact"."PhotoUrl" AS "PhotoUrl", "Contact"."Jigsaw" AS "Jigsaw", "Contact"."JigsawContactId" AS "JigsawContactId", "Contact"."CleanStatus" AS "CleanStatus", "Contact"."IndividualId" AS "IndividualId", "Contact"."Level__c" AS "Level__c", "Contact"."Languages__c" AS "Languages__c", "Contact"."OtherAddress" AS "OtherAddress", "Contact"."MailingAddress" AS "MailingAddress", "Group"."type" AS "type(Group)", "Group"."url" AS "url(Group)", "Group"."Id" AS "Id(Group)", "Group"."Name" AS "Name(Group)", "Group"."DeveloperName" AS "DeveloperName", "Group"."RelatedId" AS "RelatedId", "Group"."Type_2" AS "Type_2(Group)", "Group"."Email" AS "Email(Group)", "Group"."QueueRoutingConfigId" AS "QueueRoutingConfigId", "Group"."OwnerId" AS "OwnerId(Group)", "Group"."DoesSendEmailToMembers" AS "DoesSendEmailToMembers", "Group"."DoesIncludeBosses" AS "DoesIncludeBosses", "Group"."CreatedDate" AS "CreatedDate(Group)", "Group"."CreatedById" AS "CreatedById(Group)", "Group"."LastModifiedDate" AS "LastModifiedDate(Group)", "Group"."LastModifiedById" AS "LastModifiedById(Group)", "Group"."SystemModstamp" AS "SystemModstamp(Group)" FROM "kmadhu@stratapps.com"."Campaign" AS "Campaign" INNER JOIN "kmadhu@stratapps.com"."AppMenuItem" AS "AppMenuItem" ON "Campaign"."SystemModstamp" = "AppMenuItem"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Contact" AS "Contact" ON "Campaign"."SystemModstamp" = "Contact"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Group" AS "Group" ON "Campaign"."SystemModstamp" = "Group"."SystemModstamp") temp_table ORDER BY "CNTD(Id(Contact))" ASC NULLS FIRST
'''

shft_q10 = '''SELECT COUNT(DISTINCT "Id") AS "CNTD(Id)" FROM (SELECT "Campaign"."type" AS "type", "Campaign"."url" AS "url", "Campaign"."Id" AS "Id", "Campaign"."IsDeleted" AS "IsDeleted", "Campaign"."Name" AS "Name", "Campaign"."ParentId" AS "ParentId", "Campaign"."Type_2" AS "Type_2", "Campaign"."Status" AS "Status", "Campaign"."StartDate" AS "StartDate", "Campaign"."EndDate" AS "EndDate", "Campaign"."ExpectedRevenue" AS "ExpectedRevenue", "Campaign"."BudgetedCost" AS "BudgetedCost", "Campaign"."ActualCost" AS "ActualCost", "Campaign"."ExpectedResponse" AS "ExpectedResponse", "Campaign"."NumberSent" AS "NumberSent", "Campaign"."IsActive" AS "IsActive", "Campaign"."Description" AS "Description", "Campaign"."NumberOfLeads" AS "NumberOfLeads", "Campaign"."NumberOfConvertedLeads" AS "NumberOfConvertedLeads", "Campaign"."NumberOfContacts" AS "NumberOfContacts", "Campaign"."NumberOfResponses" AS "NumberOfResponses", "Campaign"."NumberOfOpportunities" AS "NumberOfOpportunities", "Campaign"."NumberOfWonOpportunities" AS "NumberOfWonOpportunities", "Campaign"."AmountAllOpportunities" AS "AmountAllOpportunities", "Campaign"."AmountWonOpportunities" AS "AmountWonOpportunities", "Campaign"."OwnerId" AS "OwnerId", "Campaign"."CreatedDate" AS "CreatedDate", "Campaign"."CreatedById" AS "CreatedById", "Campaign"."LastModifiedDate" AS "LastModifiedDate", "Campaign"."LastModifiedById" AS "LastModifiedById", "Campaign"."SystemModstamp" AS "SystemModstamp", "Campaign"."LastActivityDate" AS "LastActivityDate", "Campaign"."LastViewedDate" AS "LastViewedDate", "Campaign"."LastReferencedDate" AS "LastReferencedDate", "Campaign"."CampaignMemberRecordTypeId" AS "CampaignMemberRecordTypeId", "AppMenuItem"."type" AS "type(AppMenuItem)", "AppMenuItem"."url" AS "url(AppMenuItem)", "AppMenuItem"."Id" AS "Id(AppMenuItem)", "AppMenuItem"."IsDeleted" AS "IsDeleted(AppMenuItem)", "AppMenuItem"."CreatedDate" AS "CreatedDate(AppMenuItem)", "AppMenuItem"."CreatedById" AS "CreatedById(AppMenuItem)", "AppMenuItem"."LastModifiedDate" AS "LastModifiedDate(AppMenuItem)", "AppMenuItem"."LastModifiedById" AS "LastModifiedById(AppMenuItem)", "AppMenuItem"."SystemModstamp" AS "SystemModstamp(AppMenuItem)", "AppMenuItem"."SortOrder" AS "SortOrder", "AppMenuItem"."Name" AS "Name(AppMenuItem)", "AppMenuItem"."NamespacePrefix" AS "NamespacePrefix", "AppMenuItem"."Label" AS "Label", "AppMenuItem"."Description" AS "Description(AppMenuItem)", "AppMenuItem"."StartUrl" AS "StartUrl", "AppMenuItem"."MobileStartUrl" AS "MobileStartUrl", "AppMenuItem"."LogoUrl" AS "LogoUrl", "AppMenuItem"."IconUrl" AS "IconUrl", "AppMenuItem"."InfoUrl" AS "InfoUrl", "AppMenuItem"."IsUsingAdminAuthorization" AS "IsUsingAdminAuthorization", "AppMenuItem"."MobilePlatform" AS "MobilePlatform", "AppMenuItem"."MobileMinOsVer" AS "MobileMinOsVer", "AppMenuItem"."MobileDeviceType" AS "MobileDeviceType", "AppMenuItem"."IsRegisteredDeviceOnly" AS "IsRegisteredDeviceOnly", "AppMenuItem"."MobileAppVer" AS "MobileAppVer", "AppMenuItem"."MobileAppInstalledDate" AS "MobileAppInstalledDate", "AppMenuItem"."MobileAppInstalledVersion" AS "MobileAppInstalledVersion", "AppMenuItem"."MobileAppBinaryId" AS "MobileAppBinaryId", "AppMenuItem"."MobileAppInstallUrl" AS "MobileAppInstallUrl", "AppMenuItem"."CanvasEnabled" AS "CanvasEnabled", "AppMenuItem"."CanvasReferenceId" AS "CanvasReferenceId", "AppMenuItem"."CanvasUrl" AS "CanvasUrl", "AppMenuItem"."CanvasAccessMethod" AS "CanvasAccessMethod", "AppMenuItem"."CanvasSelectedLocations" AS "CanvasSelectedLocations", "AppMenuItem"."CanvasOptions" AS "CanvasOptions", "AppMenuItem"."Type_2" AS "Type_2(AppMenuItem)", "AppMenuItem"."ApplicationId" AS "ApplicationId", "AppMenuItem"."UserSortOrder" AS "UserSortOrder", "AppMenuItem"."IsVisible" AS "IsVisible", "AppMenuItem"."IsAccessible" AS "IsAccessible", "Contact"."type" AS "type(Contact)", "Contact"."url" AS "url(Contact)", "Contact"."Id" AS "Id(Contact)", "Contact"."IsDeleted" AS "IsDeleted(Contact)", "Contact"."MasterRecordId" AS "MasterRecordId", "Contact"."AccountId" AS "AccountId", "Contact"."LastName" AS "LastName", "Contact"."FirstName" AS "FirstName", "Contact"."Salutation" AS "Salutation", "Contact"."Name" AS "Name(Contact)", "Contact"."OtherStreet" AS "OtherStreet", "Contact"."OtherCity" AS "OtherCity", "Contact"."OtherState" AS "OtherState", "Contact"."OtherPostalCode" AS "OtherPostalCode", "Contact"."OtherCountry" AS "OtherCountry", "Contact"."OtherLatitude" AS "OtherLatitude", "Contact"."OtherLongitude" AS "OtherLongitude", "Contact"."OtherGeocodeAccuracy" AS "OtherGeocodeAccuracy", "Contact"."city" AS "city", "Contact"."country" AS "country", "Contact"."geocodeAccuracy" AS "geocodeAccuracy", "Contact"."latitude" AS "latitude", "Contact"."longitude" AS "longitude", "Contact"."postalCode" AS "postalCode", "Contact"."state" AS "state", "Contact"."street" AS "street", "Contact"."MailingStreet" AS "MailingStreet", "Contact"."MailingCity" AS "MailingCity", "Contact"."MailingState" AS "MailingState", "Contact"."MailingPostalCode" AS "MailingPostalCode", "Contact"."MailingCountry" AS "MailingCountry", "Contact"."MailingLatitude" AS "MailingLatitude", "Contact"."MailingLongitude" AS "MailingLongitude", "Contact"."MailingGeocodeAccuracy" AS "MailingGeocodeAccuracy", "Contact"."Phone" AS "Phone", "Contact"."Fax" AS "Fax", "Contact"."MobilePhone" AS "MobilePhone", "Contact"."HomePhone" AS "HomePhone", "Contact"."OtherPhone" AS "OtherPhone", "Contact"."AssistantPhone" AS "AssistantPhone", "Contact"."ReportsToId" AS "ReportsToId", "Contact"."Email" AS "Email", "Contact"."Title" AS "Title", "Contact"."Department" AS "Department", "Contact"."AssistantName" AS "AssistantName", "Contact"."LeadSource" AS "LeadSource", "Contact"."Birthdate" AS "Birthdate", "Contact"."Description" AS "Description(Contact)", "Contact"."OwnerId" AS "OwnerId(Contact)", "Contact"."CreatedDate" AS "CreatedDate(Contact)", "Contact"."CreatedById" AS "CreatedById(Contact)", "Contact"."LastModifiedDate" AS "LastModifiedDate(Contact)", "Contact"."LastModifiedById" AS "LastModifiedById(Contact)", "Contact"."SystemModstamp" AS "SystemModstamp(Contact)", "Contact"."LastActivityDate" AS "LastActivityDate(Contact)", "Contact"."LastCURequestDate" AS "LastCURequestDate", "Contact"."LastCUUpdateDate" AS "LastCUUpdateDate", "Contact"."LastViewedDate" AS "LastViewedDate(Contact)", "Contact"."LastReferencedDate" AS "LastReferencedDate(Contact)", "Contact"."EmailBouncedReason" AS "EmailBouncedReason", "Contact"."EmailBouncedDate" AS "EmailBouncedDate", "Contact"."IsEmailBounced" AS "IsEmailBounced", "Contact"."PhotoUrl" AS "PhotoUrl", "Contact"."Jigsaw" AS "Jigsaw", "Contact"."JigsawContactId" AS "JigsawContactId", "Contact"."CleanStatus" AS "CleanStatus", "Contact"."IndividualId" AS "IndividualId", "Contact"."Level__c" AS "Level__c", "Contact"."Languages__c" AS "Languages__c", "Contact"."OtherAddress" AS "OtherAddress", "Contact"."MailingAddress" AS "MailingAddress", "Group"."type" AS "type(Group)", "Group"."url" AS "url(Group)", "Group"."Id" AS "Id(Group)", "Group"."Name" AS "Name(Group)", "Group"."DeveloperName" AS "DeveloperName", "Group"."RelatedId" AS "RelatedId", "Group"."Type_2" AS "Type_2(Group)", "Group"."Email" AS "Email(Group)", "Group"."QueueRoutingConfigId" AS "QueueRoutingConfigId", "Group"."OwnerId" AS "OwnerId(Group)", "Group"."DoesSendEmailToMembers" AS "DoesSendEmailToMembers", "Group"."DoesIncludeBosses" AS "DoesIncludeBosses", "Group"."CreatedDate" AS "CreatedDate(Group)", "Group"."CreatedById" AS "CreatedById(Group)", "Group"."LastModifiedDate" AS "LastModifiedDate(Group)", "Group"."LastModifiedById" AS "LastModifiedById(Group)", "Group"."SystemModstamp" AS "SystemModstamp(Group)" FROM "kmadhu@stratapps.com"."Campaign" AS "Campaign" INNER JOIN "kmadhu@stratapps.com"."AppMenuItem" AS "AppMenuItem" ON "Campaign"."SystemModstamp" = "AppMenuItem"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Contact" AS "Contact" ON "Campaign"."SystemModstamp" = "Contact"."SystemModstamp" INNER JOIN "kmadhu@stratapps.com"."Group" AS "Group" ON "Campaign"."SystemModstamp" = "Group"."SystemModstamp") temp_table ORDER BY "CNTD(Id)" ASC NULLS FIRST
'''



def query_form(tok1,hierarchy_id,display_name):
    table_names=[[f'{display_name}', 'Campaign', 'Campaign'], [f'{display_name}', 'AppMenuItem', 'AppMenuItem'], [f'{display_name}', 'Contact', 'Contact'], [f'{display_name}', 'Group', 'Group']]
    # updated_data = [[(display_name if element == 'display_name' else element) for element in sublist] for sublist in table_names]
    quer_tb=dshb_models.QuerySets.objects.create(
        user_id=tok1['user_id'],
        hierarchy_id=hierarchy_id,
        table_names=table_names,
        join_type=['inner', 'inner', 'inner'],
        joining_conditions=[[{'table1': 'Campaign', 'firstcolumn': 'SystemModstamp', 'operator': '=', 'secondcolumn': 'SystemModstamp', 'table2': 'AppMenuItem'}], [{'table1': 'Campaign', 'firstcolumn': 'SystemModstamp', 'operator': '=', 'secondcolumn': 'SystemModstamp', 'table2': 'Contact'}], [{'table1': 'Campaign', 'firstcolumn': 'SystemModstamp', 'operator': '=', 'secondcolumn': 'SystemModstamp', 'table2': 'Group'}]],
        is_custom_sql=False,
        custom_query = query_table.replace('"', '\\"').replace('kmadhu@stratapps.com',f'{display_name}'),
        query_name="template_salesforce_query",
        created_at=datetime.datetime.now(),
        updated_at=datetime.datetime.now(),
        is_sample=False,
        datasource_path=None,
        datasource_json=None
    )
    quer_tb.save()
    return quer_tb


def sheets_list(queryset_id,tok1,hierarchy_id,display_name):
    sheetFilterQuerySetData=[
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "Name(Group)"'],
            "rows": [' "CNTD(Id(Contact))"'],
            # "custom_query": shft_q1.replace('"','\\"'),
            "custom_query" : shft_q1.replace('"','\\"').replace('kmadhu@stratapps.com',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "Name"'],
            "rows": [' "CNTD(NumberOfLeads)"', ' "CNTD(NumberOfConvertedLeads)"'],
            "custom_query": shft_q2.replace('"','\\"').replace('kmadhu@stratapps.com',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "Name"', ' "IsDeleted"', ' "Status"', ' "StartDate"', ' "EndDate"', ' "IsActive"', ' "LastViewedDate"', ' "ActualCost"', ' "ExpectedRevenue"'],
            "rows": [],
            "custom_query": shft_q3.replace('"','\\"').replace('kmadhu@stratapps.com',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "Department"'],
            "rows": [' "CNTD(Id)"'],
            "custom_query": shft_q4.replace('"','\\"').replace('kmadhu@stratapps.com',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "Department"'],
            "rows": [' "CNTD(Name(Contact))"'],
            "custom_query": shft_q5.replace('"','\\"').replace('kmadhu@stratapps.com',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": [' "CNTD(IsActive)"'],
            "custom_query": shft_q6.replace('"','\\"').replace('kmadhu@stratapps.com',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": [' "CNTD(Department)"'],
            "custom_query": shft_q7.replace('"','\\"').replace('kmadhu@stratapps.com',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": [' "CNTD(Id(Group))"'],
            "custom_query": shft_q8.replace('"','\\"').replace('kmadhu@stratapps.com',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": [' "CNTD(Id(Contact))"'],
            "custom_query": shft_q9.replace('"','\\"').replace('kmadhu@stratapps.com',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": [' "CNTD(Id)"'],
            "custom_query": shft_q10.replace('"','\\"').replace('kmadhu@stratapps.com',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
    ]
    try:
        for entry in sheetFilterQuerySetData:
            sheetfilter_table_create=dshb_models.SheetFilter_querysets.objects.create(
                datasource_querysetid=int(entry.get("datasource_querysetid") or 0) if entry.get("datasource_querysetid") else None,
                queryset_id=int(entry.get("queryset_id") or 0) if entry.get("queryset_id") else None,
                user_id=entry.get("user_id"),
                hierarchy_id=int(entry.get("hierarchy_id") or 0) if entry.get("hierarchy_id") else None,
                filter_id_list=json.dumps(entry.get("filter_id_list", [])),
                columns=json.dumps(entry.get("columns", [])),
                rows=json.dumps(entry.get("rows", [])),
                custom_query=entry.get("custom_query"),
                created_at=entry.get("created_at", datetime.datetime.now()),
                updated_at=entry.get("updated_at", datetime.datetime.now()),
            )
            sheetfilter_table_create.save()
        # self.stdout.write(self.style.SUCCESS('Successfully imported data into SheetFilter QuerySet'))
    except Exception as e:
        pass
    sheet_filter_queryset_ids_list = dshb_models.SheetFilter_querysets.objects.filter(user_id=tok1['user_id'], queryset_id=queryset_id).values_list('Sheetqueryset_id', flat=True).order_by('Sheetqueryset_id')
    return sheetfilter_table_create,sheet_filter_queryset_ids_list


def sheets_data(queryset_id,tok1,hierarchy_id,display_name):
    sheet_filter_table,sheet_filter_querysets=sheets_list(queryset_id,tok1,hierarchy_id,display_name)
    print("sh_fl",sheet_filter_querysets)
    sheetData = [
        {
            "user_id": tok1['user_id'],
            "chart_id": 24,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Group wise Contacts",
            "sheetfilter_querysets_id": sheet_filter_querysets[0],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Group wise Contacts</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 8,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Campaign wise Leads",
            "sheetfilter_querysets_id": sheet_filter_querysets[1],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Campaign wise Leads</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 1,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Campaign Info",
            "sheetfilter_querysets_id": sheet_filter_querysets[2],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Campaign Info</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 10,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Department wise Campaigns",
            "sheetfilter_querysets_id": sheet_filter_querysets[3],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Department wise Campaigns</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 27,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "",
            "sheetfilter_querysets_id": sheet_filter_querysets[4],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Department wise contacts</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Active campaigns",
            "sheetfilter_querysets_id": sheet_filter_querysets[5],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Active campaigns</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Total Departments",
            "sheetfilter_querysets_id": sheet_filter_querysets[6],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Total Departments</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Total Groups",
            "sheetfilter_querysets_id": sheet_filter_querysets[7],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Total Groups</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Total Contacts",
            "sheetfilter_querysets_id": sheet_filter_querysets[7],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Total Contacts</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Total Campaigns",
            "sheetfilter_querysets_id": sheet_filter_querysets[7],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Total Campaigns</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
    ]
    try:
        for data in sheetData:
            sheet_data_instance = dshb_models.sheet_data(
                user_id=data['user_id'],
                chart_id=data['chart_id'],
                hierarchy_id=data['hierarchy_id'],
                is_sample=False,
                queryset_id=data['queryset_id'],
                filter_ids=data['filter_ids'],
                sheet_name=data['sheet_name'],
                sheet_filt_id=data['sheetfilter_querysets_id'],
                datapath=data['datapath'],
                datasrc=data['datasrc'],
                sheet_tag_name=data['sheet_tag_name'],
                created_at=data['created_at'],
                updated_at=data['updated_at'],
            )
            sheet_data_instance.save()
    except Exception as e:
        pass
    # return sheet_data_instance
    sheet_ids_list = list(dshb_models.sheet_data.objects.filter(user_id=tok1['user_id'], queryset_id=queryset_id).values_list('id', flat=True).order_by('-id'))
    return sheet_data_instance,sheet_ids_list


def dashbaord_data(queryset_id,tok1,hierarchy_id,sheet_ids_list):
    dashb_tb = dshb_models.dashboard_data.objects.create(
        user_id=tok1['user_id'],
        hierarchy_id=[hierarchy_id],
        queryset_id=queryset_id,
        sheet_ids=sheet_ids_list,
        selected_sheet_ids=sheet_ids_list,
        height=1800,
        width=1200,
        grid_id=2,
        is_sample=False,
        role_ids=[],
        user_ids=[],
        dashboard_name="templ_salesforce",
        datapath='',
        datasrc='',
        imagepath='',
        imagesrc='',
        dashboard_tag_name="""<p>templ_salesforce</p>""",
        is_public=False,
        created_at=datetime.datetime.now(),
        updated_at=datetime.datetime.now(),
        )
    dashb_tb.save()
    return dashb_tb



@api_view(['GET'])
@transaction.atomic
@csrf_exempt
def salesforce_dashbaord(request,hierarchy_id,token):
    if request.method=='GET':
        tok1 = views.test_token(token)
        if tok1['status']==200:
            try:
                dis_name=Connections.display_name(hierarchy_id)
                database_name=dis_name.display_name
            except:
                return Response({'message':'Invalid Id'},status=status.HTTP_404_NOT_FOUND)
            query_table=query_form(tok1,hierarchy_id,database_name)
            sheets_table,sheets_ids_list=sheets_data(query_table.queryset_id,tok1,hierarchy_id,database_name)
            dashboard_table=dashbaord_data(query_table.queryset_id,tok1,hierarchy_id,sheets_ids_list)
            pr_ids=dshb_models.parent_ids.objects.get(id=hierarchy_id)
            print("queryset_id",query_table.queryset_id)
            print("sheet_ids",sheets_ids_list)
            print("dashboard_id",dashboard_table.id)
            if pr_ids.parameter.upper()=="SERVER":
                srdt=dshb_models.ServerDetails.objects.get(id=pr_ids.table_id)
                srtp=dshb_models.ServerType.objects.get(id=srdt.server_type)
                parameter=srtp.server_type.upper()
            else:
                parameter=pr_ids.parameter.upper()
            dashb_data=quickbooks.temp_dashb_main(tok1,database_name,query_table,sheets_table,sheets_ids_list,dashboard_table,parameter)
            return dashb_data
        else:
            return Response(tok1,status=tok1['status'])
    else:
        return Response({'message':'Method not allowed'},status=status.HTTP_405_METHOD_NOT_ALLOWED)