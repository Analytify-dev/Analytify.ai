import os,requests,pdfplumber,boto3,ast,random,re,secrets,string
from project import settings
import pandas as pd
from dashboard import views,models as dshb_models,Connections,columns_extract,clickhouse,Filters
from quickbooks import models,serializers,endpoints_data
import datetime
from io import BytesIO
from pytz import utc
from requests.auth import HTTPBasicAuth
from django.db import transaction
from django.views.decorators.csrf import csrf_exempt
from rest_framework.generics import CreateAPIView
from rest_framework.response import Response
from rest_framework import status
from rest_framework.decorators import api_view
from django.template.loader import render_to_string
from django.core.mail import send_mail
from urllib.parse import urlparse, parse_qs
from requests_oauthlib import OAuth2Session
import json,io
from sqlalchemy import create_engine, Column, Integer, String, VARCHAR, Float, text
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker
import requests
from base64 import b64encode
from django.test import Client,RequestFactory
from django.urls import reverse
from template_dashboards import quickbooks


#### querysets_query
query_table = '''SELECT "Agent"."id" AS "id", "Agent"."name" AS "name", "Agent"."team" AS "team", "Agent"."isdisabled" AS "isdisabled", "Agent"."ad" AS "ad", "Agent"."agentphotopath" AS "agentphotopath", "Agent"."initials" AS "initials", "Agent"."firstname" AS "firstname", "Agent"."surname" AS "surname", "Agent"."colour" AS "colour", "Agent"."jobtitle" AS "jobtitle", "Agent"."sms" AS "sms", "Agent"."extensionnumber" AS "extensionnumber", "Agent"."is_agent" AS "is_agent", "Agent"."googleemail" AS "googleemail", "Agent"."linemanager" AS "linemanager", "Agent"."exchange_authorized" AS "exchange_authorized", "Agent"."exchange_account" AS "exchange_account", "Agent"."sentinel_authorized" AS "sentinel_authorized", "Agent"."licence_type" AS "licence_type", "Agent"."splashtop_authorized" AS "splashtop_authorized", "Agent"."gotoresolve_authorized" AS "gotoresolve_authorized", "Agent"."use" AS "use", "Agent"."logmeinid" AS "logmeinid", "Agent"."allowbeyondtrustinvites" AS "allowbeyondtrustinvites", "Agent"."jira_id" AS "jira_id", "Agent"."namewithinactive" AS "namewithinactive", "Agent"."apptsync" AS "apptsync", "Agent"."sendemailerrors" AS "sendemailerrors", "Agent"."can_approve_purchaseorder" AS "can_approve_purchaseorder", "Agent"."can_approve_quote" AS "can_approve_quote", "Agent"."can_approve_invoice" AS "can_approve_invoice", "Agent"."workday_id" AS "workday_id", "Agent"."costprice" AS "costprice", "Agent"."chargerate" AS "chargerate", "Agent"."email" AS "email", "Agent"."teams[0].id" AS "teams[0].id", "Agent"."teams[0].agent_id" AS "teams[0].agent_id", "Agent"."teams[0].team_id" AS "teams[0].team_id", "Agent"."teams[0].team_name" AS "teams[0].team_name", "Agent"."teams[0].department_id" AS "teams[0].department_id", "Agent"."teams[0].role_id" AS "teams[0].role_id", "Agent"."teams[0].is_manager" AS "teams[0].is_manager", "Agent"."teams[0].no_config_access" AS "teams[0].no_config_access", "Agent"."teams[0].unassigned_access" AS "teams[0].unassigned_access", "Agent"."teams[0].otheragent_access" AS "teams[0].otheragent_access", "Agent"."teams[0].fortickets" AS "teams[0].fortickets", "Agent"."teams[0].foropps" AS "teams[0].foropps", "Agent"."teams[0].forprojects" AS "teams[0].forprojects", "Agent"."teams[0].in_section" AS "teams[0].in_section", "Agent"."departments[0].id" AS "departments[0].id", "Agent"."departments[0].agent_id" AS "departments[0].agent_id", "Agent"."departments[0].department_id" AS "departments[0].department_id", "Agent"."departments[0].role_id" AS "departments[0].role_id", "Agent"."departments[0].membershiplevel" AS "departments[0].membershiplevel", "Agent"."departments[0].includeteamsintree" AS "departments[0].includeteamsintree", "Agent"."departments[1].id" AS "departments[1].id", "Agent"."departments[1].agent_id" AS "departments[1].agent_id", "Agent"."departments[1].department_id" AS "departments[1].department_id", "Agent"."departments[1].role_id" AS "departments[1].role_id", "Agent"."departments[1].membershiplevel" AS "departments[1].membershiplevel", "Agent"."departments[1].includeteamsintree" AS "departments[1].includeteamsintree", "Agent"."departments[2].id" AS "departments[2].id", "Agent"."departments[2].agent_id" AS "departments[2].agent_id", "Agent"."departments[2].department_id" AS "departments[2].department_id", "Agent"."departments[2].role_id" AS "departments[2].role_id", "Agent"."departments[2].membershiplevel" AS "departments[2].membershiplevel", "Agent"."departments[2].includeteamsintree" AS "departments[2].includeteamsintree", "Agent"."teams[1].id" AS "teams[1].id", "Agent"."teams[1].agent_id" AS "teams[1].agent_id", "Agent"."teams[1].team_id" AS "teams[1].team_id", "Agent"."teams[1].team_name" AS "teams[1].team_name", "Agent"."teams[1].department_id" AS "teams[1].department_id", "Agent"."teams[1].is_manager" AS "teams[1].is_manager", "Agent"."teams[1].no_config_access" AS "teams[1].no_config_access", "Agent"."teams[1].unassigned_access" AS "teams[1].unassigned_access", "Agent"."teams[1].otheragent_access" AS "teams[1].otheragent_access", "Agent"."teams[1].fortickets" AS "teams[1].fortickets", "Agent"."teams[1].foropps" AS "teams[1].foropps", "Agent"."teams[1].forprojects" AS "teams[1].forprojects", "Agent"."teams[1].in_section" AS "teams[1].in_section", "Agent"."teams[2].id" AS "teams[2].id", "Agent"."teams[2].agent_id" AS "teams[2].agent_id", "Agent"."teams[2].team_id" AS "teams[2].team_id", "Agent"."teams[2].team_name" AS "teams[2].team_name", "Agent"."teams[2].department_id" AS "teams[2].department_id", "Agent"."teams[2].role_id" AS "teams[2].role_id", "Agent"."teams[2].is_manager" AS "teams[2].is_manager", "Agent"."teams[2].no_config_access" AS "teams[2].no_config_access", "Agent"."teams[2].unassigned_access" AS "teams[2].unassigned_access", "Agent"."teams[2].otheragent_access" AS "teams[2].otheragent_access", "Agent"."teams[2].fortickets" AS "teams[2].fortickets", "Agent"."teams[2].foropps" AS "teams[2].foropps", "Agent"."teams[2].forprojects" AS "teams[2].forprojects", "Agent"."teams[2].in_section" AS "teams[2].in_section", "Agent"."teams[3].id" AS "teams[3].id", "Agent"."teams[3].agent_id" AS "teams[3].agent_id", "Agent"."teams[3].team_id" AS "teams[3].team_id", "Agent"."teams[3].team_name" AS "teams[3].team_name", "Agent"."teams[3].department_id" AS "teams[3].department_id", "Agent"."teams[3].role_id" AS "teams[3].role_id", "Agent"."teams[3].is_manager" AS "teams[3].is_manager", "Agent"."teams[3].no_config_access" AS "teams[3].no_config_access", "Agent"."teams[3].unassigned_access" AS "teams[3].unassigned_access", "Agent"."teams[3].otheragent_access" AS "teams[3].otheragent_access", "Agent"."teams[3].fortickets" AS "teams[3].fortickets", "Agent"."teams[3].foropps" AS "teams[3].foropps", "Agent"."teams[3].forprojects" AS "teams[3].forprojects", "Agent"."teams[3].in_section" AS "teams[3].in_section", "Agent"."teams[4].id" AS "teams[4].id", "Agent"."teams[4].agent_id" AS "teams[4].agent_id", "Agent"."teams[4].team_id" AS "teams[4].team_id", "Agent"."teams[4].team_name" AS "teams[4].team_name", "Agent"."teams[4].department_id" AS "teams[4].department_id", "Agent"."teams[4].role_id" AS "teams[4].role_id", "Agent"."teams[4].is_manager" AS "teams[4].is_manager", "Agent"."teams[4].no_config_access" AS "teams[4].no_config_access", "Agent"."teams[4].unassigned_access" AS "teams[4].unassigned_access", "Agent"."teams[4].otheragent_access" AS "teams[4].otheragent_access", "Agent"."teams[4].fortickets" AS "teams[4].fortickets", "Agent"."teams[4].foropps" AS "teams[4].foropps", "Agent"."teams[4].forprojects" AS "teams[4].forprojects", "Agent"."teams[4].in_section" AS "teams[4].in_section", "Agent"."departments[3].id" AS "departments[3].id", "Agent"."departments[3].agent_id" AS "departments[3].agent_id", "Agent"."departments[3].department_id" AS "departments[3].department_id", "Agent"."departments[3].role_id" AS "departments[3].role_id", "Agent"."departments[3].membershiplevel" AS "departments[3].membershiplevel", "Agent"."departments[3].includeteamsintree" AS "departments[3].includeteamsintree", "Agent"."departments[4].id" AS "departments[4].id", "Agent"."departments[4].agent_id" AS "departments[4].agent_id", "Agent"."departments[4].department_id" AS "departments[4].department_id", "Agent"."departments[4].role_id" AS "departments[4].role_id", "Agent"."departments[4].membershiplevel" AS "departments[4].membershiplevel", "Agent"."departments[4].includeteamsintree" AS "departments[4].includeteamsintree", "Agent"."departments[5].id" AS "departments[5].id", "Agent"."departments[5].agent_id" AS "departments[5].agent_id", "Agent"."departments[5].department_id" AS "departments[5].department_id", "Agent"."departments[5].role_id" AS "departments[5].role_id", "Agent"."departments[5].membershiplevel" AS "departments[5].membershiplevel", "Agent"."departments[5].includeteamsintree" AS "departments[5].includeteamsintree", "Agent"."teams[1].role_id" AS "teams[1].role_id", "Agent"."lastlogindate" AS "lastlogindate", "Agent"."teams[5].id" AS "teams[5].id", "Agent"."teams[5].agent_id" AS "teams[5].agent_id", "Agent"."teams[5].team_id" AS "teams[5].team_id", "Agent"."teams[5].team_name" AS "teams[5].team_name", "Agent"."teams[5].department_id" AS "teams[5].department_id", "Agent"."teams[5].is_manager" AS "teams[5].is_manager", "Agent"."teams[5].no_config_access" AS "teams[5].no_config_access", "Agent"."teams[5].unassigned_access" AS "teams[5].unassigned_access", "Agent"."teams[5].otheragent_access" AS "teams[5].otheragent_access", "Agent"."teams[5].fortickets" AS "teams[5].fortickets", "Agent"."teams[5].foropps" AS "teams[5].foropps", "Agent"."teams[5].forprojects" AS "teams[5].forprojects", "Agent"."teams[5].in_section" AS "teams[5].in_section", "Agent"."teams[6].id" AS "teams[6].id", "Agent"."teams[6].agent_id" AS "teams[6].agent_id", "Agent"."teams[6].team_id" AS "teams[6].team_id", "Agent"."teams[6].team_name" AS "teams[6].team_name", "Agent"."teams[6].department_id" AS "teams[6].department_id", "Agent"."teams[6].role_id" AS "teams[6].role_id", "Agent"."teams[6].is_manager" AS "teams[6].is_manager", "Agent"."teams[6].no_config_access" AS "teams[6].no_config_access", "Agent"."teams[6].unassigned_access" AS "teams[6].unassigned_access", "Agent"."teams[6].otheragent_access" AS "teams[6].otheragent_access", "Agent"."teams[6].fortickets" AS "teams[6].fortickets", "Agent"."teams[6].foropps" AS "teams[6].foropps", "Agent"."teams[6].forprojects" AS "teams[6].forprojects", "Agent"."teams[6].in_section" AS "teams[6].in_section", "Agent"."teams[7].id" AS "teams[7].id", "Agent"."teams[7].agent_id" AS "teams[7].agent_id", "Agent"."teams[7].team_id" AS "teams[7].team_id", "Agent"."teams[7].team_name" AS "teams[7].team_name", "Agent"."teams[7].department_id" AS "teams[7].department_id", "Agent"."teams[7].role_id" AS "teams[7].role_id", "Agent"."teams[7].is_manager" AS "teams[7].is_manager", "Agent"."teams[7].no_config_access" AS "teams[7].no_config_access", "Agent"."teams[7].unassigned_access" AS "teams[7].unassigned_access", "Agent"."teams[7].otheragent_access" AS "teams[7].otheragent_access", "Agent"."teams[7].fortickets" AS "teams[7].fortickets", "Agent"."teams[7].foropps" AS "teams[7].foropps", "Agent"."teams[7].forprojects" AS "teams[7].forprojects", "Agent"."teams[7].in_section" AS "teams[7].in_section", "Agent"."departments[6].id" AS "departments[6].id", "Agent"."departments[6].agent_id" AS "departments[6].agent_id", "Agent"."departments[6].department_id" AS "departments[6].department_id", "Agent"."departments[6].role_id" AS "departments[6].role_id", "Agent"."departments[6].membershiplevel" AS "departments[6].membershiplevel", "Agent"."departments[6].includeteamsintree" AS "departments[6].includeteamsintree", "Agent"."departments[7].id" AS "departments[7].id", "Agent"."departments[7].agent_id" AS "departments[7].agent_id", "Agent"."departments[7].department_id" AS "departments[7].department_id", "Agent"."departments[7].role_id" AS "departments[7].role_id", "Agent"."departments[7].membershiplevel" AS "departments[7].membershiplevel", "Agent"."departments[7].includeteamsintree" AS "departments[7].includeteamsintree", "Agent"."departments[8].id" AS "departments[8].id", "Agent"."departments[8].agent_id" AS "departments[8].agent_id", "Agent"."departments[8].department_id" AS "departments[8].department_id", "Agent"."departments[8].role_id" AS "departments[8].role_id", "Agent"."departments[8].membershiplevel" AS "departments[8].membershiplevel", "Agent"."departments[8].includeteamsintree" AS "departments[8].includeteamsintree", "Agent"."departments[9].id" AS "departments[9].id", "Agent"."departments[9].agent_id" AS "departments[9].agent_id", "Agent"."departments[9].department_id" AS "departments[9].department_id", "Agent"."departments[9].role_id" AS "departments[9].role_id", "Agent"."departments[9].membershiplevel" AS "departments[9].membershiplevel", "Agent"."departments[9].includeteamsintree" AS "departments[9].includeteamsintree", "Agent"."departments[10].id" AS "departments[10].id", "Agent"."departments[10].agent_id" AS "departments[10].agent_id", "Agent"."departments[10].department_id" AS "departments[10].department_id", "Agent"."departments[10].role_id" AS "departments[10].role_id", "Agent"."departments[10].membershiplevel" AS "departments[10].membershiplevel", "Agent"."departments[10].includeteamsintree" AS "departments[10].includeteamsintree", "Agent"."departments[11].id" AS "departments[11].id", "Agent"."departments[11].agent_id" AS "departments[11].agent_id", "Agent"."departments[11].department_id" AS "departments[11].department_id", "Agent"."departments[11].role_id" AS "departments[11].role_id", "Agent"."departments[11].membershiplevel" AS "departments[11].membershiplevel", "Agent"."departments[11].includeteamsintree" AS "departments[11].includeteamsintree", "Address"."id" AS "id(Address)", "Address"."type" AS "type", "Address"."line1" AS "line1", "Address"."line2" AS "line2", "Address"."line3" AS "line3", "Address"."line4" AS "line4", "Address"."postcode" AS "postcode", "Address"."primary" AS "primary", "Address"."inactive" AS "inactive", "Address"."date_active" AS "date_active", "Address"."site_id" AS "site_id", "Address"."description" AS "description", "Address"."lat" AS "lat", "Address"."long" AS "long", "Address"."note" AS "note", "Application"."grant_type" AS "grant_type", "Application"."loginas_agent_id" AS "loginas_agent_id", "Application"."inactive" AS "inactive(Application)", "Application"."system_use" AS "system_use", "Application"."redirecturi" AS "redirecturi", "Application"."logoutredirecturi" AS "logoutredirecturi", "Application"."cors_whitelist" AS "cors_whitelist", "Application"."allowagents" AS "allowagents", "Application"."allowusers" AS "allowusers", "Application"."organisation_id" AS "organisation_id", "Application"."loginas_client_id" AS "loginas_client_id", "Application"."loginas_supplier_id" AS "loginas_supplier_id", "Application"."loginentity" AS "loginentity", "Application"."language_id" AS "language_id", "Application"."disable_windowsauth" AS "disable_windowsauth", "Application"."disable_azure" AS "disable_azure", "Application"."disable_adfs" AS "disable_adfs", "Application"."disable_okta" AS "disable_okta", "Application"."disable_centrify" AS "disable_centrify", "Application"."disable_google" AS "disable_google", "Application"."disable_anon" AS "disable_anon", "Application"."clientId" AS "clientId", "Application"."concurrencyToken" AS "concurrencyToken", "Application"."displayName" AS "displayName", "Application"."id" AS "id(Application)", "Application"."postLogoutRedirectUris" AS "postLogoutRedirectUris", "Application"."redirectUris" AS "redirectUris", "Application"."type" AS "type(Application)", "Application"."_issystem" AS "_issystem", "Currency"."id" AS "id(Currency)", "Currency"."name" AS "name(Currency)", "Currency"."symbol" AS "symbol", "Currency"."code" AS "code", "Currency"."conversion_rate" AS "conversion_rate", "Currency"."last_updated" AS "last_updated", "EmailTemplate"."id" AS "id(EmailTemplate)", "EmailTemplate"."guid" AS "guid", "EmailTemplate"."name" AS "name(EmailTemplate)", "EmailTemplate"."description" AS "description(EmailTemplate)", "EmailTemplate"."sectionid" AS "sectionid", "EmailTemplate"."header_text" AS "header_text", "EmailTemplate"."messagegroup_id" AS "messagegroup_id", "Team"."id" AS "id(Team)", "Team"."guid" AS "guid(Team)", "Team"."name" AS "name(Team)", "Team"."sequence" AS "sequence", "Team"."forrequests" AS "forrequests", "Team"."foropps" AS "foropps", "Team"."forprojects" AS "forprojects", "Team"."ticket_count" AS "ticket_count", "Team"."department_id" AS "department_id", "Team"."department_name" AS "department_name", "Team"."org_team_name" AS "org_team_name", "Team"."inactive" AS "inactive(Team)", "Team"."override_column_id" AS "override_column_id", "Team"."teamphotopath" AS "teamphotopath", "Team"."hide_agents_in_tree_if_no_tickets" AS "hide_agents_in_tree_if_no_tickets", "Team"."concurrent_lic_limit" AS "concurrent_lic_limit", "Team"."use" AS "use(Team)", "Team"."homescreendashboardid" AS "homescreendashboardid", "Tax"."id" AS "id(Tax)", "Tax"."name" AS "name(Tax)", "Tax"."code" AS "code(Tax)", "Tax"."value" AS "value", "Tax"."xero_tenant_id" AS "xero_tenant_id", "Tax"."xero_tenant_name" AS "xero_tenant_name", "Tax"."third_party_desc" AS "third_party_desc", "Tax"."is_composite" AS "is_composite", "Tax"."kashflow_tenant_id" AS "kashflow_tenant_id", "Tax"."kashflow_tenant_name" AS "kashflow_tenant_name", "Tax"."qbocode" AS "qbocode", "Tax"."qbocode_name" AS "qbocode_name", "Tax"."qbotaxcode.value" AS "qbotaxcode.value", "Tax"."qbotaxcode.label" AS "qbotaxcode.label", "Tax"."qbo_company_name" AS "qbo_company_name" FROM "halops_dash"."Agent" AS "Agent" INNER JOIN "halops_dash"."Address" AS "Address" ON "Agent"."id" = "Address"."id" INNER JOIN "halops_dash"."Application" AS "Application" ON "Address"."inactive" = "Application"."inactive" INNER JOIN "halops_dash"."Currency" AS "Currency" ON "Agent"."id" = "Currency"."id" INNER JOIN "halops_dash"."EmailTemplate" AS "EmailTemplate" ON "Agent"."id" = "EmailTemplate"."id" INNER JOIN "halops_dash"."Team" AS "Team" ON "Agent"."id" = "Team"."id" INNER JOIN "halops_dash"."Tax" AS "Tax" ON "Agent"."id" = "Tax"."id"
'''


#### Sheetfilter_query
shft_q1 = '''SELECT "department_name" AS "department_name", "value" AS "value", "email" AS "email", "displayName" AS "displayName", "jira_id" AS "jira_id", "line1" AS "line1", "line2" AS "line2", "postcode" AS "postcode" FROM (SELECT "Agent"."id" AS "id", "Agent"."name" AS "name", "Agent"."team" AS "team", "Agent"."isdisabled" AS "isdisabled", "Agent"."ad" AS "ad", "Agent"."agentphotopath" AS "agentphotopath", "Agent"."initials" AS "initials", "Agent"."firstname" AS "firstname", "Agent"."surname" AS "surname", "Agent"."colour" AS "colour", "Agent"."jobtitle" AS "jobtitle", "Agent"."sms" AS "sms", "Agent"."extensionnumber" AS "extensionnumber", "Agent"."is_agent" AS "is_agent", "Agent"."googleemail" AS "googleemail", "Agent"."linemanager" AS "linemanager", "Agent"."exchange_authorized" AS "exchange_authorized", "Agent"."exchange_account" AS "exchange_account", "Agent"."sentinel_authorized" AS "sentinel_authorized", "Agent"."licence_type" AS "licence_type", "Agent"."splashtop_authorized" AS "splashtop_authorized", "Agent"."gotoresolve_authorized" AS "gotoresolve_authorized", "Agent"."use" AS "use", "Agent"."logmeinid" AS "logmeinid", "Agent"."allowbeyondtrustinvites" AS "allowbeyondtrustinvites", "Agent"."jira_id" AS "jira_id", "Agent"."namewithinactive" AS "namewithinactive", "Agent"."apptsync" AS "apptsync", "Agent"."sendemailerrors" AS "sendemailerrors", "Agent"."can_approve_purchaseorder" AS "can_approve_purchaseorder", "Agent"."can_approve_quote" AS "can_approve_quote", "Agent"."can_approve_invoice" AS "can_approve_invoice", "Agent"."workday_id" AS "workday_id", "Agent"."costprice" AS "costprice", "Agent"."chargerate" AS "chargerate", "Agent"."email" AS "email", "Agent"."teams[0].id" AS "teams[0].id", "Agent"."teams[0].agent_id" AS "teams[0].agent_id", "Agent"."teams[0].team_id" AS "teams[0].team_id", "Agent"."teams[0].team_name" AS "teams[0].team_name", "Agent"."teams[0].department_id" AS "teams[0].department_id", "Agent"."teams[0].role_id" AS "teams[0].role_id", "Agent"."teams[0].is_manager" AS "teams[0].is_manager", "Agent"."teams[0].no_config_access" AS "teams[0].no_config_access", "Agent"."teams[0].unassigned_access" AS "teams[0].unassigned_access", "Agent"."teams[0].otheragent_access" AS "teams[0].otheragent_access", "Agent"."teams[0].fortickets" AS "teams[0].fortickets", "Agent"."teams[0].foropps" AS "teams[0].foropps", "Agent"."teams[0].forprojects" AS "teams[0].forprojects", "Agent"."teams[0].in_section" AS "teams[0].in_section", "Agent"."departments[0].id" AS "departments[0].id", "Agent"."departments[0].agent_id" AS "departments[0].agent_id", "Agent"."departments[0].department_id" AS "departments[0].department_id", "Agent"."departments[0].role_id" AS "departments[0].role_id", "Agent"."departments[0].membershiplevel" AS "departments[0].membershiplevel", "Agent"."departments[0].includeteamsintree" AS "departments[0].includeteamsintree", "Agent"."departments[1].id" AS "departments[1].id", "Agent"."departments[1].agent_id" AS "departments[1].agent_id", "Agent"."departments[1].department_id" AS "departments[1].department_id", "Agent"."departments[1].role_id" AS "departments[1].role_id", "Agent"."departments[1].membershiplevel" AS "departments[1].membershiplevel", "Agent"."departments[1].includeteamsintree" AS "departments[1].includeteamsintree", "Agent"."departments[2].id" AS "departments[2].id", "Agent"."departments[2].agent_id" AS "departments[2].agent_id", "Agent"."departments[2].department_id" AS "departments[2].department_id", "Agent"."departments[2].role_id" AS "departments[2].role_id", "Agent"."departments[2].membershiplevel" AS "departments[2].membershiplevel", "Agent"."departments[2].includeteamsintree" AS "departments[2].includeteamsintree", "Agent"."teams[1].id" AS "teams[1].id", "Agent"."teams[1].agent_id" AS "teams[1].agent_id", "Agent"."teams[1].team_id" AS "teams[1].team_id", "Agent"."teams[1].team_name" AS "teams[1].team_name", "Agent"."teams[1].department_id" AS "teams[1].department_id", "Agent"."teams[1].is_manager" AS "teams[1].is_manager", "Agent"."teams[1].no_config_access" AS "teams[1].no_config_access", "Agent"."teams[1].unassigned_access" AS "teams[1].unassigned_access", "Agent"."teams[1].otheragent_access" AS "teams[1].otheragent_access", "Agent"."teams[1].fortickets" AS "teams[1].fortickets", "Agent"."teams[1].foropps" AS "teams[1].foropps", "Agent"."teams[1].forprojects" AS "teams[1].forprojects", "Agent"."teams[1].in_section" AS "teams[1].in_section", "Agent"."teams[2].id" AS "teams[2].id", "Agent"."teams[2].agent_id" AS "teams[2].agent_id", "Agent"."teams[2].team_id" AS "teams[2].team_id", "Agent"."teams[2].team_name" AS "teams[2].team_name", "Agent"."teams[2].department_id" AS "teams[2].department_id", "Agent"."teams[2].role_id" AS "teams[2].role_id", "Agent"."teams[2].is_manager" AS "teams[2].is_manager", "Agent"."teams[2].no_config_access" AS "teams[2].no_config_access", "Agent"."teams[2].unassigned_access" AS "teams[2].unassigned_access", "Agent"."teams[2].otheragent_access" AS "teams[2].otheragent_access", "Agent"."teams[2].fortickets" AS "teams[2].fortickets", "Agent"."teams[2].foropps" AS "teams[2].foropps", "Agent"."teams[2].forprojects" AS "teams[2].forprojects", "Agent"."teams[2].in_section" AS "teams[2].in_section", "Agent"."teams[3].id" AS "teams[3].id", "Agent"."teams[3].agent_id" AS "teams[3].agent_id", "Agent"."teams[3].team_id" AS "teams[3].team_id", "Agent"."teams[3].team_name" AS "teams[3].team_name", "Agent"."teams[3].department_id" AS "teams[3].department_id", "Agent"."teams[3].role_id" AS "teams[3].role_id", "Agent"."teams[3].is_manager" AS "teams[3].is_manager", "Agent"."teams[3].no_config_access" AS "teams[3].no_config_access", "Agent"."teams[3].unassigned_access" AS "teams[3].unassigned_access", "Agent"."teams[3].otheragent_access" AS "teams[3].otheragent_access", "Agent"."teams[3].fortickets" AS "teams[3].fortickets", "Agent"."teams[3].foropps" AS "teams[3].foropps", "Agent"."teams[3].forprojects" AS "teams[3].forprojects", "Agent"."teams[3].in_section" AS "teams[3].in_section", "Agent"."teams[4].id" AS "teams[4].id", "Agent"."teams[4].agent_id" AS "teams[4].agent_id", "Agent"."teams[4].team_id" AS "teams[4].team_id", "Agent"."teams[4].team_name" AS "teams[4].team_name", "Agent"."teams[4].department_id" AS "teams[4].department_id", "Agent"."teams[4].role_id" AS "teams[4].role_id", "Agent"."teams[4].is_manager" AS "teams[4].is_manager", "Agent"."teams[4].no_config_access" AS "teams[4].no_config_access", "Agent"."teams[4].unassigned_access" AS "teams[4].unassigned_access", "Agent"."teams[4].otheragent_access" AS "teams[4].otheragent_access", "Agent"."teams[4].fortickets" AS "teams[4].fortickets", "Agent"."teams[4].foropps" AS "teams[4].foropps", "Agent"."teams[4].forprojects" AS "teams[4].forprojects", "Agent"."teams[4].in_section" AS "teams[4].in_section", "Agent"."departments[3].id" AS "departments[3].id", "Agent"."departments[3].agent_id" AS "departments[3].agent_id", "Agent"."departments[3].department_id" AS "departments[3].department_id", "Agent"."departments[3].role_id" AS "departments[3].role_id", "Agent"."departments[3].membershiplevel" AS "departments[3].membershiplevel", "Agent"."departments[3].includeteamsintree" AS "departments[3].includeteamsintree", "Agent"."departments[4].id" AS "departments[4].id", "Agent"."departments[4].agent_id" AS "departments[4].agent_id", "Agent"."departments[4].department_id" AS "departments[4].department_id", "Agent"."departments[4].role_id" AS "departments[4].role_id", "Agent"."departments[4].membershiplevel" AS "departments[4].membershiplevel", "Agent"."departments[4].includeteamsintree" AS "departments[4].includeteamsintree", "Agent"."departments[5].id" AS "departments[5].id", "Agent"."departments[5].agent_id" AS "departments[5].agent_id", "Agent"."departments[5].department_id" AS "departments[5].department_id", "Agent"."departments[5].role_id" AS "departments[5].role_id", "Agent"."departments[5].membershiplevel" AS "departments[5].membershiplevel", "Agent"."departments[5].includeteamsintree" AS "departments[5].includeteamsintree", "Agent"."teams[1].role_id" AS "teams[1].role_id", "Agent"."lastlogindate" AS "lastlogindate", "Agent"."teams[5].id" AS "teams[5].id", "Agent"."teams[5].agent_id" AS "teams[5].agent_id", "Agent"."teams[5].team_id" AS "teams[5].team_id", "Agent"."teams[5].team_name" AS "teams[5].team_name", "Agent"."teams[5].department_id" AS "teams[5].department_id", "Agent"."teams[5].is_manager" AS "teams[5].is_manager", "Agent"."teams[5].no_config_access" AS "teams[5].no_config_access", "Agent"."teams[5].unassigned_access" AS "teams[5].unassigned_access", "Agent"."teams[5].otheragent_access" AS "teams[5].otheragent_access", "Agent"."teams[5].fortickets" AS "teams[5].fortickets", "Agent"."teams[5].foropps" AS "teams[5].foropps", "Agent"."teams[5].forprojects" AS "teams[5].forprojects", "Agent"."teams[5].in_section" AS "teams[5].in_section", "Agent"."teams[6].id" AS "teams[6].id", "Agent"."teams[6].agent_id" AS "teams[6].agent_id", "Agent"."teams[6].team_id" AS "teams[6].team_id", "Agent"."teams[6].team_name" AS "teams[6].team_name", "Agent"."teams[6].department_id" AS "teams[6].department_id", "Agent"."teams[6].role_id" AS "teams[6].role_id", "Agent"."teams[6].is_manager" AS "teams[6].is_manager", "Agent"."teams[6].no_config_access" AS "teams[6].no_config_access", "Agent"."teams[6].unassigned_access" AS "teams[6].unassigned_access", "Agent"."teams[6].otheragent_access" AS "teams[6].otheragent_access", "Agent"."teams[6].fortickets" AS "teams[6].fortickets", "Agent"."teams[6].foropps" AS "teams[6].foropps", "Agent"."teams[6].forprojects" AS "teams[6].forprojects", "Agent"."teams[6].in_section" AS "teams[6].in_section", "Agent"."teams[7].id" AS "teams[7].id", "Agent"."teams[7].agent_id" AS "teams[7].agent_id", "Agent"."teams[7].team_id" AS "teams[7].team_id", "Agent"."teams[7].team_name" AS "teams[7].team_name", "Agent"."teams[7].department_id" AS "teams[7].department_id", "Agent"."teams[7].role_id" AS "teams[7].role_id", "Agent"."teams[7].is_manager" AS "teams[7].is_manager", "Agent"."teams[7].no_config_access" AS "teams[7].no_config_access", "Agent"."teams[7].unassigned_access" AS "teams[7].unassigned_access", "Agent"."teams[7].otheragent_access" AS "teams[7].otheragent_access", "Agent"."teams[7].fortickets" AS "teams[7].fortickets", "Agent"."teams[7].foropps" AS "teams[7].foropps", "Agent"."teams[7].forprojects" AS "teams[7].forprojects", "Agent"."teams[7].in_section" AS "teams[7].in_section", "Agent"."departments[6].id" AS "departments[6].id", "Agent"."departments[6].agent_id" AS "departments[6].agent_id", "Agent"."departments[6].department_id" AS "departments[6].department_id", "Agent"."departments[6].role_id" AS "departments[6].role_id", "Agent"."departments[6].membershiplevel" AS "departments[6].membershiplevel", "Agent"."departments[6].includeteamsintree" AS "departments[6].includeteamsintree", "Agent"."departments[7].id" AS "departments[7].id", "Agent"."departments[7].agent_id" AS "departments[7].agent_id", "Agent"."departments[7].department_id" AS "departments[7].department_id", "Agent"."departments[7].role_id" AS "departments[7].role_id", "Agent"."departments[7].membershiplevel" AS "departments[7].membershiplevel", "Agent"."departments[7].includeteamsintree" AS "departments[7].includeteamsintree", "Agent"."departments[8].id" AS "departments[8].id", "Agent"."departments[8].agent_id" AS "departments[8].agent_id", "Agent"."departments[8].department_id" AS "departments[8].department_id", "Agent"."departments[8].role_id" AS "departments[8].role_id", "Agent"."departments[8].membershiplevel" AS "departments[8].membershiplevel", "Agent"."departments[8].includeteamsintree" AS "departments[8].includeteamsintree", "Agent"."departments[9].id" AS "departments[9].id", "Agent"."departments[9].agent_id" AS "departments[9].agent_id", "Agent"."departments[9].department_id" AS "departments[9].department_id", "Agent"."departments[9].role_id" AS "departments[9].role_id", "Agent"."departments[9].membershiplevel" AS "departments[9].membershiplevel", "Agent"."departments[9].includeteamsintree" AS "departments[9].includeteamsintree", "Agent"."departments[10].id" AS "departments[10].id", "Agent"."departments[10].agent_id" AS "departments[10].agent_id", "Agent"."departments[10].department_id" AS "departments[10].department_id", "Agent"."departments[10].role_id" AS "departments[10].role_id", "Agent"."departments[10].membershiplevel" AS "departments[10].membershiplevel", "Agent"."departments[10].includeteamsintree" AS "departments[10].includeteamsintree", "Agent"."departments[11].id" AS "departments[11].id", "Agent"."departments[11].agent_id" AS "departments[11].agent_id", "Agent"."departments[11].department_id" AS "departments[11].department_id", "Agent"."departments[11].role_id" AS "departments[11].role_id", "Agent"."departments[11].membershiplevel" AS "departments[11].membershiplevel", "Agent"."departments[11].includeteamsintree" AS "departments[11].includeteamsintree", "Address"."id" AS "id(Address)", "Address"."type" AS "type", "Address"."line1" AS "line1", "Address"."line2" AS "line2", "Address"."line3" AS "line3", "Address"."line4" AS "line4", "Address"."postcode" AS "postcode", "Address"."primary" AS "primary", "Address"."inactive" AS "inactive", "Address"."date_active" AS "date_active", "Address"."site_id" AS "site_id", "Address"."description" AS "description", "Address"."lat" AS "lat", "Address"."long" AS "long", "Address"."note" AS "note", "Application"."grant_type" AS "grant_type", "Application"."loginas_agent_id" AS "loginas_agent_id", "Application"."inactive" AS "inactive(Application)", "Application"."system_use" AS "system_use", "Application"."redirecturi" AS "redirecturi", "Application"."logoutredirecturi" AS "logoutredirecturi", "Application"."cors_whitelist" AS "cors_whitelist", "Application"."allowagents" AS "allowagents", "Application"."allowusers" AS "allowusers", "Application"."organisation_id" AS "organisation_id", "Application"."loginas_client_id" AS "loginas_client_id", "Application"."loginas_supplier_id" AS "loginas_supplier_id", "Application"."loginentity" AS "loginentity", "Application"."language_id" AS "language_id", "Application"."disable_windowsauth" AS "disable_windowsauth", "Application"."disable_azure" AS "disable_azure", "Application"."disable_adfs" AS "disable_adfs", "Application"."disable_okta" AS "disable_okta", "Application"."disable_centrify" AS "disable_centrify", "Application"."disable_google" AS "disable_google", "Application"."disable_anon" AS "disable_anon", "Application"."clientId" AS "clientId", "Application"."concurrencyToken" AS "concurrencyToken", "Application"."displayName" AS "displayName", "Application"."id" AS "id(Application)", "Application"."postLogoutRedirectUris" AS "postLogoutRedirectUris", "Application"."redirectUris" AS "redirectUris", "Application"."type" AS "type(Application)", "Application"."_issystem" AS "_issystem", "Currency"."id" AS "id(Currency)", "Currency"."name" AS "name(Currency)", "Currency"."symbol" AS "symbol", "Currency"."code" AS "code", "Currency"."conversion_rate" AS "conversion_rate", "Currency"."last_updated" AS "last_updated", "EmailTemplate"."id" AS "id(EmailTemplate)", "EmailTemplate"."guid" AS "guid", "EmailTemplate"."name" AS "name(EmailTemplate)", "EmailTemplate"."description" AS "description(EmailTemplate)", "EmailTemplate"."sectionid" AS "sectionid", "EmailTemplate"."header_text" AS "header_text", "EmailTemplate"."messagegroup_id" AS "messagegroup_id", "Team"."id" AS "id(Team)", "Team"."guid" AS "guid(Team)", "Team"."name" AS "name(Team)", "Team"."sequence" AS "sequence", "Team"."forrequests" AS "forrequests", "Team"."foropps" AS "foropps", "Team"."forprojects" AS "forprojects", "Team"."ticket_count" AS "ticket_count", "Team"."department_id" AS "department_id", "Team"."department_name" AS "department_name", "Team"."org_team_name" AS "org_team_name", "Team"."inactive" AS "inactive(Team)", "Team"."override_column_id" AS "override_column_id", "Team"."teamphotopath" AS "teamphotopath", "Team"."hide_agents_in_tree_if_no_tickets" AS "hide_agents_in_tree_if_no_tickets", "Team"."concurrent_lic_limit" AS "concurrent_lic_limit", "Team"."use" AS "use(Team)", "Team"."homescreendashboardid" AS "homescreendashboardid", "Tax"."id" AS "id(Tax)", "Tax"."name" AS "name(Tax)", "Tax"."code" AS "code(Tax)", "Tax"."value" AS "value", "Tax"."xero_tenant_id" AS "xero_tenant_id", "Tax"."xero_tenant_name" AS "xero_tenant_name", "Tax"."third_party_desc" AS "third_party_desc", "Tax"."is_composite" AS "is_composite", "Tax"."kashflow_tenant_id" AS "kashflow_tenant_id", "Tax"."kashflow_tenant_name" AS "kashflow_tenant_name", "Tax"."qbocode" AS "qbocode", "Tax"."qbocode_name" AS "qbocode_name", "Tax"."qbotaxcode.value" AS "qbotaxcode.value", "Tax"."qbotaxcode.label" AS "qbotaxcode.label", "Tax"."qbo_company_name" AS "qbo_company_name" FROM "halops_dash"."Agent" AS "Agent" INNER JOIN "halops_dash"."Address" AS "Address" ON "Agent"."id" = "Address"."id" INNER JOIN "halops_dash"."Application" AS "Application" ON "Address"."inactive" = "Application"."inactive" INNER JOIN "halops_dash"."Currency" AS "Currency" ON "Agent"."id" = "Currency"."id" INNER JOIN "halops_dash"."EmailTemplate" AS "EmailTemplate" ON "Agent"."id" = "EmailTemplate"."id" INNER JOIN "halops_dash"."Team" AS "Team" ON "Agent"."id" = "Team"."id" INNER JOIN "halops_dash"."Tax" AS "Tax" ON "Agent"."id" = "Tax"."id") temp_table GROUP BY "department_name", "value", "email", "displayName", "jira_id", "line1", "line2", "postcode", "department_name", "value", "email", "displayName", "jira_id", "line1", "line2", "postcode" ORDER BY "department_name" ASC NULLS FIRST
'''

shft_q2 = '''SELECT "displayName" AS "displayName", SUM("value") AS "sum(value)", SUM("conversion_rate") AS "sum(conversion_rate)" FROM (SELECT "Agent"."id" AS "id", "Agent"."name" AS "name", "Agent"."team" AS "team", "Agent"."isdisabled" AS "isdisabled", "Agent"."ad" AS "ad", "Agent"."agentphotopath" AS "agentphotopath", "Agent"."initials" AS "initials", "Agent"."firstname" AS "firstname", "Agent"."surname" AS "surname", "Agent"."colour" AS "colour", "Agent"."jobtitle" AS "jobtitle", "Agent"."sms" AS "sms", "Agent"."extensionnumber" AS "extensionnumber", "Agent"."is_agent" AS "is_agent", "Agent"."googleemail" AS "googleemail", "Agent"."linemanager" AS "linemanager", "Agent"."exchange_authorized" AS "exchange_authorized", "Agent"."exchange_account" AS "exchange_account", "Agent"."sentinel_authorized" AS "sentinel_authorized", "Agent"."licence_type" AS "licence_type", "Agent"."splashtop_authorized" AS "splashtop_authorized", "Agent"."gotoresolve_authorized" AS "gotoresolve_authorized", "Agent"."use" AS "use", "Agent"."logmeinid" AS "logmeinid", "Agent"."allowbeyondtrustinvites" AS "allowbeyondtrustinvites", "Agent"."jira_id" AS "jira_id", "Agent"."namewithinactive" AS "namewithinactive", "Agent"."apptsync" AS "apptsync", "Agent"."sendemailerrors" AS "sendemailerrors", "Agent"."can_approve_purchaseorder" AS "can_approve_purchaseorder", "Agent"."can_approve_quote" AS "can_approve_quote", "Agent"."can_approve_invoice" AS "can_approve_invoice", "Agent"."workday_id" AS "workday_id", "Agent"."costprice" AS "costprice", "Agent"."chargerate" AS "chargerate", "Agent"."email" AS "email", "Agent"."teams[0].id" AS "teams[0].id", "Agent"."teams[0].agent_id" AS "teams[0].agent_id", "Agent"."teams[0].team_id" AS "teams[0].team_id", "Agent"."teams[0].team_name" AS "teams[0].team_name", "Agent"."teams[0].department_id" AS "teams[0].department_id", "Agent"."teams[0].role_id" AS "teams[0].role_id", "Agent"."teams[0].is_manager" AS "teams[0].is_manager", "Agent"."teams[0].no_config_access" AS "teams[0].no_config_access", "Agent"."teams[0].unassigned_access" AS "teams[0].unassigned_access", "Agent"."teams[0].otheragent_access" AS "teams[0].otheragent_access", "Agent"."teams[0].fortickets" AS "teams[0].fortickets", "Agent"."teams[0].foropps" AS "teams[0].foropps", "Agent"."teams[0].forprojects" AS "teams[0].forprojects", "Agent"."teams[0].in_section" AS "teams[0].in_section", "Agent"."departments[0].id" AS "departments[0].id", "Agent"."departments[0].agent_id" AS "departments[0].agent_id", "Agent"."departments[0].department_id" AS "departments[0].department_id", "Agent"."departments[0].role_id" AS "departments[0].role_id", "Agent"."departments[0].membershiplevel" AS "departments[0].membershiplevel", "Agent"."departments[0].includeteamsintree" AS "departments[0].includeteamsintree", "Agent"."departments[1].id" AS "departments[1].id", "Agent"."departments[1].agent_id" AS "departments[1].agent_id", "Agent"."departments[1].department_id" AS "departments[1].department_id", "Agent"."departments[1].role_id" AS "departments[1].role_id", "Agent"."departments[1].membershiplevel" AS "departments[1].membershiplevel", "Agent"."departments[1].includeteamsintree" AS "departments[1].includeteamsintree", "Agent"."departments[2].id" AS "departments[2].id", "Agent"."departments[2].agent_id" AS "departments[2].agent_id", "Agent"."departments[2].department_id" AS "departments[2].department_id", "Agent"."departments[2].role_id" AS "departments[2].role_id", "Agent"."departments[2].membershiplevel" AS "departments[2].membershiplevel", "Agent"."departments[2].includeteamsintree" AS "departments[2].includeteamsintree", "Agent"."teams[1].id" AS "teams[1].id", "Agent"."teams[1].agent_id" AS "teams[1].agent_id", "Agent"."teams[1].team_id" AS "teams[1].team_id", "Agent"."teams[1].team_name" AS "teams[1].team_name", "Agent"."teams[1].department_id" AS "teams[1].department_id", "Agent"."teams[1].is_manager" AS "teams[1].is_manager", "Agent"."teams[1].no_config_access" AS "teams[1].no_config_access", "Agent"."teams[1].unassigned_access" AS "teams[1].unassigned_access", "Agent"."teams[1].otheragent_access" AS "teams[1].otheragent_access", "Agent"."teams[1].fortickets" AS "teams[1].fortickets", "Agent"."teams[1].foropps" AS "teams[1].foropps", "Agent"."teams[1].forprojects" AS "teams[1].forprojects", "Agent"."teams[1].in_section" AS "teams[1].in_section", "Agent"."teams[2].id" AS "teams[2].id", "Agent"."teams[2].agent_id" AS "teams[2].agent_id", "Agent"."teams[2].team_id" AS "teams[2].team_id", "Agent"."teams[2].team_name" AS "teams[2].team_name", "Agent"."teams[2].department_id" AS "teams[2].department_id", "Agent"."teams[2].role_id" AS "teams[2].role_id", "Agent"."teams[2].is_manager" AS "teams[2].is_manager", "Agent"."teams[2].no_config_access" AS "teams[2].no_config_access", "Agent"."teams[2].unassigned_access" AS "teams[2].unassigned_access", "Agent"."teams[2].otheragent_access" AS "teams[2].otheragent_access", "Agent"."teams[2].fortickets" AS "teams[2].fortickets", "Agent"."teams[2].foropps" AS "teams[2].foropps", "Agent"."teams[2].forprojects" AS "teams[2].forprojects", "Agent"."teams[2].in_section" AS "teams[2].in_section", "Agent"."teams[3].id" AS "teams[3].id", "Agent"."teams[3].agent_id" AS "teams[3].agent_id", "Agent"."teams[3].team_id" AS "teams[3].team_id", "Agent"."teams[3].team_name" AS "teams[3].team_name", "Agent"."teams[3].department_id" AS "teams[3].department_id", "Agent"."teams[3].role_id" AS "teams[3].role_id", "Agent"."teams[3].is_manager" AS "teams[3].is_manager", "Agent"."teams[3].no_config_access" AS "teams[3].no_config_access", "Agent"."teams[3].unassigned_access" AS "teams[3].unassigned_access", "Agent"."teams[3].otheragent_access" AS "teams[3].otheragent_access", "Agent"."teams[3].fortickets" AS "teams[3].fortickets", "Agent"."teams[3].foropps" AS "teams[3].foropps", "Agent"."teams[3].forprojects" AS "teams[3].forprojects", "Agent"."teams[3].in_section" AS "teams[3].in_section", "Agent"."teams[4].id" AS "teams[4].id", "Agent"."teams[4].agent_id" AS "teams[4].agent_id", "Agent"."teams[4].team_id" AS "teams[4].team_id", "Agent"."teams[4].team_name" AS "teams[4].team_name", "Agent"."teams[4].department_id" AS "teams[4].department_id", "Agent"."teams[4].role_id" AS "teams[4].role_id", "Agent"."teams[4].is_manager" AS "teams[4].is_manager", "Agent"."teams[4].no_config_access" AS "teams[4].no_config_access", "Agent"."teams[4].unassigned_access" AS "teams[4].unassigned_access", "Agent"."teams[4].otheragent_access" AS "teams[4].otheragent_access", "Agent"."teams[4].fortickets" AS "teams[4].fortickets", "Agent"."teams[4].foropps" AS "teams[4].foropps", "Agent"."teams[4].forprojects" AS "teams[4].forprojects", "Agent"."teams[4].in_section" AS "teams[4].in_section", "Agent"."departments[3].id" AS "departments[3].id", "Agent"."departments[3].agent_id" AS "departments[3].agent_id", "Agent"."departments[3].department_id" AS "departments[3].department_id", "Agent"."departments[3].role_id" AS "departments[3].role_id", "Agent"."departments[3].membershiplevel" AS "departments[3].membershiplevel", "Agent"."departments[3].includeteamsintree" AS "departments[3].includeteamsintree", "Agent"."departments[4].id" AS "departments[4].id", "Agent"."departments[4].agent_id" AS "departments[4].agent_id", "Agent"."departments[4].department_id" AS "departments[4].department_id", "Agent"."departments[4].role_id" AS "departments[4].role_id", "Agent"."departments[4].membershiplevel" AS "departments[4].membershiplevel", "Agent"."departments[4].includeteamsintree" AS "departments[4].includeteamsintree", "Agent"."departments[5].id" AS "departments[5].id", "Agent"."departments[5].agent_id" AS "departments[5].agent_id", "Agent"."departments[5].department_id" AS "departments[5].department_id", "Agent"."departments[5].role_id" AS "departments[5].role_id", "Agent"."departments[5].membershiplevel" AS "departments[5].membershiplevel", "Agent"."departments[5].includeteamsintree" AS "departments[5].includeteamsintree", "Agent"."teams[1].role_id" AS "teams[1].role_id", "Agent"."lastlogindate" AS "lastlogindate", "Agent"."teams[5].id" AS "teams[5].id", "Agent"."teams[5].agent_id" AS "teams[5].agent_id", "Agent"."teams[5].team_id" AS "teams[5].team_id", "Agent"."teams[5].team_name" AS "teams[5].team_name", "Agent"."teams[5].department_id" AS "teams[5].department_id", "Agent"."teams[5].is_manager" AS "teams[5].is_manager", "Agent"."teams[5].no_config_access" AS "teams[5].no_config_access", "Agent"."teams[5].unassigned_access" AS "teams[5].unassigned_access", "Agent"."teams[5].otheragent_access" AS "teams[5].otheragent_access", "Agent"."teams[5].fortickets" AS "teams[5].fortickets", "Agent"."teams[5].foropps" AS "teams[5].foropps", "Agent"."teams[5].forprojects" AS "teams[5].forprojects", "Agent"."teams[5].in_section" AS "teams[5].in_section", "Agent"."teams[6].id" AS "teams[6].id", "Agent"."teams[6].agent_id" AS "teams[6].agent_id", "Agent"."teams[6].team_id" AS "teams[6].team_id", "Agent"."teams[6].team_name" AS "teams[6].team_name", "Agent"."teams[6].department_id" AS "teams[6].department_id", "Agent"."teams[6].role_id" AS "teams[6].role_id", "Agent"."teams[6].is_manager" AS "teams[6].is_manager", "Agent"."teams[6].no_config_access" AS "teams[6].no_config_access", "Agent"."teams[6].unassigned_access" AS "teams[6].unassigned_access", "Agent"."teams[6].otheragent_access" AS "teams[6].otheragent_access", "Agent"."teams[6].fortickets" AS "teams[6].fortickets", "Agent"."teams[6].foropps" AS "teams[6].foropps", "Agent"."teams[6].forprojects" AS "teams[6].forprojects", "Agent"."teams[6].in_section" AS "teams[6].in_section", "Agent"."teams[7].id" AS "teams[7].id", "Agent"."teams[7].agent_id" AS "teams[7].agent_id", "Agent"."teams[7].team_id" AS "teams[7].team_id", "Agent"."teams[7].team_name" AS "teams[7].team_name", "Agent"."teams[7].department_id" AS "teams[7].department_id", "Agent"."teams[7].role_id" AS "teams[7].role_id", "Agent"."teams[7].is_manager" AS "teams[7].is_manager", "Agent"."teams[7].no_config_access" AS "teams[7].no_config_access", "Agent"."teams[7].unassigned_access" AS "teams[7].unassigned_access", "Agent"."teams[7].otheragent_access" AS "teams[7].otheragent_access", "Agent"."teams[7].fortickets" AS "teams[7].fortickets", "Agent"."teams[7].foropps" AS "teams[7].foropps", "Agent"."teams[7].forprojects" AS "teams[7].forprojects", "Agent"."teams[7].in_section" AS "teams[7].in_section", "Agent"."departments[6].id" AS "departments[6].id", "Agent"."departments[6].agent_id" AS "departments[6].agent_id", "Agent"."departments[6].department_id" AS "departments[6].department_id", "Agent"."departments[6].role_id" AS "departments[6].role_id", "Agent"."departments[6].membershiplevel" AS "departments[6].membershiplevel", "Agent"."departments[6].includeteamsintree" AS "departments[6].includeteamsintree", "Agent"."departments[7].id" AS "departments[7].id", "Agent"."departments[7].agent_id" AS "departments[7].agent_id", "Agent"."departments[7].department_id" AS "departments[7].department_id", "Agent"."departments[7].role_id" AS "departments[7].role_id", "Agent"."departments[7].membershiplevel" AS "departments[7].membershiplevel", "Agent"."departments[7].includeteamsintree" AS "departments[7].includeteamsintree", "Agent"."departments[8].id" AS "departments[8].id", "Agent"."departments[8].agent_id" AS "departments[8].agent_id", "Agent"."departments[8].department_id" AS "departments[8].department_id", "Agent"."departments[8].role_id" AS "departments[8].role_id", "Agent"."departments[8].membershiplevel" AS "departments[8].membershiplevel", "Agent"."departments[8].includeteamsintree" AS "departments[8].includeteamsintree", "Agent"."departments[9].id" AS "departments[9].id", "Agent"."departments[9].agent_id" AS "departments[9].agent_id", "Agent"."departments[9].department_id" AS "departments[9].department_id", "Agent"."departments[9].role_id" AS "departments[9].role_id", "Agent"."departments[9].membershiplevel" AS "departments[9].membershiplevel", "Agent"."departments[9].includeteamsintree" AS "departments[9].includeteamsintree", "Agent"."departments[10].id" AS "departments[10].id", "Agent"."departments[10].agent_id" AS "departments[10].agent_id", "Agent"."departments[10].department_id" AS "departments[10].department_id", "Agent"."departments[10].role_id" AS "departments[10].role_id", "Agent"."departments[10].membershiplevel" AS "departments[10].membershiplevel", "Agent"."departments[10].includeteamsintree" AS "departments[10].includeteamsintree", "Agent"."departments[11].id" AS "departments[11].id", "Agent"."departments[11].agent_id" AS "departments[11].agent_id", "Agent"."departments[11].department_id" AS "departments[11].department_id", "Agent"."departments[11].role_id" AS "departments[11].role_id", "Agent"."departments[11].membershiplevel" AS "departments[11].membershiplevel", "Agent"."departments[11].includeteamsintree" AS "departments[11].includeteamsintree", "Address"."id" AS "id(Address)", "Address"."type" AS "type", "Address"."line1" AS "line1", "Address"."line2" AS "line2", "Address"."line3" AS "line3", "Address"."line4" AS "line4", "Address"."postcode" AS "postcode", "Address"."primary" AS "primary", "Address"."inactive" AS "inactive", "Address"."date_active" AS "date_active", "Address"."site_id" AS "site_id", "Address"."description" AS "description", "Address"."lat" AS "lat", "Address"."long" AS "long", "Address"."note" AS "note", "Application"."grant_type" AS "grant_type", "Application"."loginas_agent_id" AS "loginas_agent_id", "Application"."inactive" AS "inactive(Application)", "Application"."system_use" AS "system_use", "Application"."redirecturi" AS "redirecturi", "Application"."logoutredirecturi" AS "logoutredirecturi", "Application"."cors_whitelist" AS "cors_whitelist", "Application"."allowagents" AS "allowagents", "Application"."allowusers" AS "allowusers", "Application"."organisation_id" AS "organisation_id", "Application"."loginas_client_id" AS "loginas_client_id", "Application"."loginas_supplier_id" AS "loginas_supplier_id", "Application"."loginentity" AS "loginentity", "Application"."language_id" AS "language_id", "Application"."disable_windowsauth" AS "disable_windowsauth", "Application"."disable_azure" AS "disable_azure", "Application"."disable_adfs" AS "disable_adfs", "Application"."disable_okta" AS "disable_okta", "Application"."disable_centrify" AS "disable_centrify", "Application"."disable_google" AS "disable_google", "Application"."disable_anon" AS "disable_anon", "Application"."clientId" AS "clientId", "Application"."concurrencyToken" AS "concurrencyToken", "Application"."displayName" AS "displayName", "Application"."id" AS "id(Application)", "Application"."postLogoutRedirectUris" AS "postLogoutRedirectUris", "Application"."redirectUris" AS "redirectUris", "Application"."type" AS "type(Application)", "Application"."_issystem" AS "_issystem", "Currency"."id" AS "id(Currency)", "Currency"."name" AS "name(Currency)", "Currency"."symbol" AS "symbol", "Currency"."code" AS "code", "Currency"."conversion_rate" AS "conversion_rate", "Currency"."last_updated" AS "last_updated", "EmailTemplate"."id" AS "id(EmailTemplate)", "EmailTemplate"."guid" AS "guid", "EmailTemplate"."name" AS "name(EmailTemplate)", "EmailTemplate"."description" AS "description(EmailTemplate)", "EmailTemplate"."sectionid" AS "sectionid", "EmailTemplate"."header_text" AS "header_text", "EmailTemplate"."messagegroup_id" AS "messagegroup_id", "Team"."id" AS "id(Team)", "Team"."guid" AS "guid(Team)", "Team"."name" AS "name(Team)", "Team"."sequence" AS "sequence", "Team"."forrequests" AS "forrequests", "Team"."foropps" AS "foropps", "Team"."forprojects" AS "forprojects", "Team"."ticket_count" AS "ticket_count", "Team"."department_id" AS "department_id", "Team"."department_name" AS "department_name", "Team"."org_team_name" AS "org_team_name", "Team"."inactive" AS "inactive(Team)", "Team"."override_column_id" AS "override_column_id", "Team"."teamphotopath" AS "teamphotopath", "Team"."hide_agents_in_tree_if_no_tickets" AS "hide_agents_in_tree_if_no_tickets", "Team"."concurrent_lic_limit" AS "concurrent_lic_limit", "Team"."use" AS "use(Team)", "Team"."homescreendashboardid" AS "homescreendashboardid", "Tax"."id" AS "id(Tax)", "Tax"."name" AS "name(Tax)", "Tax"."code" AS "code(Tax)", "Tax"."value" AS "value", "Tax"."xero_tenant_id" AS "xero_tenant_id", "Tax"."xero_tenant_name" AS "xero_tenant_name", "Tax"."third_party_desc" AS "third_party_desc", "Tax"."is_composite" AS "is_composite", "Tax"."kashflow_tenant_id" AS "kashflow_tenant_id", "Tax"."kashflow_tenant_name" AS "kashflow_tenant_name", "Tax"."qbocode" AS "qbocode", "Tax"."qbocode_name" AS "qbocode_name", "Tax"."qbotaxcode.value" AS "qbotaxcode.value", "Tax"."qbotaxcode.label" AS "qbotaxcode.label", "Tax"."qbo_company_name" AS "qbo_company_name" FROM "halops_dash"."Agent" AS "Agent" INNER JOIN "halops_dash"."Address" AS "Address" ON "Agent"."id" = "Address"."id" INNER JOIN "halops_dash"."Application" AS "Application" ON "Address"."inactive" = "Application"."inactive" INNER JOIN "halops_dash"."Currency" AS "Currency" ON "Agent"."id" = "Currency"."id" INNER JOIN "halops_dash"."EmailTemplate" AS "EmailTemplate" ON "Agent"."id" = "EmailTemplate"."id" INNER JOIN "halops_dash"."Team" AS "Team" ON "Agent"."id" = "Team"."id" INNER JOIN "halops_dash"."Tax" AS "Tax" ON "Agent"."id" = "Tax"."id") temp_table GROUP BY "displayName", "displayName" ORDER BY "displayName" ASC NULLS FIRST
'''

shft_q3 = '''SELECT "displayName" AS "displayName", COUNT("id(EmailTemplate)") AS "count(id(EmailTemplate))" FROM (SELECT "Agent"."id" AS "id", "Agent"."name" AS "name", "Agent"."team" AS "team", "Agent"."isdisabled" AS "isdisabled", "Agent"."ad" AS "ad", "Agent"."agentphotopath" AS "agentphotopath", "Agent"."initials" AS "initials", "Agent"."firstname" AS "firstname", "Agent"."surname" AS "surname", "Agent"."colour" AS "colour", "Agent"."jobtitle" AS "jobtitle", "Agent"."sms" AS "sms", "Agent"."extensionnumber" AS "extensionnumber", "Agent"."is_agent" AS "is_agent", "Agent"."googleemail" AS "googleemail", "Agent"."linemanager" AS "linemanager", "Agent"."exchange_authorized" AS "exchange_authorized", "Agent"."exchange_account" AS "exchange_account", "Agent"."sentinel_authorized" AS "sentinel_authorized", "Agent"."licence_type" AS "licence_type", "Agent"."splashtop_authorized" AS "splashtop_authorized", "Agent"."gotoresolve_authorized" AS "gotoresolve_authorized", "Agent"."use" AS "use", "Agent"."logmeinid" AS "logmeinid", "Agent"."allowbeyondtrustinvites" AS "allowbeyondtrustinvites", "Agent"."jira_id" AS "jira_id", "Agent"."namewithinactive" AS "namewithinactive", "Agent"."apptsync" AS "apptsync", "Agent"."sendemailerrors" AS "sendemailerrors", "Agent"."can_approve_purchaseorder" AS "can_approve_purchaseorder", "Agent"."can_approve_quote" AS "can_approve_quote", "Agent"."can_approve_invoice" AS "can_approve_invoice", "Agent"."workday_id" AS "workday_id", "Agent"."costprice" AS "costprice", "Agent"."chargerate" AS "chargerate", "Agent"."email" AS "email", "Agent"."teams[0].id" AS "teams[0].id", "Agent"."teams[0].agent_id" AS "teams[0].agent_id", "Agent"."teams[0].team_id" AS "teams[0].team_id", "Agent"."teams[0].team_name" AS "teams[0].team_name", "Agent"."teams[0].department_id" AS "teams[0].department_id", "Agent"."teams[0].role_id" AS "teams[0].role_id", "Agent"."teams[0].is_manager" AS "teams[0].is_manager", "Agent"."teams[0].no_config_access" AS "teams[0].no_config_access", "Agent"."teams[0].unassigned_access" AS "teams[0].unassigned_access", "Agent"."teams[0].otheragent_access" AS "teams[0].otheragent_access", "Agent"."teams[0].fortickets" AS "teams[0].fortickets", "Agent"."teams[0].foropps" AS "teams[0].foropps", "Agent"."teams[0].forprojects" AS "teams[0].forprojects", "Agent"."teams[0].in_section" AS "teams[0].in_section", "Agent"."departments[0].id" AS "departments[0].id", "Agent"."departments[0].agent_id" AS "departments[0].agent_id", "Agent"."departments[0].department_id" AS "departments[0].department_id", "Agent"."departments[0].role_id" AS "departments[0].role_id", "Agent"."departments[0].membershiplevel" AS "departments[0].membershiplevel", "Agent"."departments[0].includeteamsintree" AS "departments[0].includeteamsintree", "Agent"."departments[1].id" AS "departments[1].id", "Agent"."departments[1].agent_id" AS "departments[1].agent_id", "Agent"."departments[1].department_id" AS "departments[1].department_id", "Agent"."departments[1].role_id" AS "departments[1].role_id", "Agent"."departments[1].membershiplevel" AS "departments[1].membershiplevel", "Agent"."departments[1].includeteamsintree" AS "departments[1].includeteamsintree", "Agent"."departments[2].id" AS "departments[2].id", "Agent"."departments[2].agent_id" AS "departments[2].agent_id", "Agent"."departments[2].department_id" AS "departments[2].department_id", "Agent"."departments[2].role_id" AS "departments[2].role_id", "Agent"."departments[2].membershiplevel" AS "departments[2].membershiplevel", "Agent"."departments[2].includeteamsintree" AS "departments[2].includeteamsintree", "Agent"."teams[1].id" AS "teams[1].id", "Agent"."teams[1].agent_id" AS "teams[1].agent_id", "Agent"."teams[1].team_id" AS "teams[1].team_id", "Agent"."teams[1].team_name" AS "teams[1].team_name", "Agent"."teams[1].department_id" AS "teams[1].department_id", "Agent"."teams[1].is_manager" AS "teams[1].is_manager", "Agent"."teams[1].no_config_access" AS "teams[1].no_config_access", "Agent"."teams[1].unassigned_access" AS "teams[1].unassigned_access", "Agent"."teams[1].otheragent_access" AS "teams[1].otheragent_access", "Agent"."teams[1].fortickets" AS "teams[1].fortickets", "Agent"."teams[1].foropps" AS "teams[1].foropps", "Agent"."teams[1].forprojects" AS "teams[1].forprojects", "Agent"."teams[1].in_section" AS "teams[1].in_section", "Agent"."teams[2].id" AS "teams[2].id", "Agent"."teams[2].agent_id" AS "teams[2].agent_id", "Agent"."teams[2].team_id" AS "teams[2].team_id", "Agent"."teams[2].team_name" AS "teams[2].team_name", "Agent"."teams[2].department_id" AS "teams[2].department_id", "Agent"."teams[2].role_id" AS "teams[2].role_id", "Agent"."teams[2].is_manager" AS "teams[2].is_manager", "Agent"."teams[2].no_config_access" AS "teams[2].no_config_access", "Agent"."teams[2].unassigned_access" AS "teams[2].unassigned_access", "Agent"."teams[2].otheragent_access" AS "teams[2].otheragent_access", "Agent"."teams[2].fortickets" AS "teams[2].fortickets", "Agent"."teams[2].foropps" AS "teams[2].foropps", "Agent"."teams[2].forprojects" AS "teams[2].forprojects", "Agent"."teams[2].in_section" AS "teams[2].in_section", "Agent"."teams[3].id" AS "teams[3].id", "Agent"."teams[3].agent_id" AS "teams[3].agent_id", "Agent"."teams[3].team_id" AS "teams[3].team_id", "Agent"."teams[3].team_name" AS "teams[3].team_name", "Agent"."teams[3].department_id" AS "teams[3].department_id", "Agent"."teams[3].role_id" AS "teams[3].role_id", "Agent"."teams[3].is_manager" AS "teams[3].is_manager", "Agent"."teams[3].no_config_access" AS "teams[3].no_config_access", "Agent"."teams[3].unassigned_access" AS "teams[3].unassigned_access", "Agent"."teams[3].otheragent_access" AS "teams[3].otheragent_access", "Agent"."teams[3].fortickets" AS "teams[3].fortickets", "Agent"."teams[3].foropps" AS "teams[3].foropps", "Agent"."teams[3].forprojects" AS "teams[3].forprojects", "Agent"."teams[3].in_section" AS "teams[3].in_section", "Agent"."teams[4].id" AS "teams[4].id", "Agent"."teams[4].agent_id" AS "teams[4].agent_id", "Agent"."teams[4].team_id" AS "teams[4].team_id", "Agent"."teams[4].team_name" AS "teams[4].team_name", "Agent"."teams[4].department_id" AS "teams[4].department_id", "Agent"."teams[4].role_id" AS "teams[4].role_id", "Agent"."teams[4].is_manager" AS "teams[4].is_manager", "Agent"."teams[4].no_config_access" AS "teams[4].no_config_access", "Agent"."teams[4].unassigned_access" AS "teams[4].unassigned_access", "Agent"."teams[4].otheragent_access" AS "teams[4].otheragent_access", "Agent"."teams[4].fortickets" AS "teams[4].fortickets", "Agent"."teams[4].foropps" AS "teams[4].foropps", "Agent"."teams[4].forprojects" AS "teams[4].forprojects", "Agent"."teams[4].in_section" AS "teams[4].in_section", "Agent"."departments[3].id" AS "departments[3].id", "Agent"."departments[3].agent_id" AS "departments[3].agent_id", "Agent"."departments[3].department_id" AS "departments[3].department_id", "Agent"."departments[3].role_id" AS "departments[3].role_id", "Agent"."departments[3].membershiplevel" AS "departments[3].membershiplevel", "Agent"."departments[3].includeteamsintree" AS "departments[3].includeteamsintree", "Agent"."departments[4].id" AS "departments[4].id", "Agent"."departments[4].agent_id" AS "departments[4].agent_id", "Agent"."departments[4].department_id" AS "departments[4].department_id", "Agent"."departments[4].role_id" AS "departments[4].role_id", "Agent"."departments[4].membershiplevel" AS "departments[4].membershiplevel", "Agent"."departments[4].includeteamsintree" AS "departments[4].includeteamsintree", "Agent"."departments[5].id" AS "departments[5].id", "Agent"."departments[5].agent_id" AS "departments[5].agent_id", "Agent"."departments[5].department_id" AS "departments[5].department_id", "Agent"."departments[5].role_id" AS "departments[5].role_id", "Agent"."departments[5].membershiplevel" AS "departments[5].membershiplevel", "Agent"."departments[5].includeteamsintree" AS "departments[5].includeteamsintree", "Agent"."teams[1].role_id" AS "teams[1].role_id", "Agent"."lastlogindate" AS "lastlogindate", "Agent"."teams[5].id" AS "teams[5].id", "Agent"."teams[5].agent_id" AS "teams[5].agent_id", "Agent"."teams[5].team_id" AS "teams[5].team_id", "Agent"."teams[5].team_name" AS "teams[5].team_name", "Agent"."teams[5].department_id" AS "teams[5].department_id", "Agent"."teams[5].is_manager" AS "teams[5].is_manager", "Agent"."teams[5].no_config_access" AS "teams[5].no_config_access", "Agent"."teams[5].unassigned_access" AS "teams[5].unassigned_access", "Agent"."teams[5].otheragent_access" AS "teams[5].otheragent_access", "Agent"."teams[5].fortickets" AS "teams[5].fortickets", "Agent"."teams[5].foropps" AS "teams[5].foropps", "Agent"."teams[5].forprojects" AS "teams[5].forprojects", "Agent"."teams[5].in_section" AS "teams[5].in_section", "Agent"."teams[6].id" AS "teams[6].id", "Agent"."teams[6].agent_id" AS "teams[6].agent_id", "Agent"."teams[6].team_id" AS "teams[6].team_id", "Agent"."teams[6].team_name" AS "teams[6].team_name", "Agent"."teams[6].department_id" AS "teams[6].department_id", "Agent"."teams[6].role_id" AS "teams[6].role_id", "Agent"."teams[6].is_manager" AS "teams[6].is_manager", "Agent"."teams[6].no_config_access" AS "teams[6].no_config_access", "Agent"."teams[6].unassigned_access" AS "teams[6].unassigned_access", "Agent"."teams[6].otheragent_access" AS "teams[6].otheragent_access", "Agent"."teams[6].fortickets" AS "teams[6].fortickets", "Agent"."teams[6].foropps" AS "teams[6].foropps", "Agent"."teams[6].forprojects" AS "teams[6].forprojects", "Agent"."teams[6].in_section" AS "teams[6].in_section", "Agent"."teams[7].id" AS "teams[7].id", "Agent"."teams[7].agent_id" AS "teams[7].agent_id", "Agent"."teams[7].team_id" AS "teams[7].team_id", "Agent"."teams[7].team_name" AS "teams[7].team_name", "Agent"."teams[7].department_id" AS "teams[7].department_id", "Agent"."teams[7].role_id" AS "teams[7].role_id", "Agent"."teams[7].is_manager" AS "teams[7].is_manager", "Agent"."teams[7].no_config_access" AS "teams[7].no_config_access", "Agent"."teams[7].unassigned_access" AS "teams[7].unassigned_access", "Agent"."teams[7].otheragent_access" AS "teams[7].otheragent_access", "Agent"."teams[7].fortickets" AS "teams[7].fortickets", "Agent"."teams[7].foropps" AS "teams[7].foropps", "Agent"."teams[7].forprojects" AS "teams[7].forprojects", "Agent"."teams[7].in_section" AS "teams[7].in_section", "Agent"."departments[6].id" AS "departments[6].id", "Agent"."departments[6].agent_id" AS "departments[6].agent_id", "Agent"."departments[6].department_id" AS "departments[6].department_id", "Agent"."departments[6].role_id" AS "departments[6].role_id", "Agent"."departments[6].membershiplevel" AS "departments[6].membershiplevel", "Agent"."departments[6].includeteamsintree" AS "departments[6].includeteamsintree", "Agent"."departments[7].id" AS "departments[7].id", "Agent"."departments[7].agent_id" AS "departments[7].agent_id", "Agent"."departments[7].department_id" AS "departments[7].department_id", "Agent"."departments[7].role_id" AS "departments[7].role_id", "Agent"."departments[7].membershiplevel" AS "departments[7].membershiplevel", "Agent"."departments[7].includeteamsintree" AS "departments[7].includeteamsintree", "Agent"."departments[8].id" AS "departments[8].id", "Agent"."departments[8].agent_id" AS "departments[8].agent_id", "Agent"."departments[8].department_id" AS "departments[8].department_id", "Agent"."departments[8].role_id" AS "departments[8].role_id", "Agent"."departments[8].membershiplevel" AS "departments[8].membershiplevel", "Agent"."departments[8].includeteamsintree" AS "departments[8].includeteamsintree", "Agent"."departments[9].id" AS "departments[9].id", "Agent"."departments[9].agent_id" AS "departments[9].agent_id", "Agent"."departments[9].department_id" AS "departments[9].department_id", "Agent"."departments[9].role_id" AS "departments[9].role_id", "Agent"."departments[9].membershiplevel" AS "departments[9].membershiplevel", "Agent"."departments[9].includeteamsintree" AS "departments[9].includeteamsintree", "Agent"."departments[10].id" AS "departments[10].id", "Agent"."departments[10].agent_id" AS "departments[10].agent_id", "Agent"."departments[10].department_id" AS "departments[10].department_id", "Agent"."departments[10].role_id" AS "departments[10].role_id", "Agent"."departments[10].membershiplevel" AS "departments[10].membershiplevel", "Agent"."departments[10].includeteamsintree" AS "departments[10].includeteamsintree", "Agent"."departments[11].id" AS "departments[11].id", "Agent"."departments[11].agent_id" AS "departments[11].agent_id", "Agent"."departments[11].department_id" AS "departments[11].department_id", "Agent"."departments[11].role_id" AS "departments[11].role_id", "Agent"."departments[11].membershiplevel" AS "departments[11].membershiplevel", "Agent"."departments[11].includeteamsintree" AS "departments[11].includeteamsintree", "Address"."id" AS "id(Address)", "Address"."type" AS "type", "Address"."line1" AS "line1", "Address"."line2" AS "line2", "Address"."line3" AS "line3", "Address"."line4" AS "line4", "Address"."postcode" AS "postcode", "Address"."primary" AS "primary", "Address"."inactive" AS "inactive", "Address"."date_active" AS "date_active", "Address"."site_id" AS "site_id", "Address"."description" AS "description", "Address"."lat" AS "lat", "Address"."long" AS "long", "Address"."note" AS "note", "Application"."grant_type" AS "grant_type", "Application"."loginas_agent_id" AS "loginas_agent_id", "Application"."inactive" AS "inactive(Application)", "Application"."system_use" AS "system_use", "Application"."redirecturi" AS "redirecturi", "Application"."logoutredirecturi" AS "logoutredirecturi", "Application"."cors_whitelist" AS "cors_whitelist", "Application"."allowagents" AS "allowagents", "Application"."allowusers" AS "allowusers", "Application"."organisation_id" AS "organisation_id", "Application"."loginas_client_id" AS "loginas_client_id", "Application"."loginas_supplier_id" AS "loginas_supplier_id", "Application"."loginentity" AS "loginentity", "Application"."language_id" AS "language_id", "Application"."disable_windowsauth" AS "disable_windowsauth", "Application"."disable_azure" AS "disable_azure", "Application"."disable_adfs" AS "disable_adfs", "Application"."disable_okta" AS "disable_okta", "Application"."disable_centrify" AS "disable_centrify", "Application"."disable_google" AS "disable_google", "Application"."disable_anon" AS "disable_anon", "Application"."clientId" AS "clientId", "Application"."concurrencyToken" AS "concurrencyToken", "Application"."displayName" AS "displayName", "Application"."id" AS "id(Application)", "Application"."postLogoutRedirectUris" AS "postLogoutRedirectUris", "Application"."redirectUris" AS "redirectUris", "Application"."type" AS "type(Application)", "Application"."_issystem" AS "_issystem", "Currency"."id" AS "id(Currency)", "Currency"."name" AS "name(Currency)", "Currency"."symbol" AS "symbol", "Currency"."code" AS "code", "Currency"."conversion_rate" AS "conversion_rate", "Currency"."last_updated" AS "last_updated", "EmailTemplate"."id" AS "id(EmailTemplate)", "EmailTemplate"."guid" AS "guid", "EmailTemplate"."name" AS "name(EmailTemplate)", "EmailTemplate"."description" AS "description(EmailTemplate)", "EmailTemplate"."sectionid" AS "sectionid", "EmailTemplate"."header_text" AS "header_text", "EmailTemplate"."messagegroup_id" AS "messagegroup_id", "Team"."id" AS "id(Team)", "Team"."guid" AS "guid(Team)", "Team"."name" AS "name(Team)", "Team"."sequence" AS "sequence", "Team"."forrequests" AS "forrequests", "Team"."foropps" AS "foropps", "Team"."forprojects" AS "forprojects", "Team"."ticket_count" AS "ticket_count", "Team"."department_id" AS "department_id", "Team"."department_name" AS "department_name", "Team"."org_team_name" AS "org_team_name", "Team"."inactive" AS "inactive(Team)", "Team"."override_column_id" AS "override_column_id", "Team"."teamphotopath" AS "teamphotopath", "Team"."hide_agents_in_tree_if_no_tickets" AS "hide_agents_in_tree_if_no_tickets", "Team"."concurrent_lic_limit" AS "concurrent_lic_limit", "Team"."use" AS "use(Team)", "Team"."homescreendashboardid" AS "homescreendashboardid", "Tax"."id" AS "id(Tax)", "Tax"."name" AS "name(Tax)", "Tax"."code" AS "code(Tax)", "Tax"."value" AS "value", "Tax"."xero_tenant_id" AS "xero_tenant_id", "Tax"."xero_tenant_name" AS "xero_tenant_name", "Tax"."third_party_desc" AS "third_party_desc", "Tax"."is_composite" AS "is_composite", "Tax"."kashflow_tenant_id" AS "kashflow_tenant_id", "Tax"."kashflow_tenant_name" AS "kashflow_tenant_name", "Tax"."qbocode" AS "qbocode", "Tax"."qbocode_name" AS "qbocode_name", "Tax"."qbotaxcode.value" AS "qbotaxcode.value", "Tax"."qbotaxcode.label" AS "qbotaxcode.label", "Tax"."qbo_company_name" AS "qbo_company_name" FROM "halops_dash"."Agent" AS "Agent" INNER JOIN "halops_dash"."Address" AS "Address" ON "Agent"."id" = "Address"."id" INNER JOIN "halops_dash"."Application" AS "Application" ON "Address"."inactive" = "Application"."inactive" INNER JOIN "halops_dash"."Currency" AS "Currency" ON "Agent"."id" = "Currency"."id" INNER JOIN "halops_dash"."EmailTemplate" AS "EmailTemplate" ON "Agent"."id" = "EmailTemplate"."id" INNER JOIN "halops_dash"."Team" AS "Team" ON "Agent"."id" = "Team"."id" INNER JOIN "halops_dash"."Tax" AS "Tax" ON "Agent"."id" = "Tax"."id") temp_table GROUP BY "displayName", "displayName" ORDER BY "displayName" ASC NULLS FIRST
'''

shft_q4 = '''SELECT "name(Team)" AS "name(Team)", COUNT("id") AS "count(id)" FROM (SELECT "Agent"."id" AS "id", "Agent"."name" AS "name", "Agent"."team" AS "team", "Agent"."isdisabled" AS "isdisabled", "Agent"."ad" AS "ad", "Agent"."agentphotopath" AS "agentphotopath", "Agent"."initials" AS "initials", "Agent"."firstname" AS "firstname", "Agent"."surname" AS "surname", "Agent"."colour" AS "colour", "Agent"."jobtitle" AS "jobtitle", "Agent"."sms" AS "sms", "Agent"."extensionnumber" AS "extensionnumber", "Agent"."is_agent" AS "is_agent", "Agent"."googleemail" AS "googleemail", "Agent"."linemanager" AS "linemanager", "Agent"."exchange_authorized" AS "exchange_authorized", "Agent"."exchange_account" AS "exchange_account", "Agent"."sentinel_authorized" AS "sentinel_authorized", "Agent"."licence_type" AS "licence_type", "Agent"."splashtop_authorized" AS "splashtop_authorized", "Agent"."gotoresolve_authorized" AS "gotoresolve_authorized", "Agent"."use" AS "use", "Agent"."logmeinid" AS "logmeinid", "Agent"."allowbeyondtrustinvites" AS "allowbeyondtrustinvites", "Agent"."jira_id" AS "jira_id", "Agent"."namewithinactive" AS "namewithinactive", "Agent"."apptsync" AS "apptsync", "Agent"."sendemailerrors" AS "sendemailerrors", "Agent"."can_approve_purchaseorder" AS "can_approve_purchaseorder", "Agent"."can_approve_quote" AS "can_approve_quote", "Agent"."can_approve_invoice" AS "can_approve_invoice", "Agent"."workday_id" AS "workday_id", "Agent"."costprice" AS "costprice", "Agent"."chargerate" AS "chargerate", "Agent"."email" AS "email", "Agent"."teams[0].id" AS "teams[0].id", "Agent"."teams[0].agent_id" AS "teams[0].agent_id", "Agent"."teams[0].team_id" AS "teams[0].team_id", "Agent"."teams[0].team_name" AS "teams[0].team_name", "Agent"."teams[0].department_id" AS "teams[0].department_id", "Agent"."teams[0].role_id" AS "teams[0].role_id", "Agent"."teams[0].is_manager" AS "teams[0].is_manager", "Agent"."teams[0].no_config_access" AS "teams[0].no_config_access", "Agent"."teams[0].unassigned_access" AS "teams[0].unassigned_access", "Agent"."teams[0].otheragent_access" AS "teams[0].otheragent_access", "Agent"."teams[0].fortickets" AS "teams[0].fortickets", "Agent"."teams[0].foropps" AS "teams[0].foropps", "Agent"."teams[0].forprojects" AS "teams[0].forprojects", "Agent"."teams[0].in_section" AS "teams[0].in_section", "Agent"."departments[0].id" AS "departments[0].id", "Agent"."departments[0].agent_id" AS "departments[0].agent_id", "Agent"."departments[0].department_id" AS "departments[0].department_id", "Agent"."departments[0].role_id" AS "departments[0].role_id", "Agent"."departments[0].membershiplevel" AS "departments[0].membershiplevel", "Agent"."departments[0].includeteamsintree" AS "departments[0].includeteamsintree", "Agent"."departments[1].id" AS "departments[1].id", "Agent"."departments[1].agent_id" AS "departments[1].agent_id", "Agent"."departments[1].department_id" AS "departments[1].department_id", "Agent"."departments[1].role_id" AS "departments[1].role_id", "Agent"."departments[1].membershiplevel" AS "departments[1].membershiplevel", "Agent"."departments[1].includeteamsintree" AS "departments[1].includeteamsintree", "Agent"."departments[2].id" AS "departments[2].id", "Agent"."departments[2].agent_id" AS "departments[2].agent_id", "Agent"."departments[2].department_id" AS "departments[2].department_id", "Agent"."departments[2].role_id" AS "departments[2].role_id", "Agent"."departments[2].membershiplevel" AS "departments[2].membershiplevel", "Agent"."departments[2].includeteamsintree" AS "departments[2].includeteamsintree", "Agent"."teams[1].id" AS "teams[1].id", "Agent"."teams[1].agent_id" AS "teams[1].agent_id", "Agent"."teams[1].team_id" AS "teams[1].team_id", "Agent"."teams[1].team_name" AS "teams[1].team_name", "Agent"."teams[1].department_id" AS "teams[1].department_id", "Agent"."teams[1].is_manager" AS "teams[1].is_manager", "Agent"."teams[1].no_config_access" AS "teams[1].no_config_access", "Agent"."teams[1].unassigned_access" AS "teams[1].unassigned_access", "Agent"."teams[1].otheragent_access" AS "teams[1].otheragent_access", "Agent"."teams[1].fortickets" AS "teams[1].fortickets", "Agent"."teams[1].foropps" AS "teams[1].foropps", "Agent"."teams[1].forprojects" AS "teams[1].forprojects", "Agent"."teams[1].in_section" AS "teams[1].in_section", "Agent"."teams[2].id" AS "teams[2].id", "Agent"."teams[2].agent_id" AS "teams[2].agent_id", "Agent"."teams[2].team_id" AS "teams[2].team_id", "Agent"."teams[2].team_name" AS "teams[2].team_name", "Agent"."teams[2].department_id" AS "teams[2].department_id", "Agent"."teams[2].role_id" AS "teams[2].role_id", "Agent"."teams[2].is_manager" AS "teams[2].is_manager", "Agent"."teams[2].no_config_access" AS "teams[2].no_config_access", "Agent"."teams[2].unassigned_access" AS "teams[2].unassigned_access", "Agent"."teams[2].otheragent_access" AS "teams[2].otheragent_access", "Agent"."teams[2].fortickets" AS "teams[2].fortickets", "Agent"."teams[2].foropps" AS "teams[2].foropps", "Agent"."teams[2].forprojects" AS "teams[2].forprojects", "Agent"."teams[2].in_section" AS "teams[2].in_section", "Agent"."teams[3].id" AS "teams[3].id", "Agent"."teams[3].agent_id" AS "teams[3].agent_id", "Agent"."teams[3].team_id" AS "teams[3].team_id", "Agent"."teams[3].team_name" AS "teams[3].team_name", "Agent"."teams[3].department_id" AS "teams[3].department_id", "Agent"."teams[3].role_id" AS "teams[3].role_id", "Agent"."teams[3].is_manager" AS "teams[3].is_manager", "Agent"."teams[3].no_config_access" AS "teams[3].no_config_access", "Agent"."teams[3].unassigned_access" AS "teams[3].unassigned_access", "Agent"."teams[3].otheragent_access" AS "teams[3].otheragent_access", "Agent"."teams[3].fortickets" AS "teams[3].fortickets", "Agent"."teams[3].foropps" AS "teams[3].foropps", "Agent"."teams[3].forprojects" AS "teams[3].forprojects", "Agent"."teams[3].in_section" AS "teams[3].in_section", "Agent"."teams[4].id" AS "teams[4].id", "Agent"."teams[4].agent_id" AS "teams[4].agent_id", "Agent"."teams[4].team_id" AS "teams[4].team_id", "Agent"."teams[4].team_name" AS "teams[4].team_name", "Agent"."teams[4].department_id" AS "teams[4].department_id", "Agent"."teams[4].role_id" AS "teams[4].role_id", "Agent"."teams[4].is_manager" AS "teams[4].is_manager", "Agent"."teams[4].no_config_access" AS "teams[4].no_config_access", "Agent"."teams[4].unassigned_access" AS "teams[4].unassigned_access", "Agent"."teams[4].otheragent_access" AS "teams[4].otheragent_access", "Agent"."teams[4].fortickets" AS "teams[4].fortickets", "Agent"."teams[4].foropps" AS "teams[4].foropps", "Agent"."teams[4].forprojects" AS "teams[4].forprojects", "Agent"."teams[4].in_section" AS "teams[4].in_section", "Agent"."departments[3].id" AS "departments[3].id", "Agent"."departments[3].agent_id" AS "departments[3].agent_id", "Agent"."departments[3].department_id" AS "departments[3].department_id", "Agent"."departments[3].role_id" AS "departments[3].role_id", "Agent"."departments[3].membershiplevel" AS "departments[3].membershiplevel", "Agent"."departments[3].includeteamsintree" AS "departments[3].includeteamsintree", "Agent"."departments[4].id" AS "departments[4].id", "Agent"."departments[4].agent_id" AS "departments[4].agent_id", "Agent"."departments[4].department_id" AS "departments[4].department_id", "Agent"."departments[4].role_id" AS "departments[4].role_id", "Agent"."departments[4].membershiplevel" AS "departments[4].membershiplevel", "Agent"."departments[4].includeteamsintree" AS "departments[4].includeteamsintree", "Agent"."departments[5].id" AS "departments[5].id", "Agent"."departments[5].agent_id" AS "departments[5].agent_id", "Agent"."departments[5].department_id" AS "departments[5].department_id", "Agent"."departments[5].role_id" AS "departments[5].role_id", "Agent"."departments[5].membershiplevel" AS "departments[5].membershiplevel", "Agent"."departments[5].includeteamsintree" AS "departments[5].includeteamsintree", "Agent"."teams[1].role_id" AS "teams[1].role_id", "Agent"."lastlogindate" AS "lastlogindate", "Agent"."teams[5].id" AS "teams[5].id", "Agent"."teams[5].agent_id" AS "teams[5].agent_id", "Agent"."teams[5].team_id" AS "teams[5].team_id", "Agent"."teams[5].team_name" AS "teams[5].team_name", "Agent"."teams[5].department_id" AS "teams[5].department_id", "Agent"."teams[5].is_manager" AS "teams[5].is_manager", "Agent"."teams[5].no_config_access" AS "teams[5].no_config_access", "Agent"."teams[5].unassigned_access" AS "teams[5].unassigned_access", "Agent"."teams[5].otheragent_access" AS "teams[5].otheragent_access", "Agent"."teams[5].fortickets" AS "teams[5].fortickets", "Agent"."teams[5].foropps" AS "teams[5].foropps", "Agent"."teams[5].forprojects" AS "teams[5].forprojects", "Agent"."teams[5].in_section" AS "teams[5].in_section", "Agent"."teams[6].id" AS "teams[6].id", "Agent"."teams[6].agent_id" AS "teams[6].agent_id", "Agent"."teams[6].team_id" AS "teams[6].team_id", "Agent"."teams[6].team_name" AS "teams[6].team_name", "Agent"."teams[6].department_id" AS "teams[6].department_id", "Agent"."teams[6].role_id" AS "teams[6].role_id", "Agent"."teams[6].is_manager" AS "teams[6].is_manager", "Agent"."teams[6].no_config_access" AS "teams[6].no_config_access", "Agent"."teams[6].unassigned_access" AS "teams[6].unassigned_access", "Agent"."teams[6].otheragent_access" AS "teams[6].otheragent_access", "Agent"."teams[6].fortickets" AS "teams[6].fortickets", "Agent"."teams[6].foropps" AS "teams[6].foropps", "Agent"."teams[6].forprojects" AS "teams[6].forprojects", "Agent"."teams[6].in_section" AS "teams[6].in_section", "Agent"."teams[7].id" AS "teams[7].id", "Agent"."teams[7].agent_id" AS "teams[7].agent_id", "Agent"."teams[7].team_id" AS "teams[7].team_id", "Agent"."teams[7].team_name" AS "teams[7].team_name", "Agent"."teams[7].department_id" AS "teams[7].department_id", "Agent"."teams[7].role_id" AS "teams[7].role_id", "Agent"."teams[7].is_manager" AS "teams[7].is_manager", "Agent"."teams[7].no_config_access" AS "teams[7].no_config_access", "Agent"."teams[7].unassigned_access" AS "teams[7].unassigned_access", "Agent"."teams[7].otheragent_access" AS "teams[7].otheragent_access", "Agent"."teams[7].fortickets" AS "teams[7].fortickets", "Agent"."teams[7].foropps" AS "teams[7].foropps", "Agent"."teams[7].forprojects" AS "teams[7].forprojects", "Agent"."teams[7].in_section" AS "teams[7].in_section", "Agent"."departments[6].id" AS "departments[6].id", "Agent"."departments[6].agent_id" AS "departments[6].agent_id", "Agent"."departments[6].department_id" AS "departments[6].department_id", "Agent"."departments[6].role_id" AS "departments[6].role_id", "Agent"."departments[6].membershiplevel" AS "departments[6].membershiplevel", "Agent"."departments[6].includeteamsintree" AS "departments[6].includeteamsintree", "Agent"."departments[7].id" AS "departments[7].id", "Agent"."departments[7].agent_id" AS "departments[7].agent_id", "Agent"."departments[7].department_id" AS "departments[7].department_id", "Agent"."departments[7].role_id" AS "departments[7].role_id", "Agent"."departments[7].membershiplevel" AS "departments[7].membershiplevel", "Agent"."departments[7].includeteamsintree" AS "departments[7].includeteamsintree", "Agent"."departments[8].id" AS "departments[8].id", "Agent"."departments[8].agent_id" AS "departments[8].agent_id", "Agent"."departments[8].department_id" AS "departments[8].department_id", "Agent"."departments[8].role_id" AS "departments[8].role_id", "Agent"."departments[8].membershiplevel" AS "departments[8].membershiplevel", "Agent"."departments[8].includeteamsintree" AS "departments[8].includeteamsintree", "Agent"."departments[9].id" AS "departments[9].id", "Agent"."departments[9].agent_id" AS "departments[9].agent_id", "Agent"."departments[9].department_id" AS "departments[9].department_id", "Agent"."departments[9].role_id" AS "departments[9].role_id", "Agent"."departments[9].membershiplevel" AS "departments[9].membershiplevel", "Agent"."departments[9].includeteamsintree" AS "departments[9].includeteamsintree", "Agent"."departments[10].id" AS "departments[10].id", "Agent"."departments[10].agent_id" AS "departments[10].agent_id", "Agent"."departments[10].department_id" AS "departments[10].department_id", "Agent"."departments[10].role_id" AS "departments[10].role_id", "Agent"."departments[10].membershiplevel" AS "departments[10].membershiplevel", "Agent"."departments[10].includeteamsintree" AS "departments[10].includeteamsintree", "Agent"."departments[11].id" AS "departments[11].id", "Agent"."departments[11].agent_id" AS "departments[11].agent_id", "Agent"."departments[11].department_id" AS "departments[11].department_id", "Agent"."departments[11].role_id" AS "departments[11].role_id", "Agent"."departments[11].membershiplevel" AS "departments[11].membershiplevel", "Agent"."departments[11].includeteamsintree" AS "departments[11].includeteamsintree", "Address"."id" AS "id(Address)", "Address"."type" AS "type", "Address"."line1" AS "line1", "Address"."line2" AS "line2", "Address"."line3" AS "line3", "Address"."line4" AS "line4", "Address"."postcode" AS "postcode", "Address"."primary" AS "primary", "Address"."inactive" AS "inactive", "Address"."date_active" AS "date_active", "Address"."site_id" AS "site_id", "Address"."description" AS "description", "Address"."lat" AS "lat", "Address"."long" AS "long", "Address"."note" AS "note", "Application"."grant_type" AS "grant_type", "Application"."loginas_agent_id" AS "loginas_agent_id", "Application"."inactive" AS "inactive(Application)", "Application"."system_use" AS "system_use", "Application"."redirecturi" AS "redirecturi", "Application"."logoutredirecturi" AS "logoutredirecturi", "Application"."cors_whitelist" AS "cors_whitelist", "Application"."allowagents" AS "allowagents", "Application"."allowusers" AS "allowusers", "Application"."organisation_id" AS "organisation_id", "Application"."loginas_client_id" AS "loginas_client_id", "Application"."loginas_supplier_id" AS "loginas_supplier_id", "Application"."loginentity" AS "loginentity", "Application"."language_id" AS "language_id", "Application"."disable_windowsauth" AS "disable_windowsauth", "Application"."disable_azure" AS "disable_azure", "Application"."disable_adfs" AS "disable_adfs", "Application"."disable_okta" AS "disable_okta", "Application"."disable_centrify" AS "disable_centrify", "Application"."disable_google" AS "disable_google", "Application"."disable_anon" AS "disable_anon", "Application"."clientId" AS "clientId", "Application"."concurrencyToken" AS "concurrencyToken", "Application"."displayName" AS "displayName", "Application"."id" AS "id(Application)", "Application"."postLogoutRedirectUris" AS "postLogoutRedirectUris", "Application"."redirectUris" AS "redirectUris", "Application"."type" AS "type(Application)", "Application"."_issystem" AS "_issystem", "Currency"."id" AS "id(Currency)", "Currency"."name" AS "name(Currency)", "Currency"."symbol" AS "symbol", "Currency"."code" AS "code", "Currency"."conversion_rate" AS "conversion_rate", "Currency"."last_updated" AS "last_updated", "EmailTemplate"."id" AS "id(EmailTemplate)", "EmailTemplate"."guid" AS "guid", "EmailTemplate"."name" AS "name(EmailTemplate)", "EmailTemplate"."description" AS "description(EmailTemplate)", "EmailTemplate"."sectionid" AS "sectionid", "EmailTemplate"."header_text" AS "header_text", "EmailTemplate"."messagegroup_id" AS "messagegroup_id", "Team"."id" AS "id(Team)", "Team"."guid" AS "guid(Team)", "Team"."name" AS "name(Team)", "Team"."sequence" AS "sequence", "Team"."forrequests" AS "forrequests", "Team"."foropps" AS "foropps", "Team"."forprojects" AS "forprojects", "Team"."ticket_count" AS "ticket_count", "Team"."department_id" AS "department_id", "Team"."department_name" AS "department_name", "Team"."org_team_name" AS "org_team_name", "Team"."inactive" AS "inactive(Team)", "Team"."override_column_id" AS "override_column_id", "Team"."teamphotopath" AS "teamphotopath", "Team"."hide_agents_in_tree_if_no_tickets" AS "hide_agents_in_tree_if_no_tickets", "Team"."concurrent_lic_limit" AS "concurrent_lic_limit", "Team"."use" AS "use(Team)", "Team"."homescreendashboardid" AS "homescreendashboardid", "Tax"."id" AS "id(Tax)", "Tax"."name" AS "name(Tax)", "Tax"."code" AS "code(Tax)", "Tax"."value" AS "value", "Tax"."xero_tenant_id" AS "xero_tenant_id", "Tax"."xero_tenant_name" AS "xero_tenant_name", "Tax"."third_party_desc" AS "third_party_desc", "Tax"."is_composite" AS "is_composite", "Tax"."kashflow_tenant_id" AS "kashflow_tenant_id", "Tax"."kashflow_tenant_name" AS "kashflow_tenant_name", "Tax"."qbocode" AS "qbocode", "Tax"."qbocode_name" AS "qbocode_name", "Tax"."qbotaxcode.value" AS "qbotaxcode.value", "Tax"."qbotaxcode.label" AS "qbotaxcode.label", "Tax"."qbo_company_name" AS "qbo_company_name" FROM "halops_dash"."Agent" AS "Agent" INNER JOIN "halops_dash"."Address" AS "Address" ON "Agent"."id" = "Address"."id" INNER JOIN "halops_dash"."Application" AS "Application" ON "Address"."inactive" = "Application"."inactive" INNER JOIN "halops_dash"."Currency" AS "Currency" ON "Agent"."id" = "Currency"."id" INNER JOIN "halops_dash"."EmailTemplate" AS "EmailTemplate" ON "Agent"."id" = "EmailTemplate"."id" INNER JOIN "halops_dash"."Team" AS "Team" ON "Agent"."id" = "Team"."id" INNER JOIN "halops_dash"."Tax" AS "Tax" ON "Agent"."id" = "Tax"."id") temp_table GROUP BY "name(Team)", "name(Team)" ORDER BY "name(Team)" ASC NULLS FIRST
'''

shft_q5 = '''SELECT "department_name" AS "department_name", COUNT(DISTINCT "id(Team)") AS "CNTD(id(Team))" FROM (SELECT "Agent"."id" AS "id", "Agent"."name" AS "name", "Agent"."team" AS "team", "Agent"."isdisabled" AS "isdisabled", "Agent"."ad" AS "ad", "Agent"."agentphotopath" AS "agentphotopath", "Agent"."initials" AS "initials", "Agent"."firstname" AS "firstname", "Agent"."surname" AS "surname", "Agent"."colour" AS "colour", "Agent"."jobtitle" AS "jobtitle", "Agent"."sms" AS "sms", "Agent"."extensionnumber" AS "extensionnumber", "Agent"."is_agent" AS "is_agent", "Agent"."googleemail" AS "googleemail", "Agent"."linemanager" AS "linemanager", "Agent"."exchange_authorized" AS "exchange_authorized", "Agent"."exchange_account" AS "exchange_account", "Agent"."sentinel_authorized" AS "sentinel_authorized", "Agent"."licence_type" AS "licence_type", "Agent"."splashtop_authorized" AS "splashtop_authorized", "Agent"."gotoresolve_authorized" AS "gotoresolve_authorized", "Agent"."use" AS "use", "Agent"."logmeinid" AS "logmeinid", "Agent"."allowbeyondtrustinvites" AS "allowbeyondtrustinvites", "Agent"."jira_id" AS "jira_id", "Agent"."namewithinactive" AS "namewithinactive", "Agent"."apptsync" AS "apptsync", "Agent"."sendemailerrors" AS "sendemailerrors", "Agent"."can_approve_purchaseorder" AS "can_approve_purchaseorder", "Agent"."can_approve_quote" AS "can_approve_quote", "Agent"."can_approve_invoice" AS "can_approve_invoice", "Agent"."workday_id" AS "workday_id", "Agent"."costprice" AS "costprice", "Agent"."chargerate" AS "chargerate", "Agent"."email" AS "email", "Agent"."teams[0].id" AS "teams[0].id", "Agent"."teams[0].agent_id" AS "teams[0].agent_id", "Agent"."teams[0].team_id" AS "teams[0].team_id", "Agent"."teams[0].team_name" AS "teams[0].team_name", "Agent"."teams[0].department_id" AS "teams[0].department_id", "Agent"."teams[0].role_id" AS "teams[0].role_id", "Agent"."teams[0].is_manager" AS "teams[0].is_manager", "Agent"."teams[0].no_config_access" AS "teams[0].no_config_access", "Agent"."teams[0].unassigned_access" AS "teams[0].unassigned_access", "Agent"."teams[0].otheragent_access" AS "teams[0].otheragent_access", "Agent"."teams[0].fortickets" AS "teams[0].fortickets", "Agent"."teams[0].foropps" AS "teams[0].foropps", "Agent"."teams[0].forprojects" AS "teams[0].forprojects", "Agent"."teams[0].in_section" AS "teams[0].in_section", "Agent"."departments[0].id" AS "departments[0].id", "Agent"."departments[0].agent_id" AS "departments[0].agent_id", "Agent"."departments[0].department_id" AS "departments[0].department_id", "Agent"."departments[0].role_id" AS "departments[0].role_id", "Agent"."departments[0].membershiplevel" AS "departments[0].membershiplevel", "Agent"."departments[0].includeteamsintree" AS "departments[0].includeteamsintree", "Agent"."departments[1].id" AS "departments[1].id", "Agent"."departments[1].agent_id" AS "departments[1].agent_id", "Agent"."departments[1].department_id" AS "departments[1].department_id", "Agent"."departments[1].role_id" AS "departments[1].role_id", "Agent"."departments[1].membershiplevel" AS "departments[1].membershiplevel", "Agent"."departments[1].includeteamsintree" AS "departments[1].includeteamsintree", "Agent"."departments[2].id" AS "departments[2].id", "Agent"."departments[2].agent_id" AS "departments[2].agent_id", "Agent"."departments[2].department_id" AS "departments[2].department_id", "Agent"."departments[2].role_id" AS "departments[2].role_id", "Agent"."departments[2].membershiplevel" AS "departments[2].membershiplevel", "Agent"."departments[2].includeteamsintree" AS "departments[2].includeteamsintree", "Agent"."teams[1].id" AS "teams[1].id", "Agent"."teams[1].agent_id" AS "teams[1].agent_id", "Agent"."teams[1].team_id" AS "teams[1].team_id", "Agent"."teams[1].team_name" AS "teams[1].team_name", "Agent"."teams[1].department_id" AS "teams[1].department_id", "Agent"."teams[1].is_manager" AS "teams[1].is_manager", "Agent"."teams[1].no_config_access" AS "teams[1].no_config_access", "Agent"."teams[1].unassigned_access" AS "teams[1].unassigned_access", "Agent"."teams[1].otheragent_access" AS "teams[1].otheragent_access", "Agent"."teams[1].fortickets" AS "teams[1].fortickets", "Agent"."teams[1].foropps" AS "teams[1].foropps", "Agent"."teams[1].forprojects" AS "teams[1].forprojects", "Agent"."teams[1].in_section" AS "teams[1].in_section", "Agent"."teams[2].id" AS "teams[2].id", "Agent"."teams[2].agent_id" AS "teams[2].agent_id", "Agent"."teams[2].team_id" AS "teams[2].team_id", "Agent"."teams[2].team_name" AS "teams[2].team_name", "Agent"."teams[2].department_id" AS "teams[2].department_id", "Agent"."teams[2].role_id" AS "teams[2].role_id", "Agent"."teams[2].is_manager" AS "teams[2].is_manager", "Agent"."teams[2].no_config_access" AS "teams[2].no_config_access", "Agent"."teams[2].unassigned_access" AS "teams[2].unassigned_access", "Agent"."teams[2].otheragent_access" AS "teams[2].otheragent_access", "Agent"."teams[2].fortickets" AS "teams[2].fortickets", "Agent"."teams[2].foropps" AS "teams[2].foropps", "Agent"."teams[2].forprojects" AS "teams[2].forprojects", "Agent"."teams[2].in_section" AS "teams[2].in_section", "Agent"."teams[3].id" AS "teams[3].id", "Agent"."teams[3].agent_id" AS "teams[3].agent_id", "Agent"."teams[3].team_id" AS "teams[3].team_id", "Agent"."teams[3].team_name" AS "teams[3].team_name", "Agent"."teams[3].department_id" AS "teams[3].department_id", "Agent"."teams[3].role_id" AS "teams[3].role_id", "Agent"."teams[3].is_manager" AS "teams[3].is_manager", "Agent"."teams[3].no_config_access" AS "teams[3].no_config_access", "Agent"."teams[3].unassigned_access" AS "teams[3].unassigned_access", "Agent"."teams[3].otheragent_access" AS "teams[3].otheragent_access", "Agent"."teams[3].fortickets" AS "teams[3].fortickets", "Agent"."teams[3].foropps" AS "teams[3].foropps", "Agent"."teams[3].forprojects" AS "teams[3].forprojects", "Agent"."teams[3].in_section" AS "teams[3].in_section", "Agent"."teams[4].id" AS "teams[4].id", "Agent"."teams[4].agent_id" AS "teams[4].agent_id", "Agent"."teams[4].team_id" AS "teams[4].team_id", "Agent"."teams[4].team_name" AS "teams[4].team_name", "Agent"."teams[4].department_id" AS "teams[4].department_id", "Agent"."teams[4].role_id" AS "teams[4].role_id", "Agent"."teams[4].is_manager" AS "teams[4].is_manager", "Agent"."teams[4].no_config_access" AS "teams[4].no_config_access", "Agent"."teams[4].unassigned_access" AS "teams[4].unassigned_access", "Agent"."teams[4].otheragent_access" AS "teams[4].otheragent_access", "Agent"."teams[4].fortickets" AS "teams[4].fortickets", "Agent"."teams[4].foropps" AS "teams[4].foropps", "Agent"."teams[4].forprojects" AS "teams[4].forprojects", "Agent"."teams[4].in_section" AS "teams[4].in_section", "Agent"."departments[3].id" AS "departments[3].id", "Agent"."departments[3].agent_id" AS "departments[3].agent_id", "Agent"."departments[3].department_id" AS "departments[3].department_id", "Agent"."departments[3].role_id" AS "departments[3].role_id", "Agent"."departments[3].membershiplevel" AS "departments[3].membershiplevel", "Agent"."departments[3].includeteamsintree" AS "departments[3].includeteamsintree", "Agent"."departments[4].id" AS "departments[4].id", "Agent"."departments[4].agent_id" AS "departments[4].agent_id", "Agent"."departments[4].department_id" AS "departments[4].department_id", "Agent"."departments[4].role_id" AS "departments[4].role_id", "Agent"."departments[4].membershiplevel" AS "departments[4].membershiplevel", "Agent"."departments[4].includeteamsintree" AS "departments[4].includeteamsintree", "Agent"."departments[5].id" AS "departments[5].id", "Agent"."departments[5].agent_id" AS "departments[5].agent_id", "Agent"."departments[5].department_id" AS "departments[5].department_id", "Agent"."departments[5].role_id" AS "departments[5].role_id", "Agent"."departments[5].membershiplevel" AS "departments[5].membershiplevel", "Agent"."departments[5].includeteamsintree" AS "departments[5].includeteamsintree", "Agent"."teams[1].role_id" AS "teams[1].role_id", "Agent"."lastlogindate" AS "lastlogindate", "Agent"."teams[5].id" AS "teams[5].id", "Agent"."teams[5].agent_id" AS "teams[5].agent_id", "Agent"."teams[5].team_id" AS "teams[5].team_id", "Agent"."teams[5].team_name" AS "teams[5].team_name", "Agent"."teams[5].department_id" AS "teams[5].department_id", "Agent"."teams[5].is_manager" AS "teams[5].is_manager", "Agent"."teams[5].no_config_access" AS "teams[5].no_config_access", "Agent"."teams[5].unassigned_access" AS "teams[5].unassigned_access", "Agent"."teams[5].otheragent_access" AS "teams[5].otheragent_access", "Agent"."teams[5].fortickets" AS "teams[5].fortickets", "Agent"."teams[5].foropps" AS "teams[5].foropps", "Agent"."teams[5].forprojects" AS "teams[5].forprojects", "Agent"."teams[5].in_section" AS "teams[5].in_section", "Agent"."teams[6].id" AS "teams[6].id", "Agent"."teams[6].agent_id" AS "teams[6].agent_id", "Agent"."teams[6].team_id" AS "teams[6].team_id", "Agent"."teams[6].team_name" AS "teams[6].team_name", "Agent"."teams[6].department_id" AS "teams[6].department_id", "Agent"."teams[6].role_id" AS "teams[6].role_id", "Agent"."teams[6].is_manager" AS "teams[6].is_manager", "Agent"."teams[6].no_config_access" AS "teams[6].no_config_access", "Agent"."teams[6].unassigned_access" AS "teams[6].unassigned_access", "Agent"."teams[6].otheragent_access" AS "teams[6].otheragent_access", "Agent"."teams[6].fortickets" AS "teams[6].fortickets", "Agent"."teams[6].foropps" AS "teams[6].foropps", "Agent"."teams[6].forprojects" AS "teams[6].forprojects", "Agent"."teams[6].in_section" AS "teams[6].in_section", "Agent"."teams[7].id" AS "teams[7].id", "Agent"."teams[7].agent_id" AS "teams[7].agent_id", "Agent"."teams[7].team_id" AS "teams[7].team_id", "Agent"."teams[7].team_name" AS "teams[7].team_name", "Agent"."teams[7].department_id" AS "teams[7].department_id", "Agent"."teams[7].role_id" AS "teams[7].role_id", "Agent"."teams[7].is_manager" AS "teams[7].is_manager", "Agent"."teams[7].no_config_access" AS "teams[7].no_config_access", "Agent"."teams[7].unassigned_access" AS "teams[7].unassigned_access", "Agent"."teams[7].otheragent_access" AS "teams[7].otheragent_access", "Agent"."teams[7].fortickets" AS "teams[7].fortickets", "Agent"."teams[7].foropps" AS "teams[7].foropps", "Agent"."teams[7].forprojects" AS "teams[7].forprojects", "Agent"."teams[7].in_section" AS "teams[7].in_section", "Agent"."departments[6].id" AS "departments[6].id", "Agent"."departments[6].agent_id" AS "departments[6].agent_id", "Agent"."departments[6].department_id" AS "departments[6].department_id", "Agent"."departments[6].role_id" AS "departments[6].role_id", "Agent"."departments[6].membershiplevel" AS "departments[6].membershiplevel", "Agent"."departments[6].includeteamsintree" AS "departments[6].includeteamsintree", "Agent"."departments[7].id" AS "departments[7].id", "Agent"."departments[7].agent_id" AS "departments[7].agent_id", "Agent"."departments[7].department_id" AS "departments[7].department_id", "Agent"."departments[7].role_id" AS "departments[7].role_id", "Agent"."departments[7].membershiplevel" AS "departments[7].membershiplevel", "Agent"."departments[7].includeteamsintree" AS "departments[7].includeteamsintree", "Agent"."departments[8].id" AS "departments[8].id", "Agent"."departments[8].agent_id" AS "departments[8].agent_id", "Agent"."departments[8].department_id" AS "departments[8].department_id", "Agent"."departments[8].role_id" AS "departments[8].role_id", "Agent"."departments[8].membershiplevel" AS "departments[8].membershiplevel", "Agent"."departments[8].includeteamsintree" AS "departments[8].includeteamsintree", "Agent"."departments[9].id" AS "departments[9].id", "Agent"."departments[9].agent_id" AS "departments[9].agent_id", "Agent"."departments[9].department_id" AS "departments[9].department_id", "Agent"."departments[9].role_id" AS "departments[9].role_id", "Agent"."departments[9].membershiplevel" AS "departments[9].membershiplevel", "Agent"."departments[9].includeteamsintree" AS "departments[9].includeteamsintree", "Agent"."departments[10].id" AS "departments[10].id", "Agent"."departments[10].agent_id" AS "departments[10].agent_id", "Agent"."departments[10].department_id" AS "departments[10].department_id", "Agent"."departments[10].role_id" AS "departments[10].role_id", "Agent"."departments[10].membershiplevel" AS "departments[10].membershiplevel", "Agent"."departments[10].includeteamsintree" AS "departments[10].includeteamsintree", "Agent"."departments[11].id" AS "departments[11].id", "Agent"."departments[11].agent_id" AS "departments[11].agent_id", "Agent"."departments[11].department_id" AS "departments[11].department_id", "Agent"."departments[11].role_id" AS "departments[11].role_id", "Agent"."departments[11].membershiplevel" AS "departments[11].membershiplevel", "Agent"."departments[11].includeteamsintree" AS "departments[11].includeteamsintree", "Address"."id" AS "id(Address)", "Address"."type" AS "type", "Address"."line1" AS "line1", "Address"."line2" AS "line2", "Address"."line3" AS "line3", "Address"."line4" AS "line4", "Address"."postcode" AS "postcode", "Address"."primary" AS "primary", "Address"."inactive" AS "inactive", "Address"."date_active" AS "date_active", "Address"."site_id" AS "site_id", "Address"."description" AS "description", "Address"."lat" AS "lat", "Address"."long" AS "long", "Address"."note" AS "note", "Application"."grant_type" AS "grant_type", "Application"."loginas_agent_id" AS "loginas_agent_id", "Application"."inactive" AS "inactive(Application)", "Application"."system_use" AS "system_use", "Application"."redirecturi" AS "redirecturi", "Application"."logoutredirecturi" AS "logoutredirecturi", "Application"."cors_whitelist" AS "cors_whitelist", "Application"."allowagents" AS "allowagents", "Application"."allowusers" AS "allowusers", "Application"."organisation_id" AS "organisation_id", "Application"."loginas_client_id" AS "loginas_client_id", "Application"."loginas_supplier_id" AS "loginas_supplier_id", "Application"."loginentity" AS "loginentity", "Application"."language_id" AS "language_id", "Application"."disable_windowsauth" AS "disable_windowsauth", "Application"."disable_azure" AS "disable_azure", "Application"."disable_adfs" AS "disable_adfs", "Application"."disable_okta" AS "disable_okta", "Application"."disable_centrify" AS "disable_centrify", "Application"."disable_google" AS "disable_google", "Application"."disable_anon" AS "disable_anon", "Application"."clientId" AS "clientId", "Application"."concurrencyToken" AS "concurrencyToken", "Application"."displayName" AS "displayName", "Application"."id" AS "id(Application)", "Application"."postLogoutRedirectUris" AS "postLogoutRedirectUris", "Application"."redirectUris" AS "redirectUris", "Application"."type" AS "type(Application)", "Application"."_issystem" AS "_issystem", "Currency"."id" AS "id(Currency)", "Currency"."name" AS "name(Currency)", "Currency"."symbol" AS "symbol", "Currency"."code" AS "code", "Currency"."conversion_rate" AS "conversion_rate", "Currency"."last_updated" AS "last_updated", "EmailTemplate"."id" AS "id(EmailTemplate)", "EmailTemplate"."guid" AS "guid", "EmailTemplate"."name" AS "name(EmailTemplate)", "EmailTemplate"."description" AS "description(EmailTemplate)", "EmailTemplate"."sectionid" AS "sectionid", "EmailTemplate"."header_text" AS "header_text", "EmailTemplate"."messagegroup_id" AS "messagegroup_id", "Team"."id" AS "id(Team)", "Team"."guid" AS "guid(Team)", "Team"."name" AS "name(Team)", "Team"."sequence" AS "sequence", "Team"."forrequests" AS "forrequests", "Team"."foropps" AS "foropps", "Team"."forprojects" AS "forprojects", "Team"."ticket_count" AS "ticket_count", "Team"."department_id" AS "department_id", "Team"."department_name" AS "department_name", "Team"."org_team_name" AS "org_team_name", "Team"."inactive" AS "inactive(Team)", "Team"."override_column_id" AS "override_column_id", "Team"."teamphotopath" AS "teamphotopath", "Team"."hide_agents_in_tree_if_no_tickets" AS "hide_agents_in_tree_if_no_tickets", "Team"."concurrent_lic_limit" AS "concurrent_lic_limit", "Team"."use" AS "use(Team)", "Team"."homescreendashboardid" AS "homescreendashboardid", "Tax"."id" AS "id(Tax)", "Tax"."name" AS "name(Tax)", "Tax"."code" AS "code(Tax)", "Tax"."value" AS "value", "Tax"."xero_tenant_id" AS "xero_tenant_id", "Tax"."xero_tenant_name" AS "xero_tenant_name", "Tax"."third_party_desc" AS "third_party_desc", "Tax"."is_composite" AS "is_composite", "Tax"."kashflow_tenant_id" AS "kashflow_tenant_id", "Tax"."kashflow_tenant_name" AS "kashflow_tenant_name", "Tax"."qbocode" AS "qbocode", "Tax"."qbocode_name" AS "qbocode_name", "Tax"."qbotaxcode.value" AS "qbotaxcode.value", "Tax"."qbotaxcode.label" AS "qbotaxcode.label", "Tax"."qbo_company_name" AS "qbo_company_name" FROM "halops_dash"."Agent" AS "Agent" INNER JOIN "halops_dash"."Address" AS "Address" ON "Agent"."id" = "Address"."id" INNER JOIN "halops_dash"."Application" AS "Application" ON "Address"."inactive" = "Application"."inactive" INNER JOIN "halops_dash"."Currency" AS "Currency" ON "Agent"."id" = "Currency"."id" INNER JOIN "halops_dash"."EmailTemplate" AS "EmailTemplate" ON "Agent"."id" = "EmailTemplate"."id" INNER JOIN "halops_dash"."Team" AS "Team" ON "Agent"."id" = "Team"."id" INNER JOIN "halops_dash"."Tax" AS "Tax" ON "Agent"."id" = "Tax"."id") temp_table GROUP BY "department_name", "department_name" ORDER BY "department_name" ASC NULLS FIRST
'''

shft_q6 = '''SELECT SUM("value") AS "sum(value)" FROM (SELECT "Agent"."id" AS "id", "Agent"."name" AS "name", "Agent"."team" AS "team", "Agent"."isdisabled" AS "isdisabled", "Agent"."ad" AS "ad", "Agent"."agentphotopath" AS "agentphotopath", "Agent"."initials" AS "initials", "Agent"."firstname" AS "firstname", "Agent"."surname" AS "surname", "Agent"."colour" AS "colour", "Agent"."jobtitle" AS "jobtitle", "Agent"."sms" AS "sms", "Agent"."extensionnumber" AS "extensionnumber", "Agent"."is_agent" AS "is_agent", "Agent"."googleemail" AS "googleemail", "Agent"."linemanager" AS "linemanager", "Agent"."exchange_authorized" AS "exchange_authorized", "Agent"."exchange_account" AS "exchange_account", "Agent"."sentinel_authorized" AS "sentinel_authorized", "Agent"."licence_type" AS "licence_type", "Agent"."splashtop_authorized" AS "splashtop_authorized", "Agent"."gotoresolve_authorized" AS "gotoresolve_authorized", "Agent"."use" AS "use", "Agent"."logmeinid" AS "logmeinid", "Agent"."allowbeyondtrustinvites" AS "allowbeyondtrustinvites", "Agent"."jira_id" AS "jira_id", "Agent"."namewithinactive" AS "namewithinactive", "Agent"."apptsync" AS "apptsync", "Agent"."sendemailerrors" AS "sendemailerrors", "Agent"."can_approve_purchaseorder" AS "can_approve_purchaseorder", "Agent"."can_approve_quote" AS "can_approve_quote", "Agent"."can_approve_invoice" AS "can_approve_invoice", "Agent"."workday_id" AS "workday_id", "Agent"."costprice" AS "costprice", "Agent"."chargerate" AS "chargerate", "Agent"."email" AS "email", "Agent"."teams[0].id" AS "teams[0].id", "Agent"."teams[0].agent_id" AS "teams[0].agent_id", "Agent"."teams[0].team_id" AS "teams[0].team_id", "Agent"."teams[0].team_name" AS "teams[0].team_name", "Agent"."teams[0].department_id" AS "teams[0].department_id", "Agent"."teams[0].role_id" AS "teams[0].role_id", "Agent"."teams[0].is_manager" AS "teams[0].is_manager", "Agent"."teams[0].no_config_access" AS "teams[0].no_config_access", "Agent"."teams[0].unassigned_access" AS "teams[0].unassigned_access", "Agent"."teams[0].otheragent_access" AS "teams[0].otheragent_access", "Agent"."teams[0].fortickets" AS "teams[0].fortickets", "Agent"."teams[0].foropps" AS "teams[0].foropps", "Agent"."teams[0].forprojects" AS "teams[0].forprojects", "Agent"."teams[0].in_section" AS "teams[0].in_section", "Agent"."departments[0].id" AS "departments[0].id", "Agent"."departments[0].agent_id" AS "departments[0].agent_id", "Agent"."departments[0].department_id" AS "departments[0].department_id", "Agent"."departments[0].role_id" AS "departments[0].role_id", "Agent"."departments[0].membershiplevel" AS "departments[0].membershiplevel", "Agent"."departments[0].includeteamsintree" AS "departments[0].includeteamsintree", "Agent"."departments[1].id" AS "departments[1].id", "Agent"."departments[1].agent_id" AS "departments[1].agent_id", "Agent"."departments[1].department_id" AS "departments[1].department_id", "Agent"."departments[1].role_id" AS "departments[1].role_id", "Agent"."departments[1].membershiplevel" AS "departments[1].membershiplevel", "Agent"."departments[1].includeteamsintree" AS "departments[1].includeteamsintree", "Agent"."departments[2].id" AS "departments[2].id", "Agent"."departments[2].agent_id" AS "departments[2].agent_id", "Agent"."departments[2].department_id" AS "departments[2].department_id", "Agent"."departments[2].role_id" AS "departments[2].role_id", "Agent"."departments[2].membershiplevel" AS "departments[2].membershiplevel", "Agent"."departments[2].includeteamsintree" AS "departments[2].includeteamsintree", "Agent"."teams[1].id" AS "teams[1].id", "Agent"."teams[1].agent_id" AS "teams[1].agent_id", "Agent"."teams[1].team_id" AS "teams[1].team_id", "Agent"."teams[1].team_name" AS "teams[1].team_name", "Agent"."teams[1].department_id" AS "teams[1].department_id", "Agent"."teams[1].is_manager" AS "teams[1].is_manager", "Agent"."teams[1].no_config_access" AS "teams[1].no_config_access", "Agent"."teams[1].unassigned_access" AS "teams[1].unassigned_access", "Agent"."teams[1].otheragent_access" AS "teams[1].otheragent_access", "Agent"."teams[1].fortickets" AS "teams[1].fortickets", "Agent"."teams[1].foropps" AS "teams[1].foropps", "Agent"."teams[1].forprojects" AS "teams[1].forprojects", "Agent"."teams[1].in_section" AS "teams[1].in_section", "Agent"."teams[2].id" AS "teams[2].id", "Agent"."teams[2].agent_id" AS "teams[2].agent_id", "Agent"."teams[2].team_id" AS "teams[2].team_id", "Agent"."teams[2].team_name" AS "teams[2].team_name", "Agent"."teams[2].department_id" AS "teams[2].department_id", "Agent"."teams[2].role_id" AS "teams[2].role_id", "Agent"."teams[2].is_manager" AS "teams[2].is_manager", "Agent"."teams[2].no_config_access" AS "teams[2].no_config_access", "Agent"."teams[2].unassigned_access" AS "teams[2].unassigned_access", "Agent"."teams[2].otheragent_access" AS "teams[2].otheragent_access", "Agent"."teams[2].fortickets" AS "teams[2].fortickets", "Agent"."teams[2].foropps" AS "teams[2].foropps", "Agent"."teams[2].forprojects" AS "teams[2].forprojects", "Agent"."teams[2].in_section" AS "teams[2].in_section", "Agent"."teams[3].id" AS "teams[3].id", "Agent"."teams[3].agent_id" AS "teams[3].agent_id", "Agent"."teams[3].team_id" AS "teams[3].team_id", "Agent"."teams[3].team_name" AS "teams[3].team_name", "Agent"."teams[3].department_id" AS "teams[3].department_id", "Agent"."teams[3].role_id" AS "teams[3].role_id", "Agent"."teams[3].is_manager" AS "teams[3].is_manager", "Agent"."teams[3].no_config_access" AS "teams[3].no_config_access", "Agent"."teams[3].unassigned_access" AS "teams[3].unassigned_access", "Agent"."teams[3].otheragent_access" AS "teams[3].otheragent_access", "Agent"."teams[3].fortickets" AS "teams[3].fortickets", "Agent"."teams[3].foropps" AS "teams[3].foropps", "Agent"."teams[3].forprojects" AS "teams[3].forprojects", "Agent"."teams[3].in_section" AS "teams[3].in_section", "Agent"."teams[4].id" AS "teams[4].id", "Agent"."teams[4].agent_id" AS "teams[4].agent_id", "Agent"."teams[4].team_id" AS "teams[4].team_id", "Agent"."teams[4].team_name" AS "teams[4].team_name", "Agent"."teams[4].department_id" AS "teams[4].department_id", "Agent"."teams[4].role_id" AS "teams[4].role_id", "Agent"."teams[4].is_manager" AS "teams[4].is_manager", "Agent"."teams[4].no_config_access" AS "teams[4].no_config_access", "Agent"."teams[4].unassigned_access" AS "teams[4].unassigned_access", "Agent"."teams[4].otheragent_access" AS "teams[4].otheragent_access", "Agent"."teams[4].fortickets" AS "teams[4].fortickets", "Agent"."teams[4].foropps" AS "teams[4].foropps", "Agent"."teams[4].forprojects" AS "teams[4].forprojects", "Agent"."teams[4].in_section" AS "teams[4].in_section", "Agent"."departments[3].id" AS "departments[3].id", "Agent"."departments[3].agent_id" AS "departments[3].agent_id", "Agent"."departments[3].department_id" AS "departments[3].department_id", "Agent"."departments[3].role_id" AS "departments[3].role_id", "Agent"."departments[3].membershiplevel" AS "departments[3].membershiplevel", "Agent"."departments[3].includeteamsintree" AS "departments[3].includeteamsintree", "Agent"."departments[4].id" AS "departments[4].id", "Agent"."departments[4].agent_id" AS "departments[4].agent_id", "Agent"."departments[4].department_id" AS "departments[4].department_id", "Agent"."departments[4].role_id" AS "departments[4].role_id", "Agent"."departments[4].membershiplevel" AS "departments[4].membershiplevel", "Agent"."departments[4].includeteamsintree" AS "departments[4].includeteamsintree", "Agent"."departments[5].id" AS "departments[5].id", "Agent"."departments[5].agent_id" AS "departments[5].agent_id", "Agent"."departments[5].department_id" AS "departments[5].department_id", "Agent"."departments[5].role_id" AS "departments[5].role_id", "Agent"."departments[5].membershiplevel" AS "departments[5].membershiplevel", "Agent"."departments[5].includeteamsintree" AS "departments[5].includeteamsintree", "Agent"."teams[1].role_id" AS "teams[1].role_id", "Agent"."lastlogindate" AS "lastlogindate", "Agent"."teams[5].id" AS "teams[5].id", "Agent"."teams[5].agent_id" AS "teams[5].agent_id", "Agent"."teams[5].team_id" AS "teams[5].team_id", "Agent"."teams[5].team_name" AS "teams[5].team_name", "Agent"."teams[5].department_id" AS "teams[5].department_id", "Agent"."teams[5].is_manager" AS "teams[5].is_manager", "Agent"."teams[5].no_config_access" AS "teams[5].no_config_access", "Agent"."teams[5].unassigned_access" AS "teams[5].unassigned_access", "Agent"."teams[5].otheragent_access" AS "teams[5].otheragent_access", "Agent"."teams[5].fortickets" AS "teams[5].fortickets", "Agent"."teams[5].foropps" AS "teams[5].foropps", "Agent"."teams[5].forprojects" AS "teams[5].forprojects", "Agent"."teams[5].in_section" AS "teams[5].in_section", "Agent"."teams[6].id" AS "teams[6].id", "Agent"."teams[6].agent_id" AS "teams[6].agent_id", "Agent"."teams[6].team_id" AS "teams[6].team_id", "Agent"."teams[6].team_name" AS "teams[6].team_name", "Agent"."teams[6].department_id" AS "teams[6].department_id", "Agent"."teams[6].role_id" AS "teams[6].role_id", "Agent"."teams[6].is_manager" AS "teams[6].is_manager", "Agent"."teams[6].no_config_access" AS "teams[6].no_config_access", "Agent"."teams[6].unassigned_access" AS "teams[6].unassigned_access", "Agent"."teams[6].otheragent_access" AS "teams[6].otheragent_access", "Agent"."teams[6].fortickets" AS "teams[6].fortickets", "Agent"."teams[6].foropps" AS "teams[6].foropps", "Agent"."teams[6].forprojects" AS "teams[6].forprojects", "Agent"."teams[6].in_section" AS "teams[6].in_section", "Agent"."teams[7].id" AS "teams[7].id", "Agent"."teams[7].agent_id" AS "teams[7].agent_id", "Agent"."teams[7].team_id" AS "teams[7].team_id", "Agent"."teams[7].team_name" AS "teams[7].team_name", "Agent"."teams[7].department_id" AS "teams[7].department_id", "Agent"."teams[7].role_id" AS "teams[7].role_id", "Agent"."teams[7].is_manager" AS "teams[7].is_manager", "Agent"."teams[7].no_config_access" AS "teams[7].no_config_access", "Agent"."teams[7].unassigned_access" AS "teams[7].unassigned_access", "Agent"."teams[7].otheragent_access" AS "teams[7].otheragent_access", "Agent"."teams[7].fortickets" AS "teams[7].fortickets", "Agent"."teams[7].foropps" AS "teams[7].foropps", "Agent"."teams[7].forprojects" AS "teams[7].forprojects", "Agent"."teams[7].in_section" AS "teams[7].in_section", "Agent"."departments[6].id" AS "departments[6].id", "Agent"."departments[6].agent_id" AS "departments[6].agent_id", "Agent"."departments[6].department_id" AS "departments[6].department_id", "Agent"."departments[6].role_id" AS "departments[6].role_id", "Agent"."departments[6].membershiplevel" AS "departments[6].membershiplevel", "Agent"."departments[6].includeteamsintree" AS "departments[6].includeteamsintree", "Agent"."departments[7].id" AS "departments[7].id", "Agent"."departments[7].agent_id" AS "departments[7].agent_id", "Agent"."departments[7].department_id" AS "departments[7].department_id", "Agent"."departments[7].role_id" AS "departments[7].role_id", "Agent"."departments[7].membershiplevel" AS "departments[7].membershiplevel", "Agent"."departments[7].includeteamsintree" AS "departments[7].includeteamsintree", "Agent"."departments[8].id" AS "departments[8].id", "Agent"."departments[8].agent_id" AS "departments[8].agent_id", "Agent"."departments[8].department_id" AS "departments[8].department_id", "Agent"."departments[8].role_id" AS "departments[8].role_id", "Agent"."departments[8].membershiplevel" AS "departments[8].membershiplevel", "Agent"."departments[8].includeteamsintree" AS "departments[8].includeteamsintree", "Agent"."departments[9].id" AS "departments[9].id", "Agent"."departments[9].agent_id" AS "departments[9].agent_id", "Agent"."departments[9].department_id" AS "departments[9].department_id", "Agent"."departments[9].role_id" AS "departments[9].role_id", "Agent"."departments[9].membershiplevel" AS "departments[9].membershiplevel", "Agent"."departments[9].includeteamsintree" AS "departments[9].includeteamsintree", "Agent"."departments[10].id" AS "departments[10].id", "Agent"."departments[10].agent_id" AS "departments[10].agent_id", "Agent"."departments[10].department_id" AS "departments[10].department_id", "Agent"."departments[10].role_id" AS "departments[10].role_id", "Agent"."departments[10].membershiplevel" AS "departments[10].membershiplevel", "Agent"."departments[10].includeteamsintree" AS "departments[10].includeteamsintree", "Agent"."departments[11].id" AS "departments[11].id", "Agent"."departments[11].agent_id" AS "departments[11].agent_id", "Agent"."departments[11].department_id" AS "departments[11].department_id", "Agent"."departments[11].role_id" AS "departments[11].role_id", "Agent"."departments[11].membershiplevel" AS "departments[11].membershiplevel", "Agent"."departments[11].includeteamsintree" AS "departments[11].includeteamsintree", "Address"."id" AS "id(Address)", "Address"."type" AS "type", "Address"."line1" AS "line1", "Address"."line2" AS "line2", "Address"."line3" AS "line3", "Address"."line4" AS "line4", "Address"."postcode" AS "postcode", "Address"."primary" AS "primary", "Address"."inactive" AS "inactive", "Address"."date_active" AS "date_active", "Address"."site_id" AS "site_id", "Address"."description" AS "description", "Address"."lat" AS "lat", "Address"."long" AS "long", "Address"."note" AS "note", "Application"."grant_type" AS "grant_type", "Application"."loginas_agent_id" AS "loginas_agent_id", "Application"."inactive" AS "inactive(Application)", "Application"."system_use" AS "system_use", "Application"."redirecturi" AS "redirecturi", "Application"."logoutredirecturi" AS "logoutredirecturi", "Application"."cors_whitelist" AS "cors_whitelist", "Application"."allowagents" AS "allowagents", "Application"."allowusers" AS "allowusers", "Application"."organisation_id" AS "organisation_id", "Application"."loginas_client_id" AS "loginas_client_id", "Application"."loginas_supplier_id" AS "loginas_supplier_id", "Application"."loginentity" AS "loginentity", "Application"."language_id" AS "language_id", "Application"."disable_windowsauth" AS "disable_windowsauth", "Application"."disable_azure" AS "disable_azure", "Application"."disable_adfs" AS "disable_adfs", "Application"."disable_okta" AS "disable_okta", "Application"."disable_centrify" AS "disable_centrify", "Application"."disable_google" AS "disable_google", "Application"."disable_anon" AS "disable_anon", "Application"."clientId" AS "clientId", "Application"."concurrencyToken" AS "concurrencyToken", "Application"."displayName" AS "displayName", "Application"."id" AS "id(Application)", "Application"."postLogoutRedirectUris" AS "postLogoutRedirectUris", "Application"."redirectUris" AS "redirectUris", "Application"."type" AS "type(Application)", "Application"."_issystem" AS "_issystem", "Currency"."id" AS "id(Currency)", "Currency"."name" AS "name(Currency)", "Currency"."symbol" AS "symbol", "Currency"."code" AS "code", "Currency"."conversion_rate" AS "conversion_rate", "Currency"."last_updated" AS "last_updated", "EmailTemplate"."id" AS "id(EmailTemplate)", "EmailTemplate"."guid" AS "guid", "EmailTemplate"."name" AS "name(EmailTemplate)", "EmailTemplate"."description" AS "description(EmailTemplate)", "EmailTemplate"."sectionid" AS "sectionid", "EmailTemplate"."header_text" AS "header_text", "EmailTemplate"."messagegroup_id" AS "messagegroup_id", "Team"."id" AS "id(Team)", "Team"."guid" AS "guid(Team)", "Team"."name" AS "name(Team)", "Team"."sequence" AS "sequence", "Team"."forrequests" AS "forrequests", "Team"."foropps" AS "foropps", "Team"."forprojects" AS "forprojects", "Team"."ticket_count" AS "ticket_count", "Team"."department_id" AS "department_id", "Team"."department_name" AS "department_name", "Team"."org_team_name" AS "org_team_name", "Team"."inactive" AS "inactive(Team)", "Team"."override_column_id" AS "override_column_id", "Team"."teamphotopath" AS "teamphotopath", "Team"."hide_agents_in_tree_if_no_tickets" AS "hide_agents_in_tree_if_no_tickets", "Team"."concurrent_lic_limit" AS "concurrent_lic_limit", "Team"."use" AS "use(Team)", "Team"."homescreendashboardid" AS "homescreendashboardid", "Tax"."id" AS "id(Tax)", "Tax"."name" AS "name(Tax)", "Tax"."code" AS "code(Tax)", "Tax"."value" AS "value", "Tax"."xero_tenant_id" AS "xero_tenant_id", "Tax"."xero_tenant_name" AS "xero_tenant_name", "Tax"."third_party_desc" AS "third_party_desc", "Tax"."is_composite" AS "is_composite", "Tax"."kashflow_tenant_id" AS "kashflow_tenant_id", "Tax"."kashflow_tenant_name" AS "kashflow_tenant_name", "Tax"."qbocode" AS "qbocode", "Tax"."qbocode_name" AS "qbocode_name", "Tax"."qbotaxcode.value" AS "qbotaxcode.value", "Tax"."qbotaxcode.label" AS "qbotaxcode.label", "Tax"."qbo_company_name" AS "qbo_company_name" FROM "halops_dash"."Agent" AS "Agent" INNER JOIN "halops_dash"."Address" AS "Address" ON "Agent"."id" = "Address"."id" INNER JOIN "halops_dash"."Application" AS "Application" ON "Address"."inactive" = "Application"."inactive" INNER JOIN "halops_dash"."Currency" AS "Currency" ON "Agent"."id" = "Currency"."id" INNER JOIN "halops_dash"."EmailTemplate" AS "EmailTemplate" ON "Agent"."id" = "EmailTemplate"."id" INNER JOIN "halops_dash"."Team" AS "Team" ON "Agent"."id" = "Team"."id" INNER JOIN "halops_dash"."Tax" AS "Tax" ON "Agent"."id" = "Tax"."id") temp_table ORDER BY "sum(value)" ASC NULLS FIRST
'''

shft_q7 = '''SELECT COUNT(DISTINCT "inactive(Application)") AS "CNTD(inactive(Application))" FROM (SELECT "Agent"."id" AS "id", "Agent"."name" AS "name", "Agent"."team" AS "team", "Agent"."isdisabled" AS "isdisabled", "Agent"."ad" AS "ad", "Agent"."agentphotopath" AS "agentphotopath", "Agent"."initials" AS "initials", "Agent"."firstname" AS "firstname", "Agent"."surname" AS "surname", "Agent"."colour" AS "colour", "Agent"."jobtitle" AS "jobtitle", "Agent"."sms" AS "sms", "Agent"."extensionnumber" AS "extensionnumber", "Agent"."is_agent" AS "is_agent", "Agent"."googleemail" AS "googleemail", "Agent"."linemanager" AS "linemanager", "Agent"."exchange_authorized" AS "exchange_authorized", "Agent"."exchange_account" AS "exchange_account", "Agent"."sentinel_authorized" AS "sentinel_authorized", "Agent"."licence_type" AS "licence_type", "Agent"."splashtop_authorized" AS "splashtop_authorized", "Agent"."gotoresolve_authorized" AS "gotoresolve_authorized", "Agent"."use" AS "use", "Agent"."logmeinid" AS "logmeinid", "Agent"."allowbeyondtrustinvites" AS "allowbeyondtrustinvites", "Agent"."jira_id" AS "jira_id", "Agent"."namewithinactive" AS "namewithinactive", "Agent"."apptsync" AS "apptsync", "Agent"."sendemailerrors" AS "sendemailerrors", "Agent"."can_approve_purchaseorder" AS "can_approve_purchaseorder", "Agent"."can_approve_quote" AS "can_approve_quote", "Agent"."can_approve_invoice" AS "can_approve_invoice", "Agent"."workday_id" AS "workday_id", "Agent"."costprice" AS "costprice", "Agent"."chargerate" AS "chargerate", "Agent"."email" AS "email", "Agent"."teams[0].id" AS "teams[0].id", "Agent"."teams[0].agent_id" AS "teams[0].agent_id", "Agent"."teams[0].team_id" AS "teams[0].team_id", "Agent"."teams[0].team_name" AS "teams[0].team_name", "Agent"."teams[0].department_id" AS "teams[0].department_id", "Agent"."teams[0].role_id" AS "teams[0].role_id", "Agent"."teams[0].is_manager" AS "teams[0].is_manager", "Agent"."teams[0].no_config_access" AS "teams[0].no_config_access", "Agent"."teams[0].unassigned_access" AS "teams[0].unassigned_access", "Agent"."teams[0].otheragent_access" AS "teams[0].otheragent_access", "Agent"."teams[0].fortickets" AS "teams[0].fortickets", "Agent"."teams[0].foropps" AS "teams[0].foropps", "Agent"."teams[0].forprojects" AS "teams[0].forprojects", "Agent"."teams[0].in_section" AS "teams[0].in_section", "Agent"."departments[0].id" AS "departments[0].id", "Agent"."departments[0].agent_id" AS "departments[0].agent_id", "Agent"."departments[0].department_id" AS "departments[0].department_id", "Agent"."departments[0].role_id" AS "departments[0].role_id", "Agent"."departments[0].membershiplevel" AS "departments[0].membershiplevel", "Agent"."departments[0].includeteamsintree" AS "departments[0].includeteamsintree", "Agent"."departments[1].id" AS "departments[1].id", "Agent"."departments[1].agent_id" AS "departments[1].agent_id", "Agent"."departments[1].department_id" AS "departments[1].department_id", "Agent"."departments[1].role_id" AS "departments[1].role_id", "Agent"."departments[1].membershiplevel" AS "departments[1].membershiplevel", "Agent"."departments[1].includeteamsintree" AS "departments[1].includeteamsintree", "Agent"."departments[2].id" AS "departments[2].id", "Agent"."departments[2].agent_id" AS "departments[2].agent_id", "Agent"."departments[2].department_id" AS "departments[2].department_id", "Agent"."departments[2].role_id" AS "departments[2].role_id", "Agent"."departments[2].membershiplevel" AS "departments[2].membershiplevel", "Agent"."departments[2].includeteamsintree" AS "departments[2].includeteamsintree", "Agent"."teams[1].id" AS "teams[1].id", "Agent"."teams[1].agent_id" AS "teams[1].agent_id", "Agent"."teams[1].team_id" AS "teams[1].team_id", "Agent"."teams[1].team_name" AS "teams[1].team_name", "Agent"."teams[1].department_id" AS "teams[1].department_id", "Agent"."teams[1].is_manager" AS "teams[1].is_manager", "Agent"."teams[1].no_config_access" AS "teams[1].no_config_access", "Agent"."teams[1].unassigned_access" AS "teams[1].unassigned_access", "Agent"."teams[1].otheragent_access" AS "teams[1].otheragent_access", "Agent"."teams[1].fortickets" AS "teams[1].fortickets", "Agent"."teams[1].foropps" AS "teams[1].foropps", "Agent"."teams[1].forprojects" AS "teams[1].forprojects", "Agent"."teams[1].in_section" AS "teams[1].in_section", "Agent"."teams[2].id" AS "teams[2].id", "Agent"."teams[2].agent_id" AS "teams[2].agent_id", "Agent"."teams[2].team_id" AS "teams[2].team_id", "Agent"."teams[2].team_name" AS "teams[2].team_name", "Agent"."teams[2].department_id" AS "teams[2].department_id", "Agent"."teams[2].role_id" AS "teams[2].role_id", "Agent"."teams[2].is_manager" AS "teams[2].is_manager", "Agent"."teams[2].no_config_access" AS "teams[2].no_config_access", "Agent"."teams[2].unassigned_access" AS "teams[2].unassigned_access", "Agent"."teams[2].otheragent_access" AS "teams[2].otheragent_access", "Agent"."teams[2].fortickets" AS "teams[2].fortickets", "Agent"."teams[2].foropps" AS "teams[2].foropps", "Agent"."teams[2].forprojects" AS "teams[2].forprojects", "Agent"."teams[2].in_section" AS "teams[2].in_section", "Agent"."teams[3].id" AS "teams[3].id", "Agent"."teams[3].agent_id" AS "teams[3].agent_id", "Agent"."teams[3].team_id" AS "teams[3].team_id", "Agent"."teams[3].team_name" AS "teams[3].team_name", "Agent"."teams[3].department_id" AS "teams[3].department_id", "Agent"."teams[3].role_id" AS "teams[3].role_id", "Agent"."teams[3].is_manager" AS "teams[3].is_manager", "Agent"."teams[3].no_config_access" AS "teams[3].no_config_access", "Agent"."teams[3].unassigned_access" AS "teams[3].unassigned_access", "Agent"."teams[3].otheragent_access" AS "teams[3].otheragent_access", "Agent"."teams[3].fortickets" AS "teams[3].fortickets", "Agent"."teams[3].foropps" AS "teams[3].foropps", "Agent"."teams[3].forprojects" AS "teams[3].forprojects", "Agent"."teams[3].in_section" AS "teams[3].in_section", "Agent"."teams[4].id" AS "teams[4].id", "Agent"."teams[4].agent_id" AS "teams[4].agent_id", "Agent"."teams[4].team_id" AS "teams[4].team_id", "Agent"."teams[4].team_name" AS "teams[4].team_name", "Agent"."teams[4].department_id" AS "teams[4].department_id", "Agent"."teams[4].role_id" AS "teams[4].role_id", "Agent"."teams[4].is_manager" AS "teams[4].is_manager", "Agent"."teams[4].no_config_access" AS "teams[4].no_config_access", "Agent"."teams[4].unassigned_access" AS "teams[4].unassigned_access", "Agent"."teams[4].otheragent_access" AS "teams[4].otheragent_access", "Agent"."teams[4].fortickets" AS "teams[4].fortickets", "Agent"."teams[4].foropps" AS "teams[4].foropps", "Agent"."teams[4].forprojects" AS "teams[4].forprojects", "Agent"."teams[4].in_section" AS "teams[4].in_section", "Agent"."departments[3].id" AS "departments[3].id", "Agent"."departments[3].agent_id" AS "departments[3].agent_id", "Agent"."departments[3].department_id" AS "departments[3].department_id", "Agent"."departments[3].role_id" AS "departments[3].role_id", "Agent"."departments[3].membershiplevel" AS "departments[3].membershiplevel", "Agent"."departments[3].includeteamsintree" AS "departments[3].includeteamsintree", "Agent"."departments[4].id" AS "departments[4].id", "Agent"."departments[4].agent_id" AS "departments[4].agent_id", "Agent"."departments[4].department_id" AS "departments[4].department_id", "Agent"."departments[4].role_id" AS "departments[4].role_id", "Agent"."departments[4].membershiplevel" AS "departments[4].membershiplevel", "Agent"."departments[4].includeteamsintree" AS "departments[4].includeteamsintree", "Agent"."departments[5].id" AS "departments[5].id", "Agent"."departments[5].agent_id" AS "departments[5].agent_id", "Agent"."departments[5].department_id" AS "departments[5].department_id", "Agent"."departments[5].role_id" AS "departments[5].role_id", "Agent"."departments[5].membershiplevel" AS "departments[5].membershiplevel", "Agent"."departments[5].includeteamsintree" AS "departments[5].includeteamsintree", "Agent"."teams[1].role_id" AS "teams[1].role_id", "Agent"."lastlogindate" AS "lastlogindate", "Agent"."teams[5].id" AS "teams[5].id", "Agent"."teams[5].agent_id" AS "teams[5].agent_id", "Agent"."teams[5].team_id" AS "teams[5].team_id", "Agent"."teams[5].team_name" AS "teams[5].team_name", "Agent"."teams[5].department_id" AS "teams[5].department_id", "Agent"."teams[5].is_manager" AS "teams[5].is_manager", "Agent"."teams[5].no_config_access" AS "teams[5].no_config_access", "Agent"."teams[5].unassigned_access" AS "teams[5].unassigned_access", "Agent"."teams[5].otheragent_access" AS "teams[5].otheragent_access", "Agent"."teams[5].fortickets" AS "teams[5].fortickets", "Agent"."teams[5].foropps" AS "teams[5].foropps", "Agent"."teams[5].forprojects" AS "teams[5].forprojects", "Agent"."teams[5].in_section" AS "teams[5].in_section", "Agent"."teams[6].id" AS "teams[6].id", "Agent"."teams[6].agent_id" AS "teams[6].agent_id", "Agent"."teams[6].team_id" AS "teams[6].team_id", "Agent"."teams[6].team_name" AS "teams[6].team_name", "Agent"."teams[6].department_id" AS "teams[6].department_id", "Agent"."teams[6].role_id" AS "teams[6].role_id", "Agent"."teams[6].is_manager" AS "teams[6].is_manager", "Agent"."teams[6].no_config_access" AS "teams[6].no_config_access", "Agent"."teams[6].unassigned_access" AS "teams[6].unassigned_access", "Agent"."teams[6].otheragent_access" AS "teams[6].otheragent_access", "Agent"."teams[6].fortickets" AS "teams[6].fortickets", "Agent"."teams[6].foropps" AS "teams[6].foropps", "Agent"."teams[6].forprojects" AS "teams[6].forprojects", "Agent"."teams[6].in_section" AS "teams[6].in_section", "Agent"."teams[7].id" AS "teams[7].id", "Agent"."teams[7].agent_id" AS "teams[7].agent_id", "Agent"."teams[7].team_id" AS "teams[7].team_id", "Agent"."teams[7].team_name" AS "teams[7].team_name", "Agent"."teams[7].department_id" AS "teams[7].department_id", "Agent"."teams[7].role_id" AS "teams[7].role_id", "Agent"."teams[7].is_manager" AS "teams[7].is_manager", "Agent"."teams[7].no_config_access" AS "teams[7].no_config_access", "Agent"."teams[7].unassigned_access" AS "teams[7].unassigned_access", "Agent"."teams[7].otheragent_access" AS "teams[7].otheragent_access", "Agent"."teams[7].fortickets" AS "teams[7].fortickets", "Agent"."teams[7].foropps" AS "teams[7].foropps", "Agent"."teams[7].forprojects" AS "teams[7].forprojects", "Agent"."teams[7].in_section" AS "teams[7].in_section", "Agent"."departments[6].id" AS "departments[6].id", "Agent"."departments[6].agent_id" AS "departments[6].agent_id", "Agent"."departments[6].department_id" AS "departments[6].department_id", "Agent"."departments[6].role_id" AS "departments[6].role_id", "Agent"."departments[6].membershiplevel" AS "departments[6].membershiplevel", "Agent"."departments[6].includeteamsintree" AS "departments[6].includeteamsintree", "Agent"."departments[7].id" AS "departments[7].id", "Agent"."departments[7].agent_id" AS "departments[7].agent_id", "Agent"."departments[7].department_id" AS "departments[7].department_id", "Agent"."departments[7].role_id" AS "departments[7].role_id", "Agent"."departments[7].membershiplevel" AS "departments[7].membershiplevel", "Agent"."departments[7].includeteamsintree" AS "departments[7].includeteamsintree", "Agent"."departments[8].id" AS "departments[8].id", "Agent"."departments[8].agent_id" AS "departments[8].agent_id", "Agent"."departments[8].department_id" AS "departments[8].department_id", "Agent"."departments[8].role_id" AS "departments[8].role_id", "Agent"."departments[8].membershiplevel" AS "departments[8].membershiplevel", "Agent"."departments[8].includeteamsintree" AS "departments[8].includeteamsintree", "Agent"."departments[9].id" AS "departments[9].id", "Agent"."departments[9].agent_id" AS "departments[9].agent_id", "Agent"."departments[9].department_id" AS "departments[9].department_id", "Agent"."departments[9].role_id" AS "departments[9].role_id", "Agent"."departments[9].membershiplevel" AS "departments[9].membershiplevel", "Agent"."departments[9].includeteamsintree" AS "departments[9].includeteamsintree", "Agent"."departments[10].id" AS "departments[10].id", "Agent"."departments[10].agent_id" AS "departments[10].agent_id", "Agent"."departments[10].department_id" AS "departments[10].department_id", "Agent"."departments[10].role_id" AS "departments[10].role_id", "Agent"."departments[10].membershiplevel" AS "departments[10].membershiplevel", "Agent"."departments[10].includeteamsintree" AS "departments[10].includeteamsintree", "Agent"."departments[11].id" AS "departments[11].id", "Agent"."departments[11].agent_id" AS "departments[11].agent_id", "Agent"."departments[11].department_id" AS "departments[11].department_id", "Agent"."departments[11].role_id" AS "departments[11].role_id", "Agent"."departments[11].membershiplevel" AS "departments[11].membershiplevel", "Agent"."departments[11].includeteamsintree" AS "departments[11].includeteamsintree", "Address"."id" AS "id(Address)", "Address"."type" AS "type", "Address"."line1" AS "line1", "Address"."line2" AS "line2", "Address"."line3" AS "line3", "Address"."line4" AS "line4", "Address"."postcode" AS "postcode", "Address"."primary" AS "primary", "Address"."inactive" AS "inactive", "Address"."date_active" AS "date_active", "Address"."site_id" AS "site_id", "Address"."description" AS "description", "Address"."lat" AS "lat", "Address"."long" AS "long", "Address"."note" AS "note", "Application"."grant_type" AS "grant_type", "Application"."loginas_agent_id" AS "loginas_agent_id", "Application"."inactive" AS "inactive(Application)", "Application"."system_use" AS "system_use", "Application"."redirecturi" AS "redirecturi", "Application"."logoutredirecturi" AS "logoutredirecturi", "Application"."cors_whitelist" AS "cors_whitelist", "Application"."allowagents" AS "allowagents", "Application"."allowusers" AS "allowusers", "Application"."organisation_id" AS "organisation_id", "Application"."loginas_client_id" AS "loginas_client_id", "Application"."loginas_supplier_id" AS "loginas_supplier_id", "Application"."loginentity" AS "loginentity", "Application"."language_id" AS "language_id", "Application"."disable_windowsauth" AS "disable_windowsauth", "Application"."disable_azure" AS "disable_azure", "Application"."disable_adfs" AS "disable_adfs", "Application"."disable_okta" AS "disable_okta", "Application"."disable_centrify" AS "disable_centrify", "Application"."disable_google" AS "disable_google", "Application"."disable_anon" AS "disable_anon", "Application"."clientId" AS "clientId", "Application"."concurrencyToken" AS "concurrencyToken", "Application"."displayName" AS "displayName", "Application"."id" AS "id(Application)", "Application"."postLogoutRedirectUris" AS "postLogoutRedirectUris", "Application"."redirectUris" AS "redirectUris", "Application"."type" AS "type(Application)", "Application"."_issystem" AS "_issystem", "Currency"."id" AS "id(Currency)", "Currency"."name" AS "name(Currency)", "Currency"."symbol" AS "symbol", "Currency"."code" AS "code", "Currency"."conversion_rate" AS "conversion_rate", "Currency"."last_updated" AS "last_updated", "EmailTemplate"."id" AS "id(EmailTemplate)", "EmailTemplate"."guid" AS "guid", "EmailTemplate"."name" AS "name(EmailTemplate)", "EmailTemplate"."description" AS "description(EmailTemplate)", "EmailTemplate"."sectionid" AS "sectionid", "EmailTemplate"."header_text" AS "header_text", "EmailTemplate"."messagegroup_id" AS "messagegroup_id", "Team"."id" AS "id(Team)", "Team"."guid" AS "guid(Team)", "Team"."name" AS "name(Team)", "Team"."sequence" AS "sequence", "Team"."forrequests" AS "forrequests", "Team"."foropps" AS "foropps", "Team"."forprojects" AS "forprojects", "Team"."ticket_count" AS "ticket_count", "Team"."department_id" AS "department_id", "Team"."department_name" AS "department_name", "Team"."org_team_name" AS "org_team_name", "Team"."inactive" AS "inactive(Team)", "Team"."override_column_id" AS "override_column_id", "Team"."teamphotopath" AS "teamphotopath", "Team"."hide_agents_in_tree_if_no_tickets" AS "hide_agents_in_tree_if_no_tickets", "Team"."concurrent_lic_limit" AS "concurrent_lic_limit", "Team"."use" AS "use(Team)", "Team"."homescreendashboardid" AS "homescreendashboardid", "Tax"."id" AS "id(Tax)", "Tax"."name" AS "name(Tax)", "Tax"."code" AS "code(Tax)", "Tax"."value" AS "value", "Tax"."xero_tenant_id" AS "xero_tenant_id", "Tax"."xero_tenant_name" AS "xero_tenant_name", "Tax"."third_party_desc" AS "third_party_desc", "Tax"."is_composite" AS "is_composite", "Tax"."kashflow_tenant_id" AS "kashflow_tenant_id", "Tax"."kashflow_tenant_name" AS "kashflow_tenant_name", "Tax"."qbocode" AS "qbocode", "Tax"."qbocode_name" AS "qbocode_name", "Tax"."qbotaxcode.value" AS "qbotaxcode.value", "Tax"."qbotaxcode.label" AS "qbotaxcode.label", "Tax"."qbo_company_name" AS "qbo_company_name" FROM "halops_dash"."Agent" AS "Agent" INNER JOIN "halops_dash"."Address" AS "Address" ON "Agent"."id" = "Address"."id" INNER JOIN "halops_dash"."Application" AS "Application" ON "Address"."inactive" = "Application"."inactive" INNER JOIN "halops_dash"."Currency" AS "Currency" ON "Agent"."id" = "Currency"."id" INNER JOIN "halops_dash"."EmailTemplate" AS "EmailTemplate" ON "Agent"."id" = "EmailTemplate"."id" INNER JOIN "halops_dash"."Team" AS "Team" ON "Agent"."id" = "Team"."id" INNER JOIN "halops_dash"."Tax" AS "Tax" ON "Agent"."id" = "Tax"."id") temp_table ORDER BY "CNTD(inactive(Application))" ASC NULLS FIRST
'''

shft_q8 = '''SELECT COUNT(DISTINCT "organisation_id") AS "CNTD(organisation_id)" FROM (SELECT "Agent"."id" AS "id", "Agent"."name" AS "name", "Agent"."team" AS "team", "Agent"."isdisabled" AS "isdisabled", "Agent"."ad" AS "ad", "Agent"."agentphotopath" AS "agentphotopath", "Agent"."initials" AS "initials", "Agent"."firstname" AS "firstname", "Agent"."surname" AS "surname", "Agent"."colour" AS "colour", "Agent"."jobtitle" AS "jobtitle", "Agent"."sms" AS "sms", "Agent"."extensionnumber" AS "extensionnumber", "Agent"."is_agent" AS "is_agent", "Agent"."googleemail" AS "googleemail", "Agent"."linemanager" AS "linemanager", "Agent"."exchange_authorized" AS "exchange_authorized", "Agent"."exchange_account" AS "exchange_account", "Agent"."sentinel_authorized" AS "sentinel_authorized", "Agent"."licence_type" AS "licence_type", "Agent"."splashtop_authorized" AS "splashtop_authorized", "Agent"."gotoresolve_authorized" AS "gotoresolve_authorized", "Agent"."use" AS "use", "Agent"."logmeinid" AS "logmeinid", "Agent"."allowbeyondtrustinvites" AS "allowbeyondtrustinvites", "Agent"."jira_id" AS "jira_id", "Agent"."namewithinactive" AS "namewithinactive", "Agent"."apptsync" AS "apptsync", "Agent"."sendemailerrors" AS "sendemailerrors", "Agent"."can_approve_purchaseorder" AS "can_approve_purchaseorder", "Agent"."can_approve_quote" AS "can_approve_quote", "Agent"."can_approve_invoice" AS "can_approve_invoice", "Agent"."workday_id" AS "workday_id", "Agent"."costprice" AS "costprice", "Agent"."chargerate" AS "chargerate", "Agent"."email" AS "email", "Agent"."teams[0].id" AS "teams[0].id", "Agent"."teams[0].agent_id" AS "teams[0].agent_id", "Agent"."teams[0].team_id" AS "teams[0].team_id", "Agent"."teams[0].team_name" AS "teams[0].team_name", "Agent"."teams[0].department_id" AS "teams[0].department_id", "Agent"."teams[0].role_id" AS "teams[0].role_id", "Agent"."teams[0].is_manager" AS "teams[0].is_manager", "Agent"."teams[0].no_config_access" AS "teams[0].no_config_access", "Agent"."teams[0].unassigned_access" AS "teams[0].unassigned_access", "Agent"."teams[0].otheragent_access" AS "teams[0].otheragent_access", "Agent"."teams[0].fortickets" AS "teams[0].fortickets", "Agent"."teams[0].foropps" AS "teams[0].foropps", "Agent"."teams[0].forprojects" AS "teams[0].forprojects", "Agent"."teams[0].in_section" AS "teams[0].in_section", "Agent"."departments[0].id" AS "departments[0].id", "Agent"."departments[0].agent_id" AS "departments[0].agent_id", "Agent"."departments[0].department_id" AS "departments[0].department_id", "Agent"."departments[0].role_id" AS "departments[0].role_id", "Agent"."departments[0].membershiplevel" AS "departments[0].membershiplevel", "Agent"."departments[0].includeteamsintree" AS "departments[0].includeteamsintree", "Agent"."departments[1].id" AS "departments[1].id", "Agent"."departments[1].agent_id" AS "departments[1].agent_id", "Agent"."departments[1].department_id" AS "departments[1].department_id", "Agent"."departments[1].role_id" AS "departments[1].role_id", "Agent"."departments[1].membershiplevel" AS "departments[1].membershiplevel", "Agent"."departments[1].includeteamsintree" AS "departments[1].includeteamsintree", "Agent"."departments[2].id" AS "departments[2].id", "Agent"."departments[2].agent_id" AS "departments[2].agent_id", "Agent"."departments[2].department_id" AS "departments[2].department_id", "Agent"."departments[2].role_id" AS "departments[2].role_id", "Agent"."departments[2].membershiplevel" AS "departments[2].membershiplevel", "Agent"."departments[2].includeteamsintree" AS "departments[2].includeteamsintree", "Agent"."teams[1].id" AS "teams[1].id", "Agent"."teams[1].agent_id" AS "teams[1].agent_id", "Agent"."teams[1].team_id" AS "teams[1].team_id", "Agent"."teams[1].team_name" AS "teams[1].team_name", "Agent"."teams[1].department_id" AS "teams[1].department_id", "Agent"."teams[1].is_manager" AS "teams[1].is_manager", "Agent"."teams[1].no_config_access" AS "teams[1].no_config_access", "Agent"."teams[1].unassigned_access" AS "teams[1].unassigned_access", "Agent"."teams[1].otheragent_access" AS "teams[1].otheragent_access", "Agent"."teams[1].fortickets" AS "teams[1].fortickets", "Agent"."teams[1].foropps" AS "teams[1].foropps", "Agent"."teams[1].forprojects" AS "teams[1].forprojects", "Agent"."teams[1].in_section" AS "teams[1].in_section", "Agent"."teams[2].id" AS "teams[2].id", "Agent"."teams[2].agent_id" AS "teams[2].agent_id", "Agent"."teams[2].team_id" AS "teams[2].team_id", "Agent"."teams[2].team_name" AS "teams[2].team_name", "Agent"."teams[2].department_id" AS "teams[2].department_id", "Agent"."teams[2].role_id" AS "teams[2].role_id", "Agent"."teams[2].is_manager" AS "teams[2].is_manager", "Agent"."teams[2].no_config_access" AS "teams[2].no_config_access", "Agent"."teams[2].unassigned_access" AS "teams[2].unassigned_access", "Agent"."teams[2].otheragent_access" AS "teams[2].otheragent_access", "Agent"."teams[2].fortickets" AS "teams[2].fortickets", "Agent"."teams[2].foropps" AS "teams[2].foropps", "Agent"."teams[2].forprojects" AS "teams[2].forprojects", "Agent"."teams[2].in_section" AS "teams[2].in_section", "Agent"."teams[3].id" AS "teams[3].id", "Agent"."teams[3].agent_id" AS "teams[3].agent_id", "Agent"."teams[3].team_id" AS "teams[3].team_id", "Agent"."teams[3].team_name" AS "teams[3].team_name", "Agent"."teams[3].department_id" AS "teams[3].department_id", "Agent"."teams[3].role_id" AS "teams[3].role_id", "Agent"."teams[3].is_manager" AS "teams[3].is_manager", "Agent"."teams[3].no_config_access" AS "teams[3].no_config_access", "Agent"."teams[3].unassigned_access" AS "teams[3].unassigned_access", "Agent"."teams[3].otheragent_access" AS "teams[3].otheragent_access", "Agent"."teams[3].fortickets" AS "teams[3].fortickets", "Agent"."teams[3].foropps" AS "teams[3].foropps", "Agent"."teams[3].forprojects" AS "teams[3].forprojects", "Agent"."teams[3].in_section" AS "teams[3].in_section", "Agent"."teams[4].id" AS "teams[4].id", "Agent"."teams[4].agent_id" AS "teams[4].agent_id", "Agent"."teams[4].team_id" AS "teams[4].team_id", "Agent"."teams[4].team_name" AS "teams[4].team_name", "Agent"."teams[4].department_id" AS "teams[4].department_id", "Agent"."teams[4].role_id" AS "teams[4].role_id", "Agent"."teams[4].is_manager" AS "teams[4].is_manager", "Agent"."teams[4].no_config_access" AS "teams[4].no_config_access", "Agent"."teams[4].unassigned_access" AS "teams[4].unassigned_access", "Agent"."teams[4].otheragent_access" AS "teams[4].otheragent_access", "Agent"."teams[4].fortickets" AS "teams[4].fortickets", "Agent"."teams[4].foropps" AS "teams[4].foropps", "Agent"."teams[4].forprojects" AS "teams[4].forprojects", "Agent"."teams[4].in_section" AS "teams[4].in_section", "Agent"."departments[3].id" AS "departments[3].id", "Agent"."departments[3].agent_id" AS "departments[3].agent_id", "Agent"."departments[3].department_id" AS "departments[3].department_id", "Agent"."departments[3].role_id" AS "departments[3].role_id", "Agent"."departments[3].membershiplevel" AS "departments[3].membershiplevel", "Agent"."departments[3].includeteamsintree" AS "departments[3].includeteamsintree", "Agent"."departments[4].id" AS "departments[4].id", "Agent"."departments[4].agent_id" AS "departments[4].agent_id", "Agent"."departments[4].department_id" AS "departments[4].department_id", "Agent"."departments[4].role_id" AS "departments[4].role_id", "Agent"."departments[4].membershiplevel" AS "departments[4].membershiplevel", "Agent"."departments[4].includeteamsintree" AS "departments[4].includeteamsintree", "Agent"."departments[5].id" AS "departments[5].id", "Agent"."departments[5].agent_id" AS "departments[5].agent_id", "Agent"."departments[5].department_id" AS "departments[5].department_id", "Agent"."departments[5].role_id" AS "departments[5].role_id", "Agent"."departments[5].membershiplevel" AS "departments[5].membershiplevel", "Agent"."departments[5].includeteamsintree" AS "departments[5].includeteamsintree", "Agent"."teams[1].role_id" AS "teams[1].role_id", "Agent"."lastlogindate" AS "lastlogindate", "Agent"."teams[5].id" AS "teams[5].id", "Agent"."teams[5].agent_id" AS "teams[5].agent_id", "Agent"."teams[5].team_id" AS "teams[5].team_id", "Agent"."teams[5].team_name" AS "teams[5].team_name", "Agent"."teams[5].department_id" AS "teams[5].department_id", "Agent"."teams[5].is_manager" AS "teams[5].is_manager", "Agent"."teams[5].no_config_access" AS "teams[5].no_config_access", "Agent"."teams[5].unassigned_access" AS "teams[5].unassigned_access", "Agent"."teams[5].otheragent_access" AS "teams[5].otheragent_access", "Agent"."teams[5].fortickets" AS "teams[5].fortickets", "Agent"."teams[5].foropps" AS "teams[5].foropps", "Agent"."teams[5].forprojects" AS "teams[5].forprojects", "Agent"."teams[5].in_section" AS "teams[5].in_section", "Agent"."teams[6].id" AS "teams[6].id", "Agent"."teams[6].agent_id" AS "teams[6].agent_id", "Agent"."teams[6].team_id" AS "teams[6].team_id", "Agent"."teams[6].team_name" AS "teams[6].team_name", "Agent"."teams[6].department_id" AS "teams[6].department_id", "Agent"."teams[6].role_id" AS "teams[6].role_id", "Agent"."teams[6].is_manager" AS "teams[6].is_manager", "Agent"."teams[6].no_config_access" AS "teams[6].no_config_access", "Agent"."teams[6].unassigned_access" AS "teams[6].unassigned_access", "Agent"."teams[6].otheragent_access" AS "teams[6].otheragent_access", "Agent"."teams[6].fortickets" AS "teams[6].fortickets", "Agent"."teams[6].foropps" AS "teams[6].foropps", "Agent"."teams[6].forprojects" AS "teams[6].forprojects", "Agent"."teams[6].in_section" AS "teams[6].in_section", "Agent"."teams[7].id" AS "teams[7].id", "Agent"."teams[7].agent_id" AS "teams[7].agent_id", "Agent"."teams[7].team_id" AS "teams[7].team_id", "Agent"."teams[7].team_name" AS "teams[7].team_name", "Agent"."teams[7].department_id" AS "teams[7].department_id", "Agent"."teams[7].role_id" AS "teams[7].role_id", "Agent"."teams[7].is_manager" AS "teams[7].is_manager", "Agent"."teams[7].no_config_access" AS "teams[7].no_config_access", "Agent"."teams[7].unassigned_access" AS "teams[7].unassigned_access", "Agent"."teams[7].otheragent_access" AS "teams[7].otheragent_access", "Agent"."teams[7].fortickets" AS "teams[7].fortickets", "Agent"."teams[7].foropps" AS "teams[7].foropps", "Agent"."teams[7].forprojects" AS "teams[7].forprojects", "Agent"."teams[7].in_section" AS "teams[7].in_section", "Agent"."departments[6].id" AS "departments[6].id", "Agent"."departments[6].agent_id" AS "departments[6].agent_id", "Agent"."departments[6].department_id" AS "departments[6].department_id", "Agent"."departments[6].role_id" AS "departments[6].role_id", "Agent"."departments[6].membershiplevel" AS "departments[6].membershiplevel", "Agent"."departments[6].includeteamsintree" AS "departments[6].includeteamsintree", "Agent"."departments[7].id" AS "departments[7].id", "Agent"."departments[7].agent_id" AS "departments[7].agent_id", "Agent"."departments[7].department_id" AS "departments[7].department_id", "Agent"."departments[7].role_id" AS "departments[7].role_id", "Agent"."departments[7].membershiplevel" AS "departments[7].membershiplevel", "Agent"."departments[7].includeteamsintree" AS "departments[7].includeteamsintree", "Agent"."departments[8].id" AS "departments[8].id", "Agent"."departments[8].agent_id" AS "departments[8].agent_id", "Agent"."departments[8].department_id" AS "departments[8].department_id", "Agent"."departments[8].role_id" AS "departments[8].role_id", "Agent"."departments[8].membershiplevel" AS "departments[8].membershiplevel", "Agent"."departments[8].includeteamsintree" AS "departments[8].includeteamsintree", "Agent"."departments[9].id" AS "departments[9].id", "Agent"."departments[9].agent_id" AS "departments[9].agent_id", "Agent"."departments[9].department_id" AS "departments[9].department_id", "Agent"."departments[9].role_id" AS "departments[9].role_id", "Agent"."departments[9].membershiplevel" AS "departments[9].membershiplevel", "Agent"."departments[9].includeteamsintree" AS "departments[9].includeteamsintree", "Agent"."departments[10].id" AS "departments[10].id", "Agent"."departments[10].agent_id" AS "departments[10].agent_id", "Agent"."departments[10].department_id" AS "departments[10].department_id", "Agent"."departments[10].role_id" AS "departments[10].role_id", "Agent"."departments[10].membershiplevel" AS "departments[10].membershiplevel", "Agent"."departments[10].includeteamsintree" AS "departments[10].includeteamsintree", "Agent"."departments[11].id" AS "departments[11].id", "Agent"."departments[11].agent_id" AS "departments[11].agent_id", "Agent"."departments[11].department_id" AS "departments[11].department_id", "Agent"."departments[11].role_id" AS "departments[11].role_id", "Agent"."departments[11].membershiplevel" AS "departments[11].membershiplevel", "Agent"."departments[11].includeteamsintree" AS "departments[11].includeteamsintree", "Address"."id" AS "id(Address)", "Address"."type" AS "type", "Address"."line1" AS "line1", "Address"."line2" AS "line2", "Address"."line3" AS "line3", "Address"."line4" AS "line4", "Address"."postcode" AS "postcode", "Address"."primary" AS "primary", "Address"."inactive" AS "inactive", "Address"."date_active" AS "date_active", "Address"."site_id" AS "site_id", "Address"."description" AS "description", "Address"."lat" AS "lat", "Address"."long" AS "long", "Address"."note" AS "note", "Application"."grant_type" AS "grant_type", "Application"."loginas_agent_id" AS "loginas_agent_id", "Application"."inactive" AS "inactive(Application)", "Application"."system_use" AS "system_use", "Application"."redirecturi" AS "redirecturi", "Application"."logoutredirecturi" AS "logoutredirecturi", "Application"."cors_whitelist" AS "cors_whitelist", "Application"."allowagents" AS "allowagents", "Application"."allowusers" AS "allowusers", "Application"."organisation_id" AS "organisation_id", "Application"."loginas_client_id" AS "loginas_client_id", "Application"."loginas_supplier_id" AS "loginas_supplier_id", "Application"."loginentity" AS "loginentity", "Application"."language_id" AS "language_id", "Application"."disable_windowsauth" AS "disable_windowsauth", "Application"."disable_azure" AS "disable_azure", "Application"."disable_adfs" AS "disable_adfs", "Application"."disable_okta" AS "disable_okta", "Application"."disable_centrify" AS "disable_centrify", "Application"."disable_google" AS "disable_google", "Application"."disable_anon" AS "disable_anon", "Application"."clientId" AS "clientId", "Application"."concurrencyToken" AS "concurrencyToken", "Application"."displayName" AS "displayName", "Application"."id" AS "id(Application)", "Application"."postLogoutRedirectUris" AS "postLogoutRedirectUris", "Application"."redirectUris" AS "redirectUris", "Application"."type" AS "type(Application)", "Application"."_issystem" AS "_issystem", "Currency"."id" AS "id(Currency)", "Currency"."name" AS "name(Currency)", "Currency"."symbol" AS "symbol", "Currency"."code" AS "code", "Currency"."conversion_rate" AS "conversion_rate", "Currency"."last_updated" AS "last_updated", "EmailTemplate"."id" AS "id(EmailTemplate)", "EmailTemplate"."guid" AS "guid", "EmailTemplate"."name" AS "name(EmailTemplate)", "EmailTemplate"."description" AS "description(EmailTemplate)", "EmailTemplate"."sectionid" AS "sectionid", "EmailTemplate"."header_text" AS "header_text", "EmailTemplate"."messagegroup_id" AS "messagegroup_id", "Team"."id" AS "id(Team)", "Team"."guid" AS "guid(Team)", "Team"."name" AS "name(Team)", "Team"."sequence" AS "sequence", "Team"."forrequests" AS "forrequests", "Team"."foropps" AS "foropps", "Team"."forprojects" AS "forprojects", "Team"."ticket_count" AS "ticket_count", "Team"."department_id" AS "department_id", "Team"."department_name" AS "department_name", "Team"."org_team_name" AS "org_team_name", "Team"."inactive" AS "inactive(Team)", "Team"."override_column_id" AS "override_column_id", "Team"."teamphotopath" AS "teamphotopath", "Team"."hide_agents_in_tree_if_no_tickets" AS "hide_agents_in_tree_if_no_tickets", "Team"."concurrent_lic_limit" AS "concurrent_lic_limit", "Team"."use" AS "use(Team)", "Team"."homescreendashboardid" AS "homescreendashboardid", "Tax"."id" AS "id(Tax)", "Tax"."name" AS "name(Tax)", "Tax"."code" AS "code(Tax)", "Tax"."value" AS "value", "Tax"."xero_tenant_id" AS "xero_tenant_id", "Tax"."xero_tenant_name" AS "xero_tenant_name", "Tax"."third_party_desc" AS "third_party_desc", "Tax"."is_composite" AS "is_composite", "Tax"."kashflow_tenant_id" AS "kashflow_tenant_id", "Tax"."kashflow_tenant_name" AS "kashflow_tenant_name", "Tax"."qbocode" AS "qbocode", "Tax"."qbocode_name" AS "qbocode_name", "Tax"."qbotaxcode.value" AS "qbotaxcode.value", "Tax"."qbotaxcode.label" AS "qbotaxcode.label", "Tax"."qbo_company_name" AS "qbo_company_name" FROM "halops_dash"."Agent" AS "Agent" INNER JOIN "halops_dash"."Address" AS "Address" ON "Agent"."id" = "Address"."id" INNER JOIN "halops_dash"."Application" AS "Application" ON "Address"."inactive" = "Application"."inactive" INNER JOIN "halops_dash"."Currency" AS "Currency" ON "Agent"."id" = "Currency"."id" INNER JOIN "halops_dash"."EmailTemplate" AS "EmailTemplate" ON "Agent"."id" = "EmailTemplate"."id" INNER JOIN "halops_dash"."Team" AS "Team" ON "Agent"."id" = "Team"."id" INNER JOIN "halops_dash"."Tax" AS "Tax" ON "Agent"."id" = "Tax"."id") temp_table ORDER BY "CNTD(organisation_id)" ASC NULLS FIRST
'''

shft_q9 = '''SELECT COUNT(DISTINCT "id(Team)") AS "CNTD(id(Team))" FROM (SELECT "Agent"."id" AS "id", "Agent"."name" AS "name", "Agent"."team" AS "team", "Agent"."isdisabled" AS "isdisabled", "Agent"."ad" AS "ad", "Agent"."agentphotopath" AS "agentphotopath", "Agent"."initials" AS "initials", "Agent"."firstname" AS "firstname", "Agent"."surname" AS "surname", "Agent"."colour" AS "colour", "Agent"."jobtitle" AS "jobtitle", "Agent"."sms" AS "sms", "Agent"."extensionnumber" AS "extensionnumber", "Agent"."is_agent" AS "is_agent", "Agent"."googleemail" AS "googleemail", "Agent"."linemanager" AS "linemanager", "Agent"."exchange_authorized" AS "exchange_authorized", "Agent"."exchange_account" AS "exchange_account", "Agent"."sentinel_authorized" AS "sentinel_authorized", "Agent"."licence_type" AS "licence_type", "Agent"."splashtop_authorized" AS "splashtop_authorized", "Agent"."gotoresolve_authorized" AS "gotoresolve_authorized", "Agent"."use" AS "use", "Agent"."logmeinid" AS "logmeinid", "Agent"."allowbeyondtrustinvites" AS "allowbeyondtrustinvites", "Agent"."jira_id" AS "jira_id", "Agent"."namewithinactive" AS "namewithinactive", "Agent"."apptsync" AS "apptsync", "Agent"."sendemailerrors" AS "sendemailerrors", "Agent"."can_approve_purchaseorder" AS "can_approve_purchaseorder", "Agent"."can_approve_quote" AS "can_approve_quote", "Agent"."can_approve_invoice" AS "can_approve_invoice", "Agent"."workday_id" AS "workday_id", "Agent"."costprice" AS "costprice", "Agent"."chargerate" AS "chargerate", "Agent"."email" AS "email", "Agent"."teams[0].id" AS "teams[0].id", "Agent"."teams[0].agent_id" AS "teams[0].agent_id", "Agent"."teams[0].team_id" AS "teams[0].team_id", "Agent"."teams[0].team_name" AS "teams[0].team_name", "Agent"."teams[0].department_id" AS "teams[0].department_id", "Agent"."teams[0].role_id" AS "teams[0].role_id", "Agent"."teams[0].is_manager" AS "teams[0].is_manager", "Agent"."teams[0].no_config_access" AS "teams[0].no_config_access", "Agent"."teams[0].unassigned_access" AS "teams[0].unassigned_access", "Agent"."teams[0].otheragent_access" AS "teams[0].otheragent_access", "Agent"."teams[0].fortickets" AS "teams[0].fortickets", "Agent"."teams[0].foropps" AS "teams[0].foropps", "Agent"."teams[0].forprojects" AS "teams[0].forprojects", "Agent"."teams[0].in_section" AS "teams[0].in_section", "Agent"."departments[0].id" AS "departments[0].id", "Agent"."departments[0].agent_id" AS "departments[0].agent_id", "Agent"."departments[0].department_id" AS "departments[0].department_id", "Agent"."departments[0].role_id" AS "departments[0].role_id", "Agent"."departments[0].membershiplevel" AS "departments[0].membershiplevel", "Agent"."departments[0].includeteamsintree" AS "departments[0].includeteamsintree", "Agent"."departments[1].id" AS "departments[1].id", "Agent"."departments[1].agent_id" AS "departments[1].agent_id", "Agent"."departments[1].department_id" AS "departments[1].department_id", "Agent"."departments[1].role_id" AS "departments[1].role_id", "Agent"."departments[1].membershiplevel" AS "departments[1].membershiplevel", "Agent"."departments[1].includeteamsintree" AS "departments[1].includeteamsintree", "Agent"."departments[2].id" AS "departments[2].id", "Agent"."departments[2].agent_id" AS "departments[2].agent_id", "Agent"."departments[2].department_id" AS "departments[2].department_id", "Agent"."departments[2].role_id" AS "departments[2].role_id", "Agent"."departments[2].membershiplevel" AS "departments[2].membershiplevel", "Agent"."departments[2].includeteamsintree" AS "departments[2].includeteamsintree", "Agent"."teams[1].id" AS "teams[1].id", "Agent"."teams[1].agent_id" AS "teams[1].agent_id", "Agent"."teams[1].team_id" AS "teams[1].team_id", "Agent"."teams[1].team_name" AS "teams[1].team_name", "Agent"."teams[1].department_id" AS "teams[1].department_id", "Agent"."teams[1].is_manager" AS "teams[1].is_manager", "Agent"."teams[1].no_config_access" AS "teams[1].no_config_access", "Agent"."teams[1].unassigned_access" AS "teams[1].unassigned_access", "Agent"."teams[1].otheragent_access" AS "teams[1].otheragent_access", "Agent"."teams[1].fortickets" AS "teams[1].fortickets", "Agent"."teams[1].foropps" AS "teams[1].foropps", "Agent"."teams[1].forprojects" AS "teams[1].forprojects", "Agent"."teams[1].in_section" AS "teams[1].in_section", "Agent"."teams[2].id" AS "teams[2].id", "Agent"."teams[2].agent_id" AS "teams[2].agent_id", "Agent"."teams[2].team_id" AS "teams[2].team_id", "Agent"."teams[2].team_name" AS "teams[2].team_name", "Agent"."teams[2].department_id" AS "teams[2].department_id", "Agent"."teams[2].role_id" AS "teams[2].role_id", "Agent"."teams[2].is_manager" AS "teams[2].is_manager", "Agent"."teams[2].no_config_access" AS "teams[2].no_config_access", "Agent"."teams[2].unassigned_access" AS "teams[2].unassigned_access", "Agent"."teams[2].otheragent_access" AS "teams[2].otheragent_access", "Agent"."teams[2].fortickets" AS "teams[2].fortickets", "Agent"."teams[2].foropps" AS "teams[2].foropps", "Agent"."teams[2].forprojects" AS "teams[2].forprojects", "Agent"."teams[2].in_section" AS "teams[2].in_section", "Agent"."teams[3].id" AS "teams[3].id", "Agent"."teams[3].agent_id" AS "teams[3].agent_id", "Agent"."teams[3].team_id" AS "teams[3].team_id", "Agent"."teams[3].team_name" AS "teams[3].team_name", "Agent"."teams[3].department_id" AS "teams[3].department_id", "Agent"."teams[3].role_id" AS "teams[3].role_id", "Agent"."teams[3].is_manager" AS "teams[3].is_manager", "Agent"."teams[3].no_config_access" AS "teams[3].no_config_access", "Agent"."teams[3].unassigned_access" AS "teams[3].unassigned_access", "Agent"."teams[3].otheragent_access" AS "teams[3].otheragent_access", "Agent"."teams[3].fortickets" AS "teams[3].fortickets", "Agent"."teams[3].foropps" AS "teams[3].foropps", "Agent"."teams[3].forprojects" AS "teams[3].forprojects", "Agent"."teams[3].in_section" AS "teams[3].in_section", "Agent"."teams[4].id" AS "teams[4].id", "Agent"."teams[4].agent_id" AS "teams[4].agent_id", "Agent"."teams[4].team_id" AS "teams[4].team_id", "Agent"."teams[4].team_name" AS "teams[4].team_name", "Agent"."teams[4].department_id" AS "teams[4].department_id", "Agent"."teams[4].role_id" AS "teams[4].role_id", "Agent"."teams[4].is_manager" AS "teams[4].is_manager", "Agent"."teams[4].no_config_access" AS "teams[4].no_config_access", "Agent"."teams[4].unassigned_access" AS "teams[4].unassigned_access", "Agent"."teams[4].otheragent_access" AS "teams[4].otheragent_access", "Agent"."teams[4].fortickets" AS "teams[4].fortickets", "Agent"."teams[4].foropps" AS "teams[4].foropps", "Agent"."teams[4].forprojects" AS "teams[4].forprojects", "Agent"."teams[4].in_section" AS "teams[4].in_section", "Agent"."departments[3].id" AS "departments[3].id", "Agent"."departments[3].agent_id" AS "departments[3].agent_id", "Agent"."departments[3].department_id" AS "departments[3].department_id", "Agent"."departments[3].role_id" AS "departments[3].role_id", "Agent"."departments[3].membershiplevel" AS "departments[3].membershiplevel", "Agent"."departments[3].includeteamsintree" AS "departments[3].includeteamsintree", "Agent"."departments[4].id" AS "departments[4].id", "Agent"."departments[4].agent_id" AS "departments[4].agent_id", "Agent"."departments[4].department_id" AS "departments[4].department_id", "Agent"."departments[4].role_id" AS "departments[4].role_id", "Agent"."departments[4].membershiplevel" AS "departments[4].membershiplevel", "Agent"."departments[4].includeteamsintree" AS "departments[4].includeteamsintree", "Agent"."departments[5].id" AS "departments[5].id", "Agent"."departments[5].agent_id" AS "departments[5].agent_id", "Agent"."departments[5].department_id" AS "departments[5].department_id", "Agent"."departments[5].role_id" AS "departments[5].role_id", "Agent"."departments[5].membershiplevel" AS "departments[5].membershiplevel", "Agent"."departments[5].includeteamsintree" AS "departments[5].includeteamsintree", "Agent"."teams[1].role_id" AS "teams[1].role_id", "Agent"."lastlogindate" AS "lastlogindate", "Agent"."teams[5].id" AS "teams[5].id", "Agent"."teams[5].agent_id" AS "teams[5].agent_id", "Agent"."teams[5].team_id" AS "teams[5].team_id", "Agent"."teams[5].team_name" AS "teams[5].team_name", "Agent"."teams[5].department_id" AS "teams[5].department_id", "Agent"."teams[5].is_manager" AS "teams[5].is_manager", "Agent"."teams[5].no_config_access" AS "teams[5].no_config_access", "Agent"."teams[5].unassigned_access" AS "teams[5].unassigned_access", "Agent"."teams[5].otheragent_access" AS "teams[5].otheragent_access", "Agent"."teams[5].fortickets" AS "teams[5].fortickets", "Agent"."teams[5].foropps" AS "teams[5].foropps", "Agent"."teams[5].forprojects" AS "teams[5].forprojects", "Agent"."teams[5].in_section" AS "teams[5].in_section", "Agent"."teams[6].id" AS "teams[6].id", "Agent"."teams[6].agent_id" AS "teams[6].agent_id", "Agent"."teams[6].team_id" AS "teams[6].team_id", "Agent"."teams[6].team_name" AS "teams[6].team_name", "Agent"."teams[6].department_id" AS "teams[6].department_id", "Agent"."teams[6].role_id" AS "teams[6].role_id", "Agent"."teams[6].is_manager" AS "teams[6].is_manager", "Agent"."teams[6].no_config_access" AS "teams[6].no_config_access", "Agent"."teams[6].unassigned_access" AS "teams[6].unassigned_access", "Agent"."teams[6].otheragent_access" AS "teams[6].otheragent_access", "Agent"."teams[6].fortickets" AS "teams[6].fortickets", "Agent"."teams[6].foropps" AS "teams[6].foropps", "Agent"."teams[6].forprojects" AS "teams[6].forprojects", "Agent"."teams[6].in_section" AS "teams[6].in_section", "Agent"."teams[7].id" AS "teams[7].id", "Agent"."teams[7].agent_id" AS "teams[7].agent_id", "Agent"."teams[7].team_id" AS "teams[7].team_id", "Agent"."teams[7].team_name" AS "teams[7].team_name", "Agent"."teams[7].department_id" AS "teams[7].department_id", "Agent"."teams[7].role_id" AS "teams[7].role_id", "Agent"."teams[7].is_manager" AS "teams[7].is_manager", "Agent"."teams[7].no_config_access" AS "teams[7].no_config_access", "Agent"."teams[7].unassigned_access" AS "teams[7].unassigned_access", "Agent"."teams[7].otheragent_access" AS "teams[7].otheragent_access", "Agent"."teams[7].fortickets" AS "teams[7].fortickets", "Agent"."teams[7].foropps" AS "teams[7].foropps", "Agent"."teams[7].forprojects" AS "teams[7].forprojects", "Agent"."teams[7].in_section" AS "teams[7].in_section", "Agent"."departments[6].id" AS "departments[6].id", "Agent"."departments[6].agent_id" AS "departments[6].agent_id", "Agent"."departments[6].department_id" AS "departments[6].department_id", "Agent"."departments[6].role_id" AS "departments[6].role_id", "Agent"."departments[6].membershiplevel" AS "departments[6].membershiplevel", "Agent"."departments[6].includeteamsintree" AS "departments[6].includeteamsintree", "Agent"."departments[7].id" AS "departments[7].id", "Agent"."departments[7].agent_id" AS "departments[7].agent_id", "Agent"."departments[7].department_id" AS "departments[7].department_id", "Agent"."departments[7].role_id" AS "departments[7].role_id", "Agent"."departments[7].membershiplevel" AS "departments[7].membershiplevel", "Agent"."departments[7].includeteamsintree" AS "departments[7].includeteamsintree", "Agent"."departments[8].id" AS "departments[8].id", "Agent"."departments[8].agent_id" AS "departments[8].agent_id", "Agent"."departments[8].department_id" AS "departments[8].department_id", "Agent"."departments[8].role_id" AS "departments[8].role_id", "Agent"."departments[8].membershiplevel" AS "departments[8].membershiplevel", "Agent"."departments[8].includeteamsintree" AS "departments[8].includeteamsintree", "Agent"."departments[9].id" AS "departments[9].id", "Agent"."departments[9].agent_id" AS "departments[9].agent_id", "Agent"."departments[9].department_id" AS "departments[9].department_id", "Agent"."departments[9].role_id" AS "departments[9].role_id", "Agent"."departments[9].membershiplevel" AS "departments[9].membershiplevel", "Agent"."departments[9].includeteamsintree" AS "departments[9].includeteamsintree", "Agent"."departments[10].id" AS "departments[10].id", "Agent"."departments[10].agent_id" AS "departments[10].agent_id", "Agent"."departments[10].department_id" AS "departments[10].department_id", "Agent"."departments[10].role_id" AS "departments[10].role_id", "Agent"."departments[10].membershiplevel" AS "departments[10].membershiplevel", "Agent"."departments[10].includeteamsintree" AS "departments[10].includeteamsintree", "Agent"."departments[11].id" AS "departments[11].id", "Agent"."departments[11].agent_id" AS "departments[11].agent_id", "Agent"."departments[11].department_id" AS "departments[11].department_id", "Agent"."departments[11].role_id" AS "departments[11].role_id", "Agent"."departments[11].membershiplevel" AS "departments[11].membershiplevel", "Agent"."departments[11].includeteamsintree" AS "departments[11].includeteamsintree", "Address"."id" AS "id(Address)", "Address"."type" AS "type", "Address"."line1" AS "line1", "Address"."line2" AS "line2", "Address"."line3" AS "line3", "Address"."line4" AS "line4", "Address"."postcode" AS "postcode", "Address"."primary" AS "primary", "Address"."inactive" AS "inactive", "Address"."date_active" AS "date_active", "Address"."site_id" AS "site_id", "Address"."description" AS "description", "Address"."lat" AS "lat", "Address"."long" AS "long", "Address"."note" AS "note", "Application"."grant_type" AS "grant_type", "Application"."loginas_agent_id" AS "loginas_agent_id", "Application"."inactive" AS "inactive(Application)", "Application"."system_use" AS "system_use", "Application"."redirecturi" AS "redirecturi", "Application"."logoutredirecturi" AS "logoutredirecturi", "Application"."cors_whitelist" AS "cors_whitelist", "Application"."allowagents" AS "allowagents", "Application"."allowusers" AS "allowusers", "Application"."organisation_id" AS "organisation_id", "Application"."loginas_client_id" AS "loginas_client_id", "Application"."loginas_supplier_id" AS "loginas_supplier_id", "Application"."loginentity" AS "loginentity", "Application"."language_id" AS "language_id", "Application"."disable_windowsauth" AS "disable_windowsauth", "Application"."disable_azure" AS "disable_azure", "Application"."disable_adfs" AS "disable_adfs", "Application"."disable_okta" AS "disable_okta", "Application"."disable_centrify" AS "disable_centrify", "Application"."disable_google" AS "disable_google", "Application"."disable_anon" AS "disable_anon", "Application"."clientId" AS "clientId", "Application"."concurrencyToken" AS "concurrencyToken", "Application"."displayName" AS "displayName", "Application"."id" AS "id(Application)", "Application"."postLogoutRedirectUris" AS "postLogoutRedirectUris", "Application"."redirectUris" AS "redirectUris", "Application"."type" AS "type(Application)", "Application"."_issystem" AS "_issystem", "Currency"."id" AS "id(Currency)", "Currency"."name" AS "name(Currency)", "Currency"."symbol" AS "symbol", "Currency"."code" AS "code", "Currency"."conversion_rate" AS "conversion_rate", "Currency"."last_updated" AS "last_updated", "EmailTemplate"."id" AS "id(EmailTemplate)", "EmailTemplate"."guid" AS "guid", "EmailTemplate"."name" AS "name(EmailTemplate)", "EmailTemplate"."description" AS "description(EmailTemplate)", "EmailTemplate"."sectionid" AS "sectionid", "EmailTemplate"."header_text" AS "header_text", "EmailTemplate"."messagegroup_id" AS "messagegroup_id", "Team"."id" AS "id(Team)", "Team"."guid" AS "guid(Team)", "Team"."name" AS "name(Team)", "Team"."sequence" AS "sequence", "Team"."forrequests" AS "forrequests", "Team"."foropps" AS "foropps", "Team"."forprojects" AS "forprojects", "Team"."ticket_count" AS "ticket_count", "Team"."department_id" AS "department_id", "Team"."department_name" AS "department_name", "Team"."org_team_name" AS "org_team_name", "Team"."inactive" AS "inactive(Team)", "Team"."override_column_id" AS "override_column_id", "Team"."teamphotopath" AS "teamphotopath", "Team"."hide_agents_in_tree_if_no_tickets" AS "hide_agents_in_tree_if_no_tickets", "Team"."concurrent_lic_limit" AS "concurrent_lic_limit", "Team"."use" AS "use(Team)", "Team"."homescreendashboardid" AS "homescreendashboardid", "Tax"."id" AS "id(Tax)", "Tax"."name" AS "name(Tax)", "Tax"."code" AS "code(Tax)", "Tax"."value" AS "value", "Tax"."xero_tenant_id" AS "xero_tenant_id", "Tax"."xero_tenant_name" AS "xero_tenant_name", "Tax"."third_party_desc" AS "third_party_desc", "Tax"."is_composite" AS "is_composite", "Tax"."kashflow_tenant_id" AS "kashflow_tenant_id", "Tax"."kashflow_tenant_name" AS "kashflow_tenant_name", "Tax"."qbocode" AS "qbocode", "Tax"."qbocode_name" AS "qbocode_name", "Tax"."qbotaxcode.value" AS "qbotaxcode.value", "Tax"."qbotaxcode.label" AS "qbotaxcode.label", "Tax"."qbo_company_name" AS "qbo_company_name" FROM "halops_dash"."Agent" AS "Agent" INNER JOIN "halops_dash"."Address" AS "Address" ON "Agent"."id" = "Address"."id" INNER JOIN "halops_dash"."Application" AS "Application" ON "Address"."inactive" = "Application"."inactive" INNER JOIN "halops_dash"."Currency" AS "Currency" ON "Agent"."id" = "Currency"."id" INNER JOIN "halops_dash"."EmailTemplate" AS "EmailTemplate" ON "Agent"."id" = "EmailTemplate"."id" INNER JOIN "halops_dash"."Team" AS "Team" ON "Agent"."id" = "Team"."id" INNER JOIN "halops_dash"."Tax" AS "Tax" ON "Agent"."id" = "Tax"."id") temp_table ORDER BY "CNTD(id(Team))" ASC NULLS FIRST
'''

shft_q10 = '''SELECT COUNT(DISTINCT "clientId") AS "CNTD(clientId)" FROM (SELECT "Agent"."id" AS "id", "Agent"."name" AS "name", "Agent"."team" AS "team", "Agent"."isdisabled" AS "isdisabled", "Agent"."ad" AS "ad", "Agent"."agentphotopath" AS "agentphotopath", "Agent"."initials" AS "initials", "Agent"."firstname" AS "firstname", "Agent"."surname" AS "surname", "Agent"."colour" AS "colour", "Agent"."jobtitle" AS "jobtitle", "Agent"."sms" AS "sms", "Agent"."extensionnumber" AS "extensionnumber", "Agent"."is_agent" AS "is_agent", "Agent"."googleemail" AS "googleemail", "Agent"."linemanager" AS "linemanager", "Agent"."exchange_authorized" AS "exchange_authorized", "Agent"."exchange_account" AS "exchange_account", "Agent"."sentinel_authorized" AS "sentinel_authorized", "Agent"."licence_type" AS "licence_type", "Agent"."splashtop_authorized" AS "splashtop_authorized", "Agent"."gotoresolve_authorized" AS "gotoresolve_authorized", "Agent"."use" AS "use", "Agent"."logmeinid" AS "logmeinid", "Agent"."allowbeyondtrustinvites" AS "allowbeyondtrustinvites", "Agent"."jira_id" AS "jira_id", "Agent"."namewithinactive" AS "namewithinactive", "Agent"."apptsync" AS "apptsync", "Agent"."sendemailerrors" AS "sendemailerrors", "Agent"."can_approve_purchaseorder" AS "can_approve_purchaseorder", "Agent"."can_approve_quote" AS "can_approve_quote", "Agent"."can_approve_invoice" AS "can_approve_invoice", "Agent"."workday_id" AS "workday_id", "Agent"."costprice" AS "costprice", "Agent"."chargerate" AS "chargerate", "Agent"."email" AS "email", "Agent"."teams[0].id" AS "teams[0].id", "Agent"."teams[0].agent_id" AS "teams[0].agent_id", "Agent"."teams[0].team_id" AS "teams[0].team_id", "Agent"."teams[0].team_name" AS "teams[0].team_name", "Agent"."teams[0].department_id" AS "teams[0].department_id", "Agent"."teams[0].role_id" AS "teams[0].role_id", "Agent"."teams[0].is_manager" AS "teams[0].is_manager", "Agent"."teams[0].no_config_access" AS "teams[0].no_config_access", "Agent"."teams[0].unassigned_access" AS "teams[0].unassigned_access", "Agent"."teams[0].otheragent_access" AS "teams[0].otheragent_access", "Agent"."teams[0].fortickets" AS "teams[0].fortickets", "Agent"."teams[0].foropps" AS "teams[0].foropps", "Agent"."teams[0].forprojects" AS "teams[0].forprojects", "Agent"."teams[0].in_section" AS "teams[0].in_section", "Agent"."departments[0].id" AS "departments[0].id", "Agent"."departments[0].agent_id" AS "departments[0].agent_id", "Agent"."departments[0].department_id" AS "departments[0].department_id", "Agent"."departments[0].role_id" AS "departments[0].role_id", "Agent"."departments[0].membershiplevel" AS "departments[0].membershiplevel", "Agent"."departments[0].includeteamsintree" AS "departments[0].includeteamsintree", "Agent"."departments[1].id" AS "departments[1].id", "Agent"."departments[1].agent_id" AS "departments[1].agent_id", "Agent"."departments[1].department_id" AS "departments[1].department_id", "Agent"."departments[1].role_id" AS "departments[1].role_id", "Agent"."departments[1].membershiplevel" AS "departments[1].membershiplevel", "Agent"."departments[1].includeteamsintree" AS "departments[1].includeteamsintree", "Agent"."departments[2].id" AS "departments[2].id", "Agent"."departments[2].agent_id" AS "departments[2].agent_id", "Agent"."departments[2].department_id" AS "departments[2].department_id", "Agent"."departments[2].role_id" AS "departments[2].role_id", "Agent"."departments[2].membershiplevel" AS "departments[2].membershiplevel", "Agent"."departments[2].includeteamsintree" AS "departments[2].includeteamsintree", "Agent"."teams[1].id" AS "teams[1].id", "Agent"."teams[1].agent_id" AS "teams[1].agent_id", "Agent"."teams[1].team_id" AS "teams[1].team_id", "Agent"."teams[1].team_name" AS "teams[1].team_name", "Agent"."teams[1].department_id" AS "teams[1].department_id", "Agent"."teams[1].is_manager" AS "teams[1].is_manager", "Agent"."teams[1].no_config_access" AS "teams[1].no_config_access", "Agent"."teams[1].unassigned_access" AS "teams[1].unassigned_access", "Agent"."teams[1].otheragent_access" AS "teams[1].otheragent_access", "Agent"."teams[1].fortickets" AS "teams[1].fortickets", "Agent"."teams[1].foropps" AS "teams[1].foropps", "Agent"."teams[1].forprojects" AS "teams[1].forprojects", "Agent"."teams[1].in_section" AS "teams[1].in_section", "Agent"."teams[2].id" AS "teams[2].id", "Agent"."teams[2].agent_id" AS "teams[2].agent_id", "Agent"."teams[2].team_id" AS "teams[2].team_id", "Agent"."teams[2].team_name" AS "teams[2].team_name", "Agent"."teams[2].department_id" AS "teams[2].department_id", "Agent"."teams[2].role_id" AS "teams[2].role_id", "Agent"."teams[2].is_manager" AS "teams[2].is_manager", "Agent"."teams[2].no_config_access" AS "teams[2].no_config_access", "Agent"."teams[2].unassigned_access" AS "teams[2].unassigned_access", "Agent"."teams[2].otheragent_access" AS "teams[2].otheragent_access", "Agent"."teams[2].fortickets" AS "teams[2].fortickets", "Agent"."teams[2].foropps" AS "teams[2].foropps", "Agent"."teams[2].forprojects" AS "teams[2].forprojects", "Agent"."teams[2].in_section" AS "teams[2].in_section", "Agent"."teams[3].id" AS "teams[3].id", "Agent"."teams[3].agent_id" AS "teams[3].agent_id", "Agent"."teams[3].team_id" AS "teams[3].team_id", "Agent"."teams[3].team_name" AS "teams[3].team_name", "Agent"."teams[3].department_id" AS "teams[3].department_id", "Agent"."teams[3].role_id" AS "teams[3].role_id", "Agent"."teams[3].is_manager" AS "teams[3].is_manager", "Agent"."teams[3].no_config_access" AS "teams[3].no_config_access", "Agent"."teams[3].unassigned_access" AS "teams[3].unassigned_access", "Agent"."teams[3].otheragent_access" AS "teams[3].otheragent_access", "Agent"."teams[3].fortickets" AS "teams[3].fortickets", "Agent"."teams[3].foropps" AS "teams[3].foropps", "Agent"."teams[3].forprojects" AS "teams[3].forprojects", "Agent"."teams[3].in_section" AS "teams[3].in_section", "Agent"."teams[4].id" AS "teams[4].id", "Agent"."teams[4].agent_id" AS "teams[4].agent_id", "Agent"."teams[4].team_id" AS "teams[4].team_id", "Agent"."teams[4].team_name" AS "teams[4].team_name", "Agent"."teams[4].department_id" AS "teams[4].department_id", "Agent"."teams[4].role_id" AS "teams[4].role_id", "Agent"."teams[4].is_manager" AS "teams[4].is_manager", "Agent"."teams[4].no_config_access" AS "teams[4].no_config_access", "Agent"."teams[4].unassigned_access" AS "teams[4].unassigned_access", "Agent"."teams[4].otheragent_access" AS "teams[4].otheragent_access", "Agent"."teams[4].fortickets" AS "teams[4].fortickets", "Agent"."teams[4].foropps" AS "teams[4].foropps", "Agent"."teams[4].forprojects" AS "teams[4].forprojects", "Agent"."teams[4].in_section" AS "teams[4].in_section", "Agent"."departments[3].id" AS "departments[3].id", "Agent"."departments[3].agent_id" AS "departments[3].agent_id", "Agent"."departments[3].department_id" AS "departments[3].department_id", "Agent"."departments[3].role_id" AS "departments[3].role_id", "Agent"."departments[3].membershiplevel" AS "departments[3].membershiplevel", "Agent"."departments[3].includeteamsintree" AS "departments[3].includeteamsintree", "Agent"."departments[4].id" AS "departments[4].id", "Agent"."departments[4].agent_id" AS "departments[4].agent_id", "Agent"."departments[4].department_id" AS "departments[4].department_id", "Agent"."departments[4].role_id" AS "departments[4].role_id", "Agent"."departments[4].membershiplevel" AS "departments[4].membershiplevel", "Agent"."departments[4].includeteamsintree" AS "departments[4].includeteamsintree", "Agent"."departments[5].id" AS "departments[5].id", "Agent"."departments[5].agent_id" AS "departments[5].agent_id", "Agent"."departments[5].department_id" AS "departments[5].department_id", "Agent"."departments[5].role_id" AS "departments[5].role_id", "Agent"."departments[5].membershiplevel" AS "departments[5].membershiplevel", "Agent"."departments[5].includeteamsintree" AS "departments[5].includeteamsintree", "Agent"."teams[1].role_id" AS "teams[1].role_id", "Agent"."lastlogindate" AS "lastlogindate", "Agent"."teams[5].id" AS "teams[5].id", "Agent"."teams[5].agent_id" AS "teams[5].agent_id", "Agent"."teams[5].team_id" AS "teams[5].team_id", "Agent"."teams[5].team_name" AS "teams[5].team_name", "Agent"."teams[5].department_id" AS "teams[5].department_id", "Agent"."teams[5].is_manager" AS "teams[5].is_manager", "Agent"."teams[5].no_config_access" AS "teams[5].no_config_access", "Agent"."teams[5].unassigned_access" AS "teams[5].unassigned_access", "Agent"."teams[5].otheragent_access" AS "teams[5].otheragent_access", "Agent"."teams[5].fortickets" AS "teams[5].fortickets", "Agent"."teams[5].foropps" AS "teams[5].foropps", "Agent"."teams[5].forprojects" AS "teams[5].forprojects", "Agent"."teams[5].in_section" AS "teams[5].in_section", "Agent"."teams[6].id" AS "teams[6].id", "Agent"."teams[6].agent_id" AS "teams[6].agent_id", "Agent"."teams[6].team_id" AS "teams[6].team_id", "Agent"."teams[6].team_name" AS "teams[6].team_name", "Agent"."teams[6].department_id" AS "teams[6].department_id", "Agent"."teams[6].role_id" AS "teams[6].role_id", "Agent"."teams[6].is_manager" AS "teams[6].is_manager", "Agent"."teams[6].no_config_access" AS "teams[6].no_config_access", "Agent"."teams[6].unassigned_access" AS "teams[6].unassigned_access", "Agent"."teams[6].otheragent_access" AS "teams[6].otheragent_access", "Agent"."teams[6].fortickets" AS "teams[6].fortickets", "Agent"."teams[6].foropps" AS "teams[6].foropps", "Agent"."teams[6].forprojects" AS "teams[6].forprojects", "Agent"."teams[6].in_section" AS "teams[6].in_section", "Agent"."teams[7].id" AS "teams[7].id", "Agent"."teams[7].agent_id" AS "teams[7].agent_id", "Agent"."teams[7].team_id" AS "teams[7].team_id", "Agent"."teams[7].team_name" AS "teams[7].team_name", "Agent"."teams[7].department_id" AS "teams[7].department_id", "Agent"."teams[7].role_id" AS "teams[7].role_id", "Agent"."teams[7].is_manager" AS "teams[7].is_manager", "Agent"."teams[7].no_config_access" AS "teams[7].no_config_access", "Agent"."teams[7].unassigned_access" AS "teams[7].unassigned_access", "Agent"."teams[7].otheragent_access" AS "teams[7].otheragent_access", "Agent"."teams[7].fortickets" AS "teams[7].fortickets", "Agent"."teams[7].foropps" AS "teams[7].foropps", "Agent"."teams[7].forprojects" AS "teams[7].forprojects", "Agent"."teams[7].in_section" AS "teams[7].in_section", "Agent"."departments[6].id" AS "departments[6].id", "Agent"."departments[6].agent_id" AS "departments[6].agent_id", "Agent"."departments[6].department_id" AS "departments[6].department_id", "Agent"."departments[6].role_id" AS "departments[6].role_id", "Agent"."departments[6].membershiplevel" AS "departments[6].membershiplevel", "Agent"."departments[6].includeteamsintree" AS "departments[6].includeteamsintree", "Agent"."departments[7].id" AS "departments[7].id", "Agent"."departments[7].agent_id" AS "departments[7].agent_id", "Agent"."departments[7].department_id" AS "departments[7].department_id", "Agent"."departments[7].role_id" AS "departments[7].role_id", "Agent"."departments[7].membershiplevel" AS "departments[7].membershiplevel", "Agent"."departments[7].includeteamsintree" AS "departments[7].includeteamsintree", "Agent"."departments[8].id" AS "departments[8].id", "Agent"."departments[8].agent_id" AS "departments[8].agent_id", "Agent"."departments[8].department_id" AS "departments[8].department_id", "Agent"."departments[8].role_id" AS "departments[8].role_id", "Agent"."departments[8].membershiplevel" AS "departments[8].membershiplevel", "Agent"."departments[8].includeteamsintree" AS "departments[8].includeteamsintree", "Agent"."departments[9].id" AS "departments[9].id", "Agent"."departments[9].agent_id" AS "departments[9].agent_id", "Agent"."departments[9].department_id" AS "departments[9].department_id", "Agent"."departments[9].role_id" AS "departments[9].role_id", "Agent"."departments[9].membershiplevel" AS "departments[9].membershiplevel", "Agent"."departments[9].includeteamsintree" AS "departments[9].includeteamsintree", "Agent"."departments[10].id" AS "departments[10].id", "Agent"."departments[10].agent_id" AS "departments[10].agent_id", "Agent"."departments[10].department_id" AS "departments[10].department_id", "Agent"."departments[10].role_id" AS "departments[10].role_id", "Agent"."departments[10].membershiplevel" AS "departments[10].membershiplevel", "Agent"."departments[10].includeteamsintree" AS "departments[10].includeteamsintree", "Agent"."departments[11].id" AS "departments[11].id", "Agent"."departments[11].agent_id" AS "departments[11].agent_id", "Agent"."departments[11].department_id" AS "departments[11].department_id", "Agent"."departments[11].role_id" AS "departments[11].role_id", "Agent"."departments[11].membershiplevel" AS "departments[11].membershiplevel", "Agent"."departments[11].includeteamsintree" AS "departments[11].includeteamsintree", "Address"."id" AS "id(Address)", "Address"."type" AS "type", "Address"."line1" AS "line1", "Address"."line2" AS "line2", "Address"."line3" AS "line3", "Address"."line4" AS "line4", "Address"."postcode" AS "postcode", "Address"."primary" AS "primary", "Address"."inactive" AS "inactive", "Address"."date_active" AS "date_active", "Address"."site_id" AS "site_id", "Address"."description" AS "description", "Address"."lat" AS "lat", "Address"."long" AS "long", "Address"."note" AS "note", "Application"."grant_type" AS "grant_type", "Application"."loginas_agent_id" AS "loginas_agent_id", "Application"."inactive" AS "inactive(Application)", "Application"."system_use" AS "system_use", "Application"."redirecturi" AS "redirecturi", "Application"."logoutredirecturi" AS "logoutredirecturi", "Application"."cors_whitelist" AS "cors_whitelist", "Application"."allowagents" AS "allowagents", "Application"."allowusers" AS "allowusers", "Application"."organisation_id" AS "organisation_id", "Application"."loginas_client_id" AS "loginas_client_id", "Application"."loginas_supplier_id" AS "loginas_supplier_id", "Application"."loginentity" AS "loginentity", "Application"."language_id" AS "language_id", "Application"."disable_windowsauth" AS "disable_windowsauth", "Application"."disable_azure" AS "disable_azure", "Application"."disable_adfs" AS "disable_adfs", "Application"."disable_okta" AS "disable_okta", "Application"."disable_centrify" AS "disable_centrify", "Application"."disable_google" AS "disable_google", "Application"."disable_anon" AS "disable_anon", "Application"."clientId" AS "clientId", "Application"."concurrencyToken" AS "concurrencyToken", "Application"."displayName" AS "displayName", "Application"."id" AS "id(Application)", "Application"."postLogoutRedirectUris" AS "postLogoutRedirectUris", "Application"."redirectUris" AS "redirectUris", "Application"."type" AS "type(Application)", "Application"."_issystem" AS "_issystem", "Currency"."id" AS "id(Currency)", "Currency"."name" AS "name(Currency)", "Currency"."symbol" AS "symbol", "Currency"."code" AS "code", "Currency"."conversion_rate" AS "conversion_rate", "Currency"."last_updated" AS "last_updated", "EmailTemplate"."id" AS "id(EmailTemplate)", "EmailTemplate"."guid" AS "guid", "EmailTemplate"."name" AS "name(EmailTemplate)", "EmailTemplate"."description" AS "description(EmailTemplate)", "EmailTemplate"."sectionid" AS "sectionid", "EmailTemplate"."header_text" AS "header_text", "EmailTemplate"."messagegroup_id" AS "messagegroup_id", "Team"."id" AS "id(Team)", "Team"."guid" AS "guid(Team)", "Team"."name" AS "name(Team)", "Team"."sequence" AS "sequence", "Team"."forrequests" AS "forrequests", "Team"."foropps" AS "foropps", "Team"."forprojects" AS "forprojects", "Team"."ticket_count" AS "ticket_count", "Team"."department_id" AS "department_id", "Team"."department_name" AS "department_name", "Team"."org_team_name" AS "org_team_name", "Team"."inactive" AS "inactive(Team)", "Team"."override_column_id" AS "override_column_id", "Team"."teamphotopath" AS "teamphotopath", "Team"."hide_agents_in_tree_if_no_tickets" AS "hide_agents_in_tree_if_no_tickets", "Team"."concurrent_lic_limit" AS "concurrent_lic_limit", "Team"."use" AS "use(Team)", "Team"."homescreendashboardid" AS "homescreendashboardid", "Tax"."id" AS "id(Tax)", "Tax"."name" AS "name(Tax)", "Tax"."code" AS "code(Tax)", "Tax"."value" AS "value", "Tax"."xero_tenant_id" AS "xero_tenant_id", "Tax"."xero_tenant_name" AS "xero_tenant_name", "Tax"."third_party_desc" AS "third_party_desc", "Tax"."is_composite" AS "is_composite", "Tax"."kashflow_tenant_id" AS "kashflow_tenant_id", "Tax"."kashflow_tenant_name" AS "kashflow_tenant_name", "Tax"."qbocode" AS "qbocode", "Tax"."qbocode_name" AS "qbocode_name", "Tax"."qbotaxcode.value" AS "qbotaxcode.value", "Tax"."qbotaxcode.label" AS "qbotaxcode.label", "Tax"."qbo_company_name" AS "qbo_company_name" FROM "halops_dash"."Agent" AS "Agent" INNER JOIN "halops_dash"."Address" AS "Address" ON "Agent"."id" = "Address"."id" INNER JOIN "halops_dash"."Application" AS "Application" ON "Address"."inactive" = "Application"."inactive" INNER JOIN "halops_dash"."Currency" AS "Currency" ON "Agent"."id" = "Currency"."id" INNER JOIN "halops_dash"."EmailTemplate" AS "EmailTemplate" ON "Agent"."id" = "EmailTemplate"."id" INNER JOIN "halops_dash"."Team" AS "Team" ON "Agent"."id" = "Team"."id" INNER JOIN "halops_dash"."Tax" AS "Tax" ON "Agent"."id" = "Tax"."id") temp_table ORDER BY "CNTD(clientId)" ASC NULLS FIRST
'''

shft_q11 = '''SELECT COUNT(DISTINCT "id") AS "CNTD(id)" FROM (SELECT "Agent"."id" AS "id", "Agent"."name" AS "name", "Agent"."team" AS "team", "Agent"."isdisabled" AS "isdisabled", "Agent"."ad" AS "ad", "Agent"."agentphotopath" AS "agentphotopath", "Agent"."initials" AS "initials", "Agent"."firstname" AS "firstname", "Agent"."surname" AS "surname", "Agent"."colour" AS "colour", "Agent"."jobtitle" AS "jobtitle", "Agent"."sms" AS "sms", "Agent"."extensionnumber" AS "extensionnumber", "Agent"."is_agent" AS "is_agent", "Agent"."googleemail" AS "googleemail", "Agent"."linemanager" AS "linemanager", "Agent"."exchange_authorized" AS "exchange_authorized", "Agent"."exchange_account" AS "exchange_account", "Agent"."sentinel_authorized" AS "sentinel_authorized", "Agent"."licence_type" AS "licence_type", "Agent"."splashtop_authorized" AS "splashtop_authorized", "Agent"."gotoresolve_authorized" AS "gotoresolve_authorized", "Agent"."use" AS "use", "Agent"."logmeinid" AS "logmeinid", "Agent"."allowbeyondtrustinvites" AS "allowbeyondtrustinvites", "Agent"."jira_id" AS "jira_id", "Agent"."namewithinactive" AS "namewithinactive", "Agent"."apptsync" AS "apptsync", "Agent"."sendemailerrors" AS "sendemailerrors", "Agent"."can_approve_purchaseorder" AS "can_approve_purchaseorder", "Agent"."can_approve_quote" AS "can_approve_quote", "Agent"."can_approve_invoice" AS "can_approve_invoice", "Agent"."workday_id" AS "workday_id", "Agent"."costprice" AS "costprice", "Agent"."chargerate" AS "chargerate", "Agent"."email" AS "email", "Agent"."teams[0].id" AS "teams[0].id", "Agent"."teams[0].agent_id" AS "teams[0].agent_id", "Agent"."teams[0].team_id" AS "teams[0].team_id", "Agent"."teams[0].team_name" AS "teams[0].team_name", "Agent"."teams[0].department_id" AS "teams[0].department_id", "Agent"."teams[0].role_id" AS "teams[0].role_id", "Agent"."teams[0].is_manager" AS "teams[0].is_manager", "Agent"."teams[0].no_config_access" AS "teams[0].no_config_access", "Agent"."teams[0].unassigned_access" AS "teams[0].unassigned_access", "Agent"."teams[0].otheragent_access" AS "teams[0].otheragent_access", "Agent"."teams[0].fortickets" AS "teams[0].fortickets", "Agent"."teams[0].foropps" AS "teams[0].foropps", "Agent"."teams[0].forprojects" AS "teams[0].forprojects", "Agent"."teams[0].in_section" AS "teams[0].in_section", "Agent"."departments[0].id" AS "departments[0].id", "Agent"."departments[0].agent_id" AS "departments[0].agent_id", "Agent"."departments[0].department_id" AS "departments[0].department_id", "Agent"."departments[0].role_id" AS "departments[0].role_id", "Agent"."departments[0].membershiplevel" AS "departments[0].membershiplevel", "Agent"."departments[0].includeteamsintree" AS "departments[0].includeteamsintree", "Agent"."departments[1].id" AS "departments[1].id", "Agent"."departments[1].agent_id" AS "departments[1].agent_id", "Agent"."departments[1].department_id" AS "departments[1].department_id", "Agent"."departments[1].role_id" AS "departments[1].role_id", "Agent"."departments[1].membershiplevel" AS "departments[1].membershiplevel", "Agent"."departments[1].includeteamsintree" AS "departments[1].includeteamsintree", "Agent"."departments[2].id" AS "departments[2].id", "Agent"."departments[2].agent_id" AS "departments[2].agent_id", "Agent"."departments[2].department_id" AS "departments[2].department_id", "Agent"."departments[2].role_id" AS "departments[2].role_id", "Agent"."departments[2].membershiplevel" AS "departments[2].membershiplevel", "Agent"."departments[2].includeteamsintree" AS "departments[2].includeteamsintree", "Agent"."teams[1].id" AS "teams[1].id", "Agent"."teams[1].agent_id" AS "teams[1].agent_id", "Agent"."teams[1].team_id" AS "teams[1].team_id", "Agent"."teams[1].team_name" AS "teams[1].team_name", "Agent"."teams[1].department_id" AS "teams[1].department_id", "Agent"."teams[1].is_manager" AS "teams[1].is_manager", "Agent"."teams[1].no_config_access" AS "teams[1].no_config_access", "Agent"."teams[1].unassigned_access" AS "teams[1].unassigned_access", "Agent"."teams[1].otheragent_access" AS "teams[1].otheragent_access", "Agent"."teams[1].fortickets" AS "teams[1].fortickets", "Agent"."teams[1].foropps" AS "teams[1].foropps", "Agent"."teams[1].forprojects" AS "teams[1].forprojects", "Agent"."teams[1].in_section" AS "teams[1].in_section", "Agent"."teams[2].id" AS "teams[2].id", "Agent"."teams[2].agent_id" AS "teams[2].agent_id", "Agent"."teams[2].team_id" AS "teams[2].team_id", "Agent"."teams[2].team_name" AS "teams[2].team_name", "Agent"."teams[2].department_id" AS "teams[2].department_id", "Agent"."teams[2].role_id" AS "teams[2].role_id", "Agent"."teams[2].is_manager" AS "teams[2].is_manager", "Agent"."teams[2].no_config_access" AS "teams[2].no_config_access", "Agent"."teams[2].unassigned_access" AS "teams[2].unassigned_access", "Agent"."teams[2].otheragent_access" AS "teams[2].otheragent_access", "Agent"."teams[2].fortickets" AS "teams[2].fortickets", "Agent"."teams[2].foropps" AS "teams[2].foropps", "Agent"."teams[2].forprojects" AS "teams[2].forprojects", "Agent"."teams[2].in_section" AS "teams[2].in_section", "Agent"."teams[3].id" AS "teams[3].id", "Agent"."teams[3].agent_id" AS "teams[3].agent_id", "Agent"."teams[3].team_id" AS "teams[3].team_id", "Agent"."teams[3].team_name" AS "teams[3].team_name", "Agent"."teams[3].department_id" AS "teams[3].department_id", "Agent"."teams[3].role_id" AS "teams[3].role_id", "Agent"."teams[3].is_manager" AS "teams[3].is_manager", "Agent"."teams[3].no_config_access" AS "teams[3].no_config_access", "Agent"."teams[3].unassigned_access" AS "teams[3].unassigned_access", "Agent"."teams[3].otheragent_access" AS "teams[3].otheragent_access", "Agent"."teams[3].fortickets" AS "teams[3].fortickets", "Agent"."teams[3].foropps" AS "teams[3].foropps", "Agent"."teams[3].forprojects" AS "teams[3].forprojects", "Agent"."teams[3].in_section" AS "teams[3].in_section", "Agent"."teams[4].id" AS "teams[4].id", "Agent"."teams[4].agent_id" AS "teams[4].agent_id", "Agent"."teams[4].team_id" AS "teams[4].team_id", "Agent"."teams[4].team_name" AS "teams[4].team_name", "Agent"."teams[4].department_id" AS "teams[4].department_id", "Agent"."teams[4].role_id" AS "teams[4].role_id", "Agent"."teams[4].is_manager" AS "teams[4].is_manager", "Agent"."teams[4].no_config_access" AS "teams[4].no_config_access", "Agent"."teams[4].unassigned_access" AS "teams[4].unassigned_access", "Agent"."teams[4].otheragent_access" AS "teams[4].otheragent_access", "Agent"."teams[4].fortickets" AS "teams[4].fortickets", "Agent"."teams[4].foropps" AS "teams[4].foropps", "Agent"."teams[4].forprojects" AS "teams[4].forprojects", "Agent"."teams[4].in_section" AS "teams[4].in_section", "Agent"."departments[3].id" AS "departments[3].id", "Agent"."departments[3].agent_id" AS "departments[3].agent_id", "Agent"."departments[3].department_id" AS "departments[3].department_id", "Agent"."departments[3].role_id" AS "departments[3].role_id", "Agent"."departments[3].membershiplevel" AS "departments[3].membershiplevel", "Agent"."departments[3].includeteamsintree" AS "departments[3].includeteamsintree", "Agent"."departments[4].id" AS "departments[4].id", "Agent"."departments[4].agent_id" AS "departments[4].agent_id", "Agent"."departments[4].department_id" AS "departments[4].department_id", "Agent"."departments[4].role_id" AS "departments[4].role_id", "Agent"."departments[4].membershiplevel" AS "departments[4].membershiplevel", "Agent"."departments[4].includeteamsintree" AS "departments[4].includeteamsintree", "Agent"."departments[5].id" AS "departments[5].id", "Agent"."departments[5].agent_id" AS "departments[5].agent_id", "Agent"."departments[5].department_id" AS "departments[5].department_id", "Agent"."departments[5].role_id" AS "departments[5].role_id", "Agent"."departments[5].membershiplevel" AS "departments[5].membershiplevel", "Agent"."departments[5].includeteamsintree" AS "departments[5].includeteamsintree", "Agent"."teams[1].role_id" AS "teams[1].role_id", "Agent"."lastlogindate" AS "lastlogindate", "Agent"."teams[5].id" AS "teams[5].id", "Agent"."teams[5].agent_id" AS "teams[5].agent_id", "Agent"."teams[5].team_id" AS "teams[5].team_id", "Agent"."teams[5].team_name" AS "teams[5].team_name", "Agent"."teams[5].department_id" AS "teams[5].department_id", "Agent"."teams[5].is_manager" AS "teams[5].is_manager", "Agent"."teams[5].no_config_access" AS "teams[5].no_config_access", "Agent"."teams[5].unassigned_access" AS "teams[5].unassigned_access", "Agent"."teams[5].otheragent_access" AS "teams[5].otheragent_access", "Agent"."teams[5].fortickets" AS "teams[5].fortickets", "Agent"."teams[5].foropps" AS "teams[5].foropps", "Agent"."teams[5].forprojects" AS "teams[5].forprojects", "Agent"."teams[5].in_section" AS "teams[5].in_section", "Agent"."teams[6].id" AS "teams[6].id", "Agent"."teams[6].agent_id" AS "teams[6].agent_id", "Agent"."teams[6].team_id" AS "teams[6].team_id", "Agent"."teams[6].team_name" AS "teams[6].team_name", "Agent"."teams[6].department_id" AS "teams[6].department_id", "Agent"."teams[6].role_id" AS "teams[6].role_id", "Agent"."teams[6].is_manager" AS "teams[6].is_manager", "Agent"."teams[6].no_config_access" AS "teams[6].no_config_access", "Agent"."teams[6].unassigned_access" AS "teams[6].unassigned_access", "Agent"."teams[6].otheragent_access" AS "teams[6].otheragent_access", "Agent"."teams[6].fortickets" AS "teams[6].fortickets", "Agent"."teams[6].foropps" AS "teams[6].foropps", "Agent"."teams[6].forprojects" AS "teams[6].forprojects", "Agent"."teams[6].in_section" AS "teams[6].in_section", "Agent"."teams[7].id" AS "teams[7].id", "Agent"."teams[7].agent_id" AS "teams[7].agent_id", "Agent"."teams[7].team_id" AS "teams[7].team_id", "Agent"."teams[7].team_name" AS "teams[7].team_name", "Agent"."teams[7].department_id" AS "teams[7].department_id", "Agent"."teams[7].role_id" AS "teams[7].role_id", "Agent"."teams[7].is_manager" AS "teams[7].is_manager", "Agent"."teams[7].no_config_access" AS "teams[7].no_config_access", "Agent"."teams[7].unassigned_access" AS "teams[7].unassigned_access", "Agent"."teams[7].otheragent_access" AS "teams[7].otheragent_access", "Agent"."teams[7].fortickets" AS "teams[7].fortickets", "Agent"."teams[7].foropps" AS "teams[7].foropps", "Agent"."teams[7].forprojects" AS "teams[7].forprojects", "Agent"."teams[7].in_section" AS "teams[7].in_section", "Agent"."departments[6].id" AS "departments[6].id", "Agent"."departments[6].agent_id" AS "departments[6].agent_id", "Agent"."departments[6].department_id" AS "departments[6].department_id", "Agent"."departments[6].role_id" AS "departments[6].role_id", "Agent"."departments[6].membershiplevel" AS "departments[6].membershiplevel", "Agent"."departments[6].includeteamsintree" AS "departments[6].includeteamsintree", "Agent"."departments[7].id" AS "departments[7].id", "Agent"."departments[7].agent_id" AS "departments[7].agent_id", "Agent"."departments[7].department_id" AS "departments[7].department_id", "Agent"."departments[7].role_id" AS "departments[7].role_id", "Agent"."departments[7].membershiplevel" AS "departments[7].membershiplevel", "Agent"."departments[7].includeteamsintree" AS "departments[7].includeteamsintree", "Agent"."departments[8].id" AS "departments[8].id", "Agent"."departments[8].agent_id" AS "departments[8].agent_id", "Agent"."departments[8].department_id" AS "departments[8].department_id", "Agent"."departments[8].role_id" AS "departments[8].role_id", "Agent"."departments[8].membershiplevel" AS "departments[8].membershiplevel", "Agent"."departments[8].includeteamsintree" AS "departments[8].includeteamsintree", "Agent"."departments[9].id" AS "departments[9].id", "Agent"."departments[9].agent_id" AS "departments[9].agent_id", "Agent"."departments[9].department_id" AS "departments[9].department_id", "Agent"."departments[9].role_id" AS "departments[9].role_id", "Agent"."departments[9].membershiplevel" AS "departments[9].membershiplevel", "Agent"."departments[9].includeteamsintree" AS "departments[9].includeteamsintree", "Agent"."departments[10].id" AS "departments[10].id", "Agent"."departments[10].agent_id" AS "departments[10].agent_id", "Agent"."departments[10].department_id" AS "departments[10].department_id", "Agent"."departments[10].role_id" AS "departments[10].role_id", "Agent"."departments[10].membershiplevel" AS "departments[10].membershiplevel", "Agent"."departments[10].includeteamsintree" AS "departments[10].includeteamsintree", "Agent"."departments[11].id" AS "departments[11].id", "Agent"."departments[11].agent_id" AS "departments[11].agent_id", "Agent"."departments[11].department_id" AS "departments[11].department_id", "Agent"."departments[11].role_id" AS "departments[11].role_id", "Agent"."departments[11].membershiplevel" AS "departments[11].membershiplevel", "Agent"."departments[11].includeteamsintree" AS "departments[11].includeteamsintree", "Address"."id" AS "id(Address)", "Address"."type" AS "type", "Address"."line1" AS "line1", "Address"."line2" AS "line2", "Address"."line3" AS "line3", "Address"."line4" AS "line4", "Address"."postcode" AS "postcode", "Address"."primary" AS "primary", "Address"."inactive" AS "inactive", "Address"."date_active" AS "date_active", "Address"."site_id" AS "site_id", "Address"."description" AS "description", "Address"."lat" AS "lat", "Address"."long" AS "long", "Address"."note" AS "note", "Application"."grant_type" AS "grant_type", "Application"."loginas_agent_id" AS "loginas_agent_id", "Application"."inactive" AS "inactive(Application)", "Application"."system_use" AS "system_use", "Application"."redirecturi" AS "redirecturi", "Application"."logoutredirecturi" AS "logoutredirecturi", "Application"."cors_whitelist" AS "cors_whitelist", "Application"."allowagents" AS "allowagents", "Application"."allowusers" AS "allowusers", "Application"."organisation_id" AS "organisation_id", "Application"."loginas_client_id" AS "loginas_client_id", "Application"."loginas_supplier_id" AS "loginas_supplier_id", "Application"."loginentity" AS "loginentity", "Application"."language_id" AS "language_id", "Application"."disable_windowsauth" AS "disable_windowsauth", "Application"."disable_azure" AS "disable_azure", "Application"."disable_adfs" AS "disable_adfs", "Application"."disable_okta" AS "disable_okta", "Application"."disable_centrify" AS "disable_centrify", "Application"."disable_google" AS "disable_google", "Application"."disable_anon" AS "disable_anon", "Application"."clientId" AS "clientId", "Application"."concurrencyToken" AS "concurrencyToken", "Application"."displayName" AS "displayName", "Application"."id" AS "id(Application)", "Application"."postLogoutRedirectUris" AS "postLogoutRedirectUris", "Application"."redirectUris" AS "redirectUris", "Application"."type" AS "type(Application)", "Application"."_issystem" AS "_issystem", "Currency"."id" AS "id(Currency)", "Currency"."name" AS "name(Currency)", "Currency"."symbol" AS "symbol", "Currency"."code" AS "code", "Currency"."conversion_rate" AS "conversion_rate", "Currency"."last_updated" AS "last_updated", "EmailTemplate"."id" AS "id(EmailTemplate)", "EmailTemplate"."guid" AS "guid", "EmailTemplate"."name" AS "name(EmailTemplate)", "EmailTemplate"."description" AS "description(EmailTemplate)", "EmailTemplate"."sectionid" AS "sectionid", "EmailTemplate"."header_text" AS "header_text", "EmailTemplate"."messagegroup_id" AS "messagegroup_id", "Team"."id" AS "id(Team)", "Team"."guid" AS "guid(Team)", "Team"."name" AS "name(Team)", "Team"."sequence" AS "sequence", "Team"."forrequests" AS "forrequests", "Team"."foropps" AS "foropps", "Team"."forprojects" AS "forprojects", "Team"."ticket_count" AS "ticket_count", "Team"."department_id" AS "department_id", "Team"."department_name" AS "department_name", "Team"."org_team_name" AS "org_team_name", "Team"."inactive" AS "inactive(Team)", "Team"."override_column_id" AS "override_column_id", "Team"."teamphotopath" AS "teamphotopath", "Team"."hide_agents_in_tree_if_no_tickets" AS "hide_agents_in_tree_if_no_tickets", "Team"."concurrent_lic_limit" AS "concurrent_lic_limit", "Team"."use" AS "use(Team)", "Team"."homescreendashboardid" AS "homescreendashboardid", "Tax"."id" AS "id(Tax)", "Tax"."name" AS "name(Tax)", "Tax"."code" AS "code(Tax)", "Tax"."value" AS "value", "Tax"."xero_tenant_id" AS "xero_tenant_id", "Tax"."xero_tenant_name" AS "xero_tenant_name", "Tax"."third_party_desc" AS "third_party_desc", "Tax"."is_composite" AS "is_composite", "Tax"."kashflow_tenant_id" AS "kashflow_tenant_id", "Tax"."kashflow_tenant_name" AS "kashflow_tenant_name", "Tax"."qbocode" AS "qbocode", "Tax"."qbocode_name" AS "qbocode_name", "Tax"."qbotaxcode.value" AS "qbotaxcode.value", "Tax"."qbotaxcode.label" AS "qbotaxcode.label", "Tax"."qbo_company_name" AS "qbo_company_name" FROM "halops_dash"."Agent" AS "Agent" INNER JOIN "halops_dash"."Address" AS "Address" ON "Agent"."id" = "Address"."id" INNER JOIN "halops_dash"."Application" AS "Application" ON "Address"."inactive" = "Application"."inactive" INNER JOIN "halops_dash"."Currency" AS "Currency" ON "Agent"."id" = "Currency"."id" INNER JOIN "halops_dash"."EmailTemplate" AS "EmailTemplate" ON "Agent"."id" = "EmailTemplate"."id" INNER JOIN "halops_dash"."Team" AS "Team" ON "Agent"."id" = "Team"."id" INNER JOIN "halops_dash"."Tax" AS "Tax" ON "Agent"."id" = "Tax"."id") temp_table ORDER BY "CNTD(id)" ASC NULLS FIRST
'''

def query_form(tok1,hierarchy_id,display_name):
    table_names=[[f'{display_name}', 'Agent', 'Agent'], [f'{display_name}', 'Address', 'Address'], [f'{display_name}', 'Application', 'Application'], [f'{display_name}', 'Currency', 'Currency'], [f'{display_name}', 'EmailTemplate', 'EmailTemplate'], [f'{display_name}', 'Team', 'Team'], [f'{display_name}', 'Tax', 'Tax']]
    # updated_data = [[(display_name if element == 'display_name' else element) for element in sublist] for sublist in table_names]
    quer_tb=dshb_models.QuerySets.objects.create(
        user_id=tok1['user_id'],
        hierarchy_id=hierarchy_id,
        table_names=table_names,
        join_type=['inner', 'inner', 'inner', 'inner', 'inner', 'inner'],
        joining_conditions=[[{'table1': 'Agent', 'firstcolumn': 'id', 'operator': '=', 'secondcolumn': 'id', 'table2': 'Address'}], [{'table1': 'Address', 'firstcolumn': 'inactive', 'operator': '=', 'secondcolumn': 'inactive', 'table2': 'Application'}], [{'table1': 'Agent', 'firstcolumn': 'id', 'operator': '=', 'secondcolumn': 'id', 'table2': 'Currency'}], [{'table1': 'Agent', 'firstcolumn': 'id', 'operator': '=', 'secondcolumn': 'id', 'table2': 'EmailTemplate'}], [{'table1': 'Agent', 'firstcolumn': 'id', 'operator': '=', 'secondcolumn': 'id', 'table2': 'Team'}], [{'table1': 'Agent', 'firstcolumn': 'id', 'operator': '=', 'secondcolumn': 'id', 'table2': 'Tax'}], []],
        is_custom_sql=False,
        custom_query = query_table.replace('"', '\\"').replace('halops_dash',f'{display_name}'),
        query_name="template_halops_query",
        created_at=datetime.datetime.now(),
        updated_at=datetime.datetime.now(),
        is_sample=False,
        datasource_path=None,
        datasource_json=None
    )
    quer_tb.save()
    return quer_tb


def sheets_list(queryset_id,tok1,hierarchy_id,display_name):
    sheetFilterQuerySetData=[
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "department_name"', ' "value"', ' "email"', ' "displayName"', ' "jira_id"', ' "line1"', ' "line2"', ' "postcode"'],
            "rows": [],
            # "custom_query": shft_q1.replace('"','\\"'),
            "custom_query" : shft_q1.replace('"','\\"').replace('halops_dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "displayName"'],
            "rows": ['"sum(value)"', '"sum(conversion_rate)"'],
            "custom_query": shft_q2.replace('"','\\"').replace('halops_dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "displayName"'],
            "rows": ['"count(id(EmailTemplate))"'],
            "custom_query": shft_q3.replace('"','\\"').replace('halops_dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "name(Team)"'],
            "rows": ['"count(id)"'],
            "custom_query": shft_q4.replace('"','\\"').replace('halops_dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "department_name"'],
            "rows": [' "CNTD(id(Team))"'],
            "custom_query": shft_q5.replace('"','\\"').replace('halops_dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": ['"sum(value)"'],
            "custom_query": shft_q6.replace('"','\\"').replace('halops_dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": [' "CNTD(inactive(Application))"'],
            "custom_query": shft_q7.replace('"','\\"').replace('halops_dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": [' "CNTD(organisation_id)"'],
            "custom_query": shft_q8.replace('"','\\"').replace('halops_dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": [' "CNTD(id(Team))"'],
            "custom_query": shft_q9.replace('"','\\"').replace('halops_dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": [' "CNTD(clientId)"'],
            "custom_query": shft_q10.replace('"','\\"').replace('halops_dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": [' "CNTD(id)"'],
            "custom_query": shft_q11.replace('"','\\"').replace('halops_dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
    ]
    try:
        for entry in sheetFilterQuerySetData:
            sheetfilter_table_create=dshb_models.SheetFilter_querysets.objects.create(
                datasource_querysetid=int(entry.get("datasource_querysetid") or 0) if entry.get("datasource_querysetid") else None,
                queryset_id=int(entry.get("queryset_id") or 0) if entry.get("queryset_id") else None,
                user_id=entry.get("user_id"),
                hierarchy_id=int(entry.get("hierarchy_id") or 0) if entry.get("hierarchy_id") else None,
                filter_id_list=json.dumps(entry.get("filter_id_list", [])),
                columns=json.dumps(entry.get("columns", [])),
                rows=json.dumps(entry.get("rows", [])),
                custom_query=entry.get("custom_query"),
                created_at=entry.get("created_at", datetime.datetime.now()),
                updated_at=entry.get("updated_at", datetime.datetime.now()),
            )
            sheetfilter_table_create.save()
        # self.stdout.write(self.style.SUCCESS('Successfully imported data into SheetFilter QuerySet'))
    except Exception as e:
        pass
    sheet_filter_queryset_ids_list = dshb_models.SheetFilter_querysets.objects.filter(user_id=tok1['user_id'], queryset_id=queryset_id).values_list('Sheetqueryset_id', flat=True).order_by('Sheetqueryset_id')
    return sheetfilter_table_create,sheet_filter_queryset_ids_list


def sheets_data(queryset_id,tok1,hierarchy_id,display_name):
    sheet_filter_table,sheet_filter_querysets=sheets_list(queryset_id,tok1,hierarchy_id,display_name)
    print("sh_fl",sheet_filter_querysets)
    sheetData = [
        {
            "user_id": tok1['user_id'],
            "chart_id": 1,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Info",
            "sheetfilter_querysets_id": sheet_filter_querysets[0],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Info</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 7,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Application wise Tax, Convertion",
            "sheetfilter_querysets_id": sheet_filter_querysets[1],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Application wise Tax, Convertion</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 10,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Application wise Email Templates",
            "sheetfilter_querysets_id": sheet_filter_querysets[2],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Application wise Email Templates</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 3,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Team Wise Agents",
            "sheetfilter_querysets_id": sheet_filter_querysets[3],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Team Wise Agents</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 6,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Department wise teams",
            "sheetfilter_querysets_id": sheet_filter_querysets[4],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Department wise teams</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Total Tax",
            "sheetfilter_querysets_id": sheet_filter_querysets[5],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Total Tax</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Total Users",
            "sheetfilter_querysets_id": sheet_filter_querysets[6],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Total Users</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Total Organisations",
            "sheetfilter_querysets_id": sheet_filter_querysets[7],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Total Organisations</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Total Teams",
            "sheetfilter_querysets_id": sheet_filter_querysets[7],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Total Teams</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Total Clients",
            "sheetfilter_querysets_id": sheet_filter_querysets[7],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Total Clients</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Total agents",
            "sheetfilter_querysets_id": sheet_filter_querysets[7],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Total agents</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
    ]
    try:
        for data in sheetData:
            sheet_data_instance = dshb_models.sheet_data(
                user_id=data['user_id'],
                chart_id=data['chart_id'],
                hierarchy_id=data['hierarchy_id'],
                is_sample=False,
                queryset_id=data['queryset_id'],
                filter_ids=data['filter_ids'],
                sheet_name=data['sheet_name'],
                sheet_filt_id=data['sheetfilter_querysets_id'],
                datapath=data['datapath'],
                datasrc=data['datasrc'],
                sheet_tag_name=data['sheet_tag_name'],
                created_at=data['created_at'],
                updated_at=data['updated_at'],
            )
            sheet_data_instance.save()
    except Exception as e:
        pass
    # return sheet_data_instance
    sheet_ids_list = list(dshb_models.sheet_data.objects.filter(user_id=tok1['user_id'], queryset_id=queryset_id).values_list('id', flat=True).order_by('-id'))
    return sheet_data_instance,sheet_ids_list


def dashbaord_data(queryset_id,tok1,hierarchy_id,sheet_ids_list):
    dashb_tb = dshb_models.dashboard_data.objects.create(
        user_id=tok1['user_id'],
        hierarchy_id=[hierarchy_id],
        queryset_id=queryset_id,
        sheet_ids=sheet_ids_list,
        selected_sheet_ids=sheet_ids_list,
        height=1800,
        width=1200,
        grid_id=2,
        is_sample=False,
        role_ids=[],
        user_ids=[],
        dashboard_name="templ_halops",
        datapath='',
        datasrc='',
        imagepath='',
        imagesrc='',
        dashboard_tag_name="""<p>templ_halops</p>""",
        is_public=False,
        created_at=datetime.datetime.now(),
        updated_at=datetime.datetime.now(),
        )
    dashb_tb.save()
    return dashb_tb



@api_view(['GET'])
@transaction.atomic
@csrf_exempt
def halops_dashbaord(request,hierarchy_id,token):
    if request.method=='GET':
        tok1 = views.test_token(token)
        if tok1['status']==200:
            try:
                dis_name,para=Connections.display_name(hierarchy_id)
                database_name=dis_name.display_name
            except:
                return Response({'message':'Invalid Id'},status=status.HTTP_404_NOT_FOUND)
            query_table=query_form(tok1,hierarchy_id,database_name)
            sheets_table,sheets_ids_list=sheets_data(query_table.queryset_id,tok1,hierarchy_id,database_name)
            dashboard_table=dashbaord_data(query_table.queryset_id,tok1,hierarchy_id,sheets_ids_list)
            pr_ids=dshb_models.parent_ids.objects.get(id=hierarchy_id)
            print("queryset_id",query_table.queryset_id)
            print("sheet_ids",sheets_ids_list)
            print("dashboard_id",dashboard_table.id)
            if pr_ids.parameter.upper()=="SERVER":
                srdt=dshb_models.ServerDetails.objects.get(id=pr_ids.table_id)
                srtp=dshb_models.ServerType.objects.get(id=srdt.server_type)
                parameter=srtp.server_type.upper()
            else:
                parameter=pr_ids.parameter.upper()
            dashb_data=quickbooks.temp_dashb_main(tok1,database_name,query_table,sheets_table,sheets_ids_list,dashboard_table,parameter)
            return dashb_data
        else:
            return Response(tok1,status=tok1['status'])
    else:
        return Response({'message':'Method not allowed'},status=status.HTTP_405_METHOD_NOT_ALLOWED)