import os,requests,pdfplumber,boto3,ast,random,re,secrets,string
from project import settings
import pandas as pd
from dashboard import views,models as dshb_models,Connections,columns_extract,clickhouse,Filters
from quickbooks import models,serializers,endpoints_data
import datetime
from io import BytesIO
from pytz import utc
from requests.auth import HTTPBasicAuth
from django.db import transaction
from django.views.decorators.csrf import csrf_exempt
from rest_framework.generics import CreateAPIView
from rest_framework.response import Response
from rest_framework import status
from rest_framework.decorators import api_view
from django.template.loader import render_to_string
from django.core.mail import send_mail
from urllib.parse import urlparse, parse_qs
from requests_oauthlib import OAuth2Session
import json,io
from sqlalchemy import create_engine, Column, Integer, String, VARCHAR, Float, text
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker
import requests
from base64 import b64encode
from django.test import Client,RequestFactory
from django.urls import reverse
from template_dashboards import quickbooks


#### querysets_query
query_table = '''SELECT "company_companies"."id" AS "id", "company_companies"."identifier" AS "identifier", "company_companies"."name" AS "name", "company_companies"."status.id" AS "status.id", "company_companies"."status.name" AS "status.name", "company_companies"."status._info.status_href" AS "status._info.status_href", "company_companies"."country.id" AS "country.id", "company_companies"."country.name" AS "country.name", "company_companies"."country._info.country_href" AS "country._info.country_href", "company_companies"."phoneNumber" AS "phoneNumber", "company_companies"."website" AS "website", "company_companies"."territory.id" AS "territory.id", "company_companies"."territory.name" AS "territory.name", "company_companies"."territory._info.location_href" AS "territory._info.location_href", "company_companies"."market.id" AS "market.id", "company_companies"."market.name" AS "market.name", "company_companies"."market._info.Market_href" AS "market._info.Market_href", "company_companies"."defaultContact.id" AS "defaultContact.id", "company_companies"."defaultContact.name" AS "defaultContact.name", "company_companies"."defaultContact._info.contact_href" AS "defaultContact._info.contact_href", "company_companies"."dateAcquired" AS "dateAcquired", "company_companies"."annualRevenue" AS "annualRevenue", "company_companies"."timeZoneSetup.id" AS "timeZoneSetup.id", "company_companies"."timeZoneSetup.name" AS "timeZoneSetup.name", "company_companies"."timeZoneSetup._info.timeZoneSetup_href" AS "timeZoneSetup._info.timeZoneSetup_href", "company_companies"."leadFlag" AS "leadFlag", "company_companies"."unsubscribeFlag" AS "unsubscribeFlag", "company_companies"."taxCode.id" AS "taxCode.id", "company_companies"."taxCode.name" AS "taxCode.name", "company_companies"."taxCode._info.taxCode_href" AS "taxCode._info.taxCode_href", "company_companies"."billingTerms.id" AS "billingTerms.id", "company_companies"."billingTerms.name" AS "billingTerms.name", "company_companies"."billToCompany.id" AS "billToCompany.id", "company_companies"."billToCompany.identifier" AS "billToCompany.identifier", "company_companies"."billToCompany.name" AS "billToCompany.name", "company_companies"."billToCompany._info.company_href" AS "billToCompany._info.company_href", "company_companies"."invoiceDeliveryMethod.id" AS "invoiceDeliveryMethod.id", "company_companies"."invoiceDeliveryMethod.name" AS "invoiceDeliveryMethod.name", "company_companies"."deletedFlag" AS "deletedFlag", "company_companies"."mobileGuid" AS "mobileGuid", "company_companies"."isVendorFlag" AS "isVendorFlag", "company_companies"."types[0].id" AS "types[0].id", "company_companies"."types[0].name" AS "types[0].name", "company_companies"."types[0]._info.type_href" AS "types[0]._info.type_href", "company_companies"."site.id" AS "site.id", "company_companies"."site.name" AS "site.name", "company_companies"."site._info.site_href" AS "site._info.site_href", "company_companies"."_info.lastUpdated" AS "_info.lastUpdated", "company_companies"."_info.updatedBy" AS "_info.updatedBy", "company_companies"."_info.dateEntered" AS "_info.dateEntered", "company_companies"."_info.enteredBy" AS "_info.enteredBy", "company_companies"."_info.contacts_href" AS "_info.contacts_href", "company_companies"."_info.agreements_href" AS "_info.agreements_href", "company_companies"."_info.tickets_href" AS "_info.tickets_href", "company_companies"."_info.opportunities_href" AS "_info.opportunities_href", "company_companies"."_info.activities_href" AS "_info.activities_href", "company_companies"."_info.projects_href" AS "_info.projects_href", "company_companies"."_info.configurations_href" AS "_info.configurations_href", "company_companies"."_info.orders_href" AS "_info.orders_href", "company_companies"."_info.documents_href" AS "_info.documents_href", "company_companies"."_info.sites_href" AS "_info.sites_href", "company_companies"."_info.teams_href" AS "_info.teams_href", "company_companies"."_info.reports_href" AS "_info.reports_href", "company_companies"."_info.notes_href" AS "_info.notes_href", "company_companies"."addressLine1" AS "addressLine1", "company_companies"."addressLine2" AS "addressLine2", "company_companies"."city" AS "city", "company_companies"."state" AS "state", "company_companies"."zip" AS "zip", "company_companies"."faxNumber" AS "faxNumber", "company_companies"."accountNumber" AS "accountNumber", "company_companies"."numberOfEmployees" AS "numberOfEmployees", "company_companies"."leadSource" AS "leadSource", "company_companies"."billingContact.id" AS "billingContact.id", "company_companies"."billingContact.name" AS "billingContact.name", "company_companies"."billingContact._info.contact_href" AS "billingContact._info.contact_href", "company_companies"."invoiceToEmailAddress" AS "invoiceToEmailAddress", "company_companies"."billingSite.id" AS "billingSite.id", "company_companies"."billingSite.name" AS "billingSite.name", "company_companies"."billingSite._info.site_href" AS "billingSite._info.site_href", "company_configurations"."id" AS "id(company_configurations)", "company_configurations"."name" AS "name(company_configurations)", "company_configurations"."type.id" AS "type.id", "company_configurations"."type.name" AS "type.name", "company_configurations"."type._info.type_href" AS "type._info.type_href", "company_configurations"."status.id" AS "status.id(company_configurations)", "company_configurations"."status.name" AS "status.name(company_configurations)", "company_configurations"."status._info.status_href" AS "status._info.status_href(company_configurations)", "company_configurations"."company.id" AS "company.id", "company_configurations"."company.identifier" AS "company.identifier", "company_configurations"."company.name" AS "company.name", "company_configurations"."company._info.company_href" AS "company._info.company_href", "company_configurations"."contact.id" AS "contact.id", "company_configurations"."contact.name" AS "contact.name", "company_configurations"."contact._info.contact_href" AS "contact._info.contact_href", "company_configurations"."site.id" AS "site.id(company_configurations)", "company_configurations"."site.name" AS "site.name(company_configurations)", "company_configurations"."site._info.site_href" AS "site._info.site_href(company_configurations)", "company_configurations"."locationId" AS "locationId", "company_configurations"."location.id" AS "location.id", "company_configurations"."location.name" AS "location.name", "company_configurations"."location._info.location_href" AS "location._info.location_href", "company_configurations"."businessUnitId" AS "businessUnitId", "company_configurations"."department.id" AS "department.id", "company_configurations"."department.identifier" AS "department.identifier", "company_configurations"."department.name" AS "department.name", "company_configurations"."department._info.department_href" AS "department._info.department_href", "company_configurations"."serialNumber" AS "serialNumber", "company_configurations"."modelNumber" AS "modelNumber", "company_configurations"."tagNumber" AS "tagNumber", "company_configurations"."warrantyExpirationDate" AS "warrantyExpirationDate", "company_configurations"."notes" AS "notes", "company_configurations"."billFlag" AS "billFlag", "company_configurations"."vendor.id" AS "vendor.id", "company_configurations"."vendor.identifier" AS "vendor.identifier", "company_configurations"."vendor.name" AS "vendor.name", "company_configurations"."vendor._info.company_href" AS "vendor._info.company_href", "company_configurations"."activeFlag" AS "activeFlag", "company_configurations"."mobileGuid" AS "mobileGuid(company_configurations)", "company_configurations"."companyLocationId" AS "companyLocationId", "company_configurations"."showRemoteFlag" AS "showRemoteFlag", "company_configurations"."showAutomateFlag" AS "showAutomateFlag", "company_configurations"."needsRenewalFlag" AS "needsRenewalFlag", "company_configurations"."_info.lastUpdated" AS "_info.lastUpdated(company_configurations)", "company_configurations"."_info.updatedBy" AS "_info.updatedBy(company_configurations)", "company_configurations"."_info.dateEntered" AS "_info.dateEntered(company_configurations)", "company_configurations"."_info.enteredBy" AS "_info.enteredBy(company_configurations)", "company_configurations"."backupSuccesses" AS "backupSuccesses", "company_configurations"."backupIncomplete" AS "backupIncomplete", "company_configurations"."backupFailed" AS "backupFailed", "company_configurations"."backupRestores" AS "backupRestores", "company_configurations"."backupBillableSpaceGb" AS "backupBillableSpaceGb", "company_configurations"."backupYear" AS "backupYear", "company_configurations"."backupMonth" AS "backupMonth", "service_tickets"."id" AS "id(service_tickets)", "service_tickets"."summary" AS "summary", "service_tickets"."recordType" AS "recordType", "service_tickets"."board.id" AS "board.id", "service_tickets"."board.name" AS "board.name", "service_tickets"."board._info.board_href" AS "board._info.board_href", "service_tickets"."status.id" AS "status.id(service_tickets)", "service_tickets"."status.name" AS "status.name(service_tickets)", "service_tickets"."status.Sort" AS "status.Sort", "service_tickets"."status._info.status_href" AS "status._info.status_href(service_tickets)", "service_tickets"."company.id" AS "company.id(service_tickets)", "service_tickets"."company.identifier" AS "company.identifier(service_tickets)", "service_tickets"."company.name" AS "company.name(service_tickets)", "service_tickets"."company._info.company_href" AS "company._info.company_href(service_tickets)", "service_tickets"."company._info.mobileGuid" AS "company._info.mobileGuid", "service_tickets"."site.id" AS "site.id(service_tickets)", "service_tickets"."site.name" AS "site.name(service_tickets)", "service_tickets"."site._info.site_href" AS "site._info.site_href(service_tickets)", "service_tickets"."site._info.mobileGuid" AS "site._info.mobileGuid", "service_tickets"."addressLine1" AS "addressLine1(service_tickets)", "service_tickets"."addressLine2" AS "addressLine2(service_tickets)", "service_tickets"."city" AS "city(service_tickets)", "service_tickets"."stateIdentifier" AS "stateIdentifier", "service_tickets"."zip" AS "zip(service_tickets)", "service_tickets"."contact.id" AS "contact.id(service_tickets)", "service_tickets"."contact.name" AS "contact.name(service_tickets)", "service_tickets"."contact._info.mobileGuid" AS "contact._info.mobileGuid", "service_tickets"."contact._info.contact_href" AS "contact._info.contact_href(service_tickets)", "service_tickets"."contactName" AS "contactName", "service_tickets"."contactPhoneNumber" AS "contactPhoneNumber", "service_tickets"."contactPhoneExtension" AS "contactPhoneExtension", "service_tickets"."contactEmailAddress" AS "contactEmailAddress", "service_tickets"."team.id" AS "team.id", "service_tickets"."team.name" AS "team.name", "service_tickets"."team._info.team_href" AS "team._info.team_href", "service_tickets"."priority.id" AS "priority.id", "service_tickets"."priority.name" AS "priority.name", "service_tickets"."priority.sort" AS "priority.sort", "service_tickets"."priority._info.priority_href" AS "priority._info.priority_href", "service_tickets"."priority._info.image_href" AS "priority._info.image_href", "service_tickets"."serviceLocation.id" AS "serviceLocation.id", "service_tickets"."serviceLocation.name" AS "serviceLocation.name", "service_tickets"."serviceLocation._info.location_href" AS "serviceLocation._info.location_href", "service_tickets"."source.id" AS "source.id", "service_tickets"."source.name" AS "source.name", "service_tickets"."source._info.source_href" AS "source._info.source_href", "service_tickets"."agreement.id" AS "agreement.id", "service_tickets"."agreement.name" AS "agreement.name", "service_tickets"."agreement._info.agreement_href" AS "agreement._info.agreement_href", "service_tickets"."severity" AS "severity", "service_tickets"."impact" AS "impact", "service_tickets"."allowAllClientsPortalView" AS "allowAllClientsPortalView", "service_tickets"."customerUpdatedFlag" AS "customerUpdatedFlag", "service_tickets"."automaticEmailContactFlag" AS "automaticEmailContactFlag", "service_tickets"."automaticEmailResourceFlag" AS "automaticEmailResourceFlag", "service_tickets"."automaticEmailCcFlag" AS "automaticEmailCcFlag", "service_tickets"."closedDate" AS "closedDate", "service_tickets"."closedBy" AS "closedBy", "service_tickets"."closedFlag" AS "closedFlag", "service_tickets"."actualHours" AS "actualHours", "service_tickets"."approved" AS "approved", "service_tickets"."estimatedExpenseCost" AS "estimatedExpenseCost", "service_tickets"."estimatedExpenseRevenue" AS "estimatedExpenseRevenue", "service_tickets"."estimatedProductCost" AS "estimatedProductCost", "service_tickets"."estimatedProductRevenue" AS "estimatedProductRevenue", "service_tickets"."estimatedTimeCost" AS "estimatedTimeCost", "service_tickets"."estimatedTimeRevenue" AS "estimatedTimeRevenue", "service_tickets"."billingMethod" AS "billingMethod", "service_tickets"."dateResplan" AS "dateResplan", "service_tickets"."dateResponded" AS "dateResponded", "service_tickets"."resolveMinutes" AS "resolveMinutes", "service_tickets"."resPlanMinutes" AS "resPlanMinutes", "service_tickets"."respondMinutes" AS "respondMinutes", "service_tickets"."isInSla" AS "isInSla", "service_tickets"."hasChildTicket" AS "hasChildTicket", "service_tickets"."hasMergedChildTicketFlag" AS "hasMergedChildTicketFlag", "service_tickets"."billTime" AS "billTime", "service_tickets"."billExpenses" AS "billExpenses", "service_tickets"."billProducts" AS "billProducts", "service_tickets"."location.id" AS "location.id(service_tickets)", "service_tickets"."location.name" AS "location.name(service_tickets)", "service_tickets"."location._info.location_href" AS "location._info.location_href(service_tickets)", "service_tickets"."department.id" AS "department.id(service_tickets)", "service_tickets"."department.identifier" AS "department.identifier(service_tickets)", "service_tickets"."department.name" AS "department.name(service_tickets)", "service_tickets"."department._info.department_href" AS "department._info.department_href(service_tickets)", "service_tickets"."mobileGuid" AS "mobileGuid(service_tickets)", "service_tickets"."sla.id" AS "sla.id", "service_tickets"."sla.name" AS "sla.name", "service_tickets"."sla._info.sla_href" AS "sla._info.sla_href", "service_tickets"."currency.id" AS "currency.id", "service_tickets"."currency.symbol" AS "currency.symbol", "service_tickets"."currency.currencyCode" AS "currency.currencyCode", "service_tickets"."currency.decimalSeparator" AS "currency.decimalSeparator", "service_tickets"."currency.numberOfDecimals" AS "currency.numberOfDecimals", "service_tickets"."currency.thousandsSeparator" AS "currency.thousandsSeparator", "service_tickets"."currency.negativeParenthesesFlag" AS "currency.negativeParenthesesFlag", "service_tickets"."currency.displaySymbolFlag" AS "currency.displaySymbolFlag", "service_tickets"."currency.currencyIdentifier" AS "currency.currencyIdentifier", "service_tickets"."currency.displayIdFlag" AS "currency.displayIdFlag", "service_tickets"."currency.rightAlign" AS "currency.rightAlign", "service_tickets"."currency.name" AS "currency.name", "service_tickets"."currency._info.currency_href" AS "currency._info.currency_href", "service_tickets"."_info.lastUpdated" AS "_info.lastUpdated(service_tickets)", "service_tickets"."_info.updatedBy" AS "_info.updatedBy(service_tickets)", "service_tickets"."_info.dateEntered" AS "_info.dateEntered(service_tickets)", "service_tickets"."_info.enteredBy" AS "_info.enteredBy(service_tickets)", "service_tickets"."_info.activities_href" AS "_info.activities_href(service_tickets)", "service_tickets"."_info.scheduleentries_href" AS "_info.scheduleentries_href", "service_tickets"."_info.documents_href" AS "_info.documents_href(service_tickets)", "service_tickets"."_info.configurations_href" AS "_info.configurations_href(service_tickets)", "service_tickets"."_info.tasks_href" AS "_info.tasks_href", "service_tickets"."_info.notes_href" AS "_info.notes_href(service_tickets)", "service_tickets"."_info.products_href" AS "_info.products_href", "service_tickets"."_info.timeentries_href" AS "_info.timeentries_href", "service_tickets"."_info.expenseEntries_href" AS "_info.expenseEntries_href", "service_tickets"."escalationStartDateUTC" AS "escalationStartDateUTC", "service_tickets"."escalationLevel" AS "escalationLevel", "service_tickets"."minutesBeforeWaiting" AS "minutesBeforeWaiting", "service_tickets"."respondedSkippedMinutes" AS "respondedSkippedMinutes", "service_tickets"."resplanSkippedMinutes" AS "resplanSkippedMinutes", "service_tickets"."respondedHours" AS "respondedHours", "service_tickets"."respondedBy" AS "respondedBy", "service_tickets"."resplanHours" AS "resplanHours", "service_tickets"."resplanBy" AS "resplanBy", "service_tickets"."resolutionHours" AS "resolutionHours", "service_tickets"."minutesWaiting" AS "minutesWaiting", "service_tickets"."workType.id" AS "workType.id", "service_tickets"."workType.name" AS "workType.name", "service_tickets"."workType._info.workType_href" AS "workType._info.workType_href", "service_tickets"."resources" AS "resources", "service_tickets"."workRole.id" AS "workRole.id", "service_tickets"."workRole.name" AS "workRole.name", "service_tickets"."workRole._info.workRole_href" AS "workRole._info.workRole_href", "service_tickets"."type.id" AS "type.id(service_tickets)", "service_tickets"."type.name" AS "type.name(service_tickets)", "service_tickets"."type._info.type_href" AS "type._info.type_href(service_tickets)", "service_tickets"."requiredDate" AS "requiredDate", "service_tickets"."budgetHours" AS "budgetHours", "service_tickets"."requestForChangeFlag" AS "requestForChangeFlag" FROM "Halops_Dash"."company_companies" AS "company_companies" INNER JOIN "Halops_Dash"."company_configurations" AS "company_configurations" ON "company_companies"."id" = "company_configurations"."id" INNER JOIN "Halops_Dash"."service_tickets" AS "service_tickets" ON "company_companies"."id" = "service_tickets"."id"
                '''


#### Sheetfilter_query
shft_q1 = '''SELECT "name" AS "name", CASE WHEN "leadFlag" THEN 'True' ELSE 'False' END AS "leadFlag", CASE WHEN "deletedFlag" THEN 'True' ELSE 'False' END AS "deletedFlag", CASE WHEN "unsubscribeFlag" THEN 'True' ELSE 'False' END AS "unsubscribeFlag", CASE WHEN "isVendorFlag" THEN 'True' ELSE 'False' END AS "isVendorFlag" FROM (SELECT "company_companies"."id" AS "id", "company_companies"."identifier" AS "identifier", "company_companies"."name" AS "name", "company_companies"."status.id" AS "status.id", "company_companies"."status.name" AS "status.name", "company_companies"."status._info.status_href" AS "status._info.status_href", "company_companies"."country.id" AS "country.id", "company_companies"."country.name" AS "country.name", "company_companies"."country._info.country_href" AS "country._info.country_href", "company_companies"."phoneNumber" AS "phoneNumber", "company_companies"."website" AS "website", "company_companies"."territory.id" AS "territory.id", "company_companies"."territory.name" AS "territory.name", "company_companies"."territory._info.location_href" AS "territory._info.location_href", "company_companies"."market.id" AS "market.id", "company_companies"."market.name" AS "market.name", "company_companies"."market._info.Market_href" AS "market._info.Market_href", "company_companies"."defaultContact.id" AS "defaultContact.id", "company_companies"."defaultContact.name" AS "defaultContact.name", "company_companies"."defaultContact._info.contact_href" AS "defaultContact._info.contact_href", "company_companies"."dateAcquired" AS "dateAcquired", "company_companies"."annualRevenue" AS "annualRevenue", "company_companies"."timeZoneSetup.id" AS "timeZoneSetup.id", "company_companies"."timeZoneSetup.name" AS "timeZoneSetup.name", "company_companies"."timeZoneSetup._info.timeZoneSetup_href" AS "timeZoneSetup._info.timeZoneSetup_href", "company_companies"."leadFlag" AS "leadFlag", "company_companies"."unsubscribeFlag" AS "unsubscribeFlag", "company_companies"."taxCode.id" AS "taxCode.id", "company_companies"."taxCode.name" AS "taxCode.name", "company_companies"."taxCode._info.taxCode_href" AS "taxCode._info.taxCode_href", "company_companies"."billingTerms.id" AS "billingTerms.id", "company_companies"."billingTerms.name" AS "billingTerms.name", "company_companies"."billToCompany.id" AS "billToCompany.id", "company_companies"."billToCompany.identifier" AS "billToCompany.identifier", "company_companies"."billToCompany.name" AS "billToCompany.name", "company_companies"."billToCompany._info.company_href" AS "billToCompany._info.company_href", "company_companies"."invoiceDeliveryMethod.id" AS "invoiceDeliveryMethod.id", "company_companies"."invoiceDeliveryMethod.name" AS "invoiceDeliveryMethod.name", "company_companies"."deletedFlag" AS "deletedFlag", "company_companies"."mobileGuid" AS "mobileGuid", "company_companies"."isVendorFlag" AS "isVendorFlag", "company_companies"."types[0].id" AS "types[0].id", "company_companies"."types[0].name" AS "types[0].name", "company_companies"."types[0]._info.type_href" AS "types[0]._info.type_href", "company_companies"."site.id" AS "site.id", "company_companies"."site.name" AS "site.name", "company_companies"."site._info.site_href" AS "site._info.site_href", "company_companies"."_info.lastUpdated" AS "_info.lastUpdated", "company_companies"."_info.updatedBy" AS "_info.updatedBy", "company_companies"."_info.dateEntered" AS "_info.dateEntered", "company_companies"."_info.enteredBy" AS "_info.enteredBy", "company_companies"."_info.contacts_href" AS "_info.contacts_href", "company_companies"."_info.agreements_href" AS "_info.agreements_href", "company_companies"."_info.tickets_href" AS "_info.tickets_href", "company_companies"."_info.opportunities_href" AS "_info.opportunities_href", "company_companies"."_info.activities_href" AS "_info.activities_href", "company_companies"."_info.projects_href" AS "_info.projects_href", "company_companies"."_info.configurations_href" AS "_info.configurations_href", "company_companies"."_info.orders_href" AS "_info.orders_href", "company_companies"."_info.documents_href" AS "_info.documents_href", "company_companies"."_info.sites_href" AS "_info.sites_href", "company_companies"."_info.teams_href" AS "_info.teams_href", "company_companies"."_info.reports_href" AS "_info.reports_href", "company_companies"."_info.notes_href" AS "_info.notes_href", "company_companies"."addressLine1" AS "addressLine1", "company_companies"."addressLine2" AS "addressLine2", "company_companies"."city" AS "city", "company_companies"."state" AS "state", "company_companies"."zip" AS "zip", "company_companies"."faxNumber" AS "faxNumber", "company_companies"."accountNumber" AS "accountNumber", "company_companies"."numberOfEmployees" AS "numberOfEmployees", "company_companies"."leadSource" AS "leadSource", "company_companies"."billingContact.id" AS "billingContact.id", "company_companies"."billingContact.name" AS "billingContact.name", "company_companies"."billingContact._info.contact_href" AS "billingContact._info.contact_href", "company_companies"."invoiceToEmailAddress" AS "invoiceToEmailAddress", "company_companies"."billingSite.id" AS "billingSite.id", "company_companies"."billingSite.name" AS "billingSite.name", "company_companies"."billingSite._info.site_href" AS "billingSite._info.site_href", "company_configurations"."id" AS "id(company_configurations)", "company_configurations"."name" AS "name(company_configurations)", "company_configurations"."type.id" AS "type.id", "company_configurations"."type.name" AS "type.name", "company_configurations"."type._info.type_href" AS "type._info.type_href", "company_configurations"."status.id" AS "status.id(company_configurations)", "company_configurations"."status.name" AS "status.name(company_configurations)", "company_configurations"."status._info.status_href" AS "status._info.status_href(company_configurations)", "company_configurations"."company.id" AS "company.id", "company_configurations"."company.identifier" AS "company.identifier", "company_configurations"."company.name" AS "company.name", "company_configurations"."company._info.company_href" AS "company._info.company_href", "company_configurations"."contact.id" AS "contact.id", "company_configurations"."contact.name" AS "contact.name", "company_configurations"."contact._info.contact_href" AS "contact._info.contact_href", "company_configurations"."site.id" AS "site.id(company_configurations)", "company_configurations"."site.name" AS "site.name(company_configurations)", "company_configurations"."site._info.site_href" AS "site._info.site_href(company_configurations)", "company_configurations"."locationId" AS "locationId", "company_configurations"."location.id" AS "location.id", "company_configurations"."location.name" AS "location.name", "company_configurations"."location._info.location_href" AS "location._info.location_href", "company_configurations"."businessUnitId" AS "businessUnitId", "company_configurations"."department.id" AS "department.id", "company_configurations"."department.identifier" AS "department.identifier", "company_configurations"."department.name" AS "department.name", "company_configurations"."department._info.department_href" AS "department._info.department_href", "company_configurations"."serialNumber" AS "serialNumber", "company_configurations"."modelNumber" AS "modelNumber", "company_configurations"."tagNumber" AS "tagNumber", "company_configurations"."warrantyExpirationDate" AS "warrantyExpirationDate", "company_configurations"."notes" AS "notes", "company_configurations"."billFlag" AS "billFlag", "company_configurations"."vendor.id" AS "vendor.id", "company_configurations"."vendor.identifier" AS "vendor.identifier", "company_configurations"."vendor.name" AS "vendor.name", "company_configurations"."vendor._info.company_href" AS "vendor._info.company_href", "company_configurations"."activeFlag" AS "activeFlag", "company_configurations"."mobileGuid" AS "mobileGuid(company_configurations)", "company_configurations"."companyLocationId" AS "companyLocationId", "company_configurations"."showRemoteFlag" AS "showRemoteFlag", "company_configurations"."showAutomateFlag" AS "showAutomateFlag", "company_configurations"."needsRenewalFlag" AS "needsRenewalFlag", "company_configurations"."_info.lastUpdated" AS "_info.lastUpdated(company_configurations)", "company_configurations"."_info.updatedBy" AS "_info.updatedBy(company_configurations)", "company_configurations"."_info.dateEntered" AS "_info.dateEntered(company_configurations)", "company_configurations"."_info.enteredBy" AS "_info.enteredBy(company_configurations)", "company_configurations"."backupSuccesses" AS "backupSuccesses", "company_configurations"."backupIncomplete" AS "backupIncomplete", "company_configurations"."backupFailed" AS "backupFailed", "company_configurations"."backupRestores" AS "backupRestores", "company_configurations"."backupBillableSpaceGb" AS "backupBillableSpaceGb", "company_configurations"."backupYear" AS "backupYear", "company_configurations"."backupMonth" AS "backupMonth", "service_tickets"."id" AS "id(service_tickets)", "service_tickets"."summary" AS "summary", "service_tickets"."recordType" AS "recordType", "service_tickets"."board.id" AS "board.id", "service_tickets"."board.name" AS "board.name", "service_tickets"."board._info.board_href" AS "board._info.board_href", "service_tickets"."status.id" AS "status.id(service_tickets)", "service_tickets"."status.name" AS "status.name(service_tickets)", "service_tickets"."status.Sort" AS "status.Sort", "service_tickets"."status._info.status_href" AS "status._info.status_href(service_tickets)", "service_tickets"."company.id" AS "company.id(service_tickets)", "service_tickets"."company.identifier" AS "company.identifier(service_tickets)", "service_tickets"."company.name" AS "company.name(service_tickets)", "service_tickets"."company._info.company_href" AS "company._info.company_href(service_tickets)", "service_tickets"."company._info.mobileGuid" AS "company._info.mobileGuid", "service_tickets"."site.id" AS "site.id(service_tickets)", "service_tickets"."site.name" AS "site.name(service_tickets)", "service_tickets"."site._info.site_href" AS "site._info.site_href(service_tickets)", "service_tickets"."site._info.mobileGuid" AS "site._info.mobileGuid", "service_tickets"."addressLine1" AS "addressLine1(service_tickets)", "service_tickets"."addressLine2" AS "addressLine2(service_tickets)", "service_tickets"."city" AS "city(service_tickets)", "service_tickets"."stateIdentifier" AS "stateIdentifier", "service_tickets"."zip" AS "zip(service_tickets)", "service_tickets"."contact.id" AS "contact.id(service_tickets)", "service_tickets"."contact.name" AS "contact.name(service_tickets)", "service_tickets"."contact._info.mobileGuid" AS "contact._info.mobileGuid", "service_tickets"."contact._info.contact_href" AS "contact._info.contact_href(service_tickets)", "service_tickets"."contactName" AS "contactName", "service_tickets"."contactPhoneNumber" AS "contactPhoneNumber", "service_tickets"."contactPhoneExtension" AS "contactPhoneExtension", "service_tickets"."contactEmailAddress" AS "contactEmailAddress", "service_tickets"."team.id" AS "team.id", "service_tickets"."team.name" AS "team.name", "service_tickets"."team._info.team_href" AS "team._info.team_href", "service_tickets"."priority.id" AS "priority.id", "service_tickets"."priority.name" AS "priority.name", "service_tickets"."priority.sort" AS "priority.sort", "service_tickets"."priority._info.priority_href" AS "priority._info.priority_href", "service_tickets"."priority._info.image_href" AS "priority._info.image_href", "service_tickets"."serviceLocation.id" AS "serviceLocation.id", "service_tickets"."serviceLocation.name" AS "serviceLocation.name", "service_tickets"."serviceLocation._info.location_href" AS "serviceLocation._info.location_href", "service_tickets"."source.id" AS "source.id", "service_tickets"."source.name" AS "source.name", "service_tickets"."source._info.source_href" AS "source._info.source_href", "service_tickets"."agreement.id" AS "agreement.id", "service_tickets"."agreement.name" AS "agreement.name", "service_tickets"."agreement._info.agreement_href" AS "agreement._info.agreement_href", "service_tickets"."severity" AS "severity", "service_tickets"."impact" AS "impact", "service_tickets"."allowAllClientsPortalView" AS "allowAllClientsPortalView", "service_tickets"."customerUpdatedFlag" AS "customerUpdatedFlag", "service_tickets"."automaticEmailContactFlag" AS "automaticEmailContactFlag", "service_tickets"."automaticEmailResourceFlag" AS "automaticEmailResourceFlag", "service_tickets"."automaticEmailCcFlag" AS "automaticEmailCcFlag", "service_tickets"."closedDate" AS "closedDate", "service_tickets"."closedBy" AS "closedBy", "service_tickets"."closedFlag" AS "closedFlag", "service_tickets"."actualHours" AS "actualHours", "service_tickets"."approved" AS "approved", "service_tickets"."estimatedExpenseCost" AS "estimatedExpenseCost", "service_tickets"."estimatedExpenseRevenue" AS "estimatedExpenseRevenue", "service_tickets"."estimatedProductCost" AS "estimatedProductCost", "service_tickets"."estimatedProductRevenue" AS "estimatedProductRevenue", "service_tickets"."estimatedTimeCost" AS "estimatedTimeCost", "service_tickets"."estimatedTimeRevenue" AS "estimatedTimeRevenue", "service_tickets"."billingMethod" AS "billingMethod", "service_tickets"."dateResplan" AS "dateResplan", "service_tickets"."dateResponded" AS "dateResponded", "service_tickets"."resolveMinutes" AS "resolveMinutes", "service_tickets"."resPlanMinutes" AS "resPlanMinutes", "service_tickets"."respondMinutes" AS "respondMinutes", "service_tickets"."isInSla" AS "isInSla", "service_tickets"."hasChildTicket" AS "hasChildTicket", "service_tickets"."hasMergedChildTicketFlag" AS "hasMergedChildTicketFlag", "service_tickets"."billTime" AS "billTime", "service_tickets"."billExpenses" AS "billExpenses", "service_tickets"."billProducts" AS "billProducts", "service_tickets"."location.id" AS "location.id(service_tickets)", "service_tickets"."location.name" AS "location.name(service_tickets)", "service_tickets"."location._info.location_href" AS "location._info.location_href(service_tickets)", "service_tickets"."department.id" AS "department.id(service_tickets)", "service_tickets"."department.identifier" AS "department.identifier(service_tickets)", "service_tickets"."department.name" AS "department.name(service_tickets)", "service_tickets"."department._info.department_href" AS "department._info.department_href(service_tickets)", "service_tickets"."mobileGuid" AS "mobileGuid(service_tickets)", "service_tickets"."sla.id" AS "sla.id", "service_tickets"."sla.name" AS "sla.name", "service_tickets"."sla._info.sla_href" AS "sla._info.sla_href", "service_tickets"."currency.id" AS "currency.id", "service_tickets"."currency.symbol" AS "currency.symbol", "service_tickets"."currency.currencyCode" AS "currency.currencyCode", "service_tickets"."currency.decimalSeparator" AS "currency.decimalSeparator", "service_tickets"."currency.numberOfDecimals" AS "currency.numberOfDecimals", "service_tickets"."currency.thousandsSeparator" AS "currency.thousandsSeparator", "service_tickets"."currency.negativeParenthesesFlag" AS "currency.negativeParenthesesFlag", "service_tickets"."currency.displaySymbolFlag" AS "currency.displaySymbolFlag", "service_tickets"."currency.currencyIdentifier" AS "currency.currencyIdentifier", "service_tickets"."currency.displayIdFlag" AS "currency.displayIdFlag", "service_tickets"."currency.rightAlign" AS "currency.rightAlign", "service_tickets"."currency.name" AS "currency.name", "service_tickets"."currency._info.currency_href" AS "currency._info.currency_href", "service_tickets"."_info.lastUpdated" AS "_info.lastUpdated(service_tickets)", "service_tickets"."_info.updatedBy" AS "_info.updatedBy(service_tickets)", "service_tickets"."_info.dateEntered" AS "_info.dateEntered(service_tickets)", "service_tickets"."_info.enteredBy" AS "_info.enteredBy(service_tickets)", "service_tickets"."_info.activities_href" AS "_info.activities_href(service_tickets)", "service_tickets"."_info.scheduleentries_href" AS "_info.scheduleentries_href", "service_tickets"."_info.documents_href" AS "_info.documents_href(service_tickets)", "service_tickets"."_info.configurations_href" AS "_info.configurations_href(service_tickets)", "service_tickets"."_info.tasks_href" AS "_info.tasks_href", "service_tickets"."_info.notes_href" AS "_info.notes_href(service_tickets)", "service_tickets"."_info.products_href" AS "_info.products_href", "service_tickets"."_info.timeentries_href" AS "_info.timeentries_href", "service_tickets"."_info.expenseEntries_href" AS "_info.expenseEntries_href", "service_tickets"."escalationStartDateUTC" AS "escalationStartDateUTC", "service_tickets"."escalationLevel" AS "escalationLevel", "service_tickets"."minutesBeforeWaiting" AS "minutesBeforeWaiting", "service_tickets"."respondedSkippedMinutes" AS "respondedSkippedMinutes", "service_tickets"."resplanSkippedMinutes" AS "resplanSkippedMinutes", "service_tickets"."respondedHours" AS "respondedHours", "service_tickets"."respondedBy" AS "respondedBy", "service_tickets"."resplanHours" AS "resplanHours", "service_tickets"."resplanBy" AS "resplanBy", "service_tickets"."resolutionHours" AS "resolutionHours", "service_tickets"."minutesWaiting" AS "minutesWaiting", "service_tickets"."workType.id" AS "workType.id", "service_tickets"."workType.name" AS "workType.name", "service_tickets"."workType._info.workType_href" AS "workType._info.workType_href", "service_tickets"."resources" AS "resources", "service_tickets"."workRole.id" AS "workRole.id", "service_tickets"."workRole.name" AS "workRole.name", "service_tickets"."workRole._info.workRole_href" AS "workRole._info.workRole_href", "service_tickets"."type.id" AS "type.id(service_tickets)", "service_tickets"."type.name" AS "type.name(service_tickets)", "service_tickets"."type._info.type_href" AS "type._info.type_href(service_tickets)", "service_tickets"."requiredDate" AS "requiredDate", "service_tickets"."budgetHours" AS "budgetHours", "service_tickets"."requestForChangeFlag" AS "requestForChangeFlag" FROM "Halops_Dash"."company_companies" AS "company_companies" INNER JOIN "Halops_Dash"."company_configurations" AS "company_configurations" ON "company_companies"."id" = "company_configurations"."id" INNER JOIN "Halops_Dash"."service_tickets" AS "service_tickets" ON "company_companies"."id" = "service_tickets"."id") temp_table GROUP BY "name", "name", "leadFlag", "deletedFlag", "unsubscribeFlag", "isVendorFlag" ORDER BY "name" ASC NULLS FIRST'''

shft_q2 = '''SELECT "name" AS "name", "estimatedProductCost" AS "estimatedProductCost", "billTime" AS "billTime", "billProducts" AS "billProducts", SUM("estimatedProductCost") AS "sum(estimatedProductCost)", "currency.name" AS "currency.name", SUM("estimatedTimeCost") AS "sum(estimatedTimeCost)" FROM (SELECT "company_companies"."id" AS "id", "company_companies"."identifier" AS "identifier", "company_companies"."name" AS "name", "company_companies"."status.id" AS "status.id", "company_companies"."status.name" AS "status.name", "company_companies"."status._info.status_href" AS "status._info.status_href", "company_companies"."country.id" AS "country.id", "company_companies"."country.name" AS "country.name", "company_companies"."country._info.country_href" AS "country._info.country_href", "company_companies"."phoneNumber" AS "phoneNumber", "company_companies"."website" AS "website", "company_companies"."territory.id" AS "territory.id", "company_companies"."territory.name" AS "territory.name", "company_companies"."territory._info.location_href" AS "territory._info.location_href", "company_companies"."market.id" AS "market.id", "company_companies"."market.name" AS "market.name", "company_companies"."market._info.Market_href" AS "market._info.Market_href", "company_companies"."defaultContact.id" AS "defaultContact.id", "company_companies"."defaultContact.name" AS "defaultContact.name", "company_companies"."defaultContact._info.contact_href" AS "defaultContact._info.contact_href", "company_companies"."dateAcquired" AS "dateAcquired", "company_companies"."annualRevenue" AS "annualRevenue", "company_companies"."timeZoneSetup.id" AS "timeZoneSetup.id", "company_companies"."timeZoneSetup.name" AS "timeZoneSetup.name", "company_companies"."timeZoneSetup._info.timeZoneSetup_href" AS "timeZoneSetup._info.timeZoneSetup_href", "company_companies"."leadFlag" AS "leadFlag", "company_companies"."unsubscribeFlag" AS "unsubscribeFlag", "company_companies"."taxCode.id" AS "taxCode.id", "company_companies"."taxCode.name" AS "taxCode.name", "company_companies"."taxCode._info.taxCode_href" AS "taxCode._info.taxCode_href", "company_companies"."billingTerms.id" AS "billingTerms.id", "company_companies"."billingTerms.name" AS "billingTerms.name", "company_companies"."billToCompany.id" AS "billToCompany.id", "company_companies"."billToCompany.identifier" AS "billToCompany.identifier", "company_companies"."billToCompany.name" AS "billToCompany.name", "company_companies"."billToCompany._info.company_href" AS "billToCompany._info.company_href", "company_companies"."invoiceDeliveryMethod.id" AS "invoiceDeliveryMethod.id", "company_companies"."invoiceDeliveryMethod.name" AS "invoiceDeliveryMethod.name", "company_companies"."deletedFlag" AS "deletedFlag", "company_companies"."mobileGuid" AS "mobileGuid", "company_companies"."isVendorFlag" AS "isVendorFlag", "company_companies"."types[0].id" AS "types[0].id", "company_companies"."types[0].name" AS "types[0].name", "company_companies"."types[0]._info.type_href" AS "types[0]._info.type_href", "company_companies"."site.id" AS "site.id", "company_companies"."site.name" AS "site.name", "company_companies"."site._info.site_href" AS "site._info.site_href", "company_companies"."_info.lastUpdated" AS "_info.lastUpdated", "company_companies"."_info.updatedBy" AS "_info.updatedBy", "company_companies"."_info.dateEntered" AS "_info.dateEntered", "company_companies"."_info.enteredBy" AS "_info.enteredBy", "company_companies"."_info.contacts_href" AS "_info.contacts_href", "company_companies"."_info.agreements_href" AS "_info.agreements_href", "company_companies"."_info.tickets_href" AS "_info.tickets_href", "company_companies"."_info.opportunities_href" AS "_info.opportunities_href", "company_companies"."_info.activities_href" AS "_info.activities_href", "company_companies"."_info.projects_href" AS "_info.projects_href", "company_companies"."_info.configurations_href" AS "_info.configurations_href", "company_companies"."_info.orders_href" AS "_info.orders_href", "company_companies"."_info.documents_href" AS "_info.documents_href", "company_companies"."_info.sites_href" AS "_info.sites_href", "company_companies"."_info.teams_href" AS "_info.teams_href", "company_companies"."_info.reports_href" AS "_info.reports_href", "company_companies"."_info.notes_href" AS "_info.notes_href", "company_companies"."addressLine1" AS "addressLine1", "company_companies"."addressLine2" AS "addressLine2", "company_companies"."city" AS "city", "company_companies"."state" AS "state", "company_companies"."zip" AS "zip", "company_companies"."faxNumber" AS "faxNumber", "company_companies"."accountNumber" AS "accountNumber", "company_companies"."numberOfEmployees" AS "numberOfEmployees", "company_companies"."leadSource" AS "leadSource", "company_companies"."billingContact.id" AS "billingContact.id", "company_companies"."billingContact.name" AS "billingContact.name", "company_companies"."billingContact._info.contact_href" AS "billingContact._info.contact_href", "company_companies"."invoiceToEmailAddress" AS "invoiceToEmailAddress", "company_companies"."billingSite.id" AS "billingSite.id", "company_companies"."billingSite.name" AS "billingSite.name", "company_companies"."billingSite._info.site_href" AS "billingSite._info.site_href", "company_configurations"."id" AS "id(company_configurations)", "company_configurations"."name" AS "name(company_configurations)", "company_configurations"."type.id" AS "type.id", "company_configurations"."type.name" AS "type.name", "company_configurations"."type._info.type_href" AS "type._info.type_href", "company_configurations"."status.id" AS "status.id(company_configurations)", "company_configurations"."status.name" AS "status.name(company_configurations)", "company_configurations"."status._info.status_href" AS "status._info.status_href(company_configurations)", "company_configurations"."company.id" AS "company.id", "company_configurations"."company.identifier" AS "company.identifier", "company_configurations"."company.name" AS "company.name", "company_configurations"."company._info.company_href" AS "company._info.company_href", "company_configurations"."contact.id" AS "contact.id", "company_configurations"."contact.name" AS "contact.name", "company_configurations"."contact._info.contact_href" AS "contact._info.contact_href", "company_configurations"."site.id" AS "site.id(company_configurations)", "company_configurations"."site.name" AS "site.name(company_configurations)", "company_configurations"."site._info.site_href" AS "site._info.site_href(company_configurations)", "company_configurations"."locationId" AS "locationId", "company_configurations"."location.id" AS "location.id", "company_configurations"."location.name" AS "location.name", "company_configurations"."location._info.location_href" AS "location._info.location_href", "company_configurations"."businessUnitId" AS "businessUnitId", "company_configurations"."department.id" AS "department.id", "company_configurations"."department.identifier" AS "department.identifier", "company_configurations"."department.name" AS "department.name", "company_configurations"."department._info.department_href" AS "department._info.department_href", "company_configurations"."serialNumber" AS "serialNumber", "company_configurations"."modelNumber" AS "modelNumber", "company_configurations"."tagNumber" AS "tagNumber", "company_configurations"."warrantyExpirationDate" AS "warrantyExpirationDate", "company_configurations"."notes" AS "notes", "company_configurations"."billFlag" AS "billFlag", "company_configurations"."vendor.id" AS "vendor.id", "company_configurations"."vendor.identifier" AS "vendor.identifier", "company_configurations"."vendor.name" AS "vendor.name", "company_configurations"."vendor._info.company_href" AS "vendor._info.company_href", "company_configurations"."activeFlag" AS "activeFlag", "company_configurations"."mobileGuid" AS "mobileGuid(company_configurations)", "company_configurations"."companyLocationId" AS "companyLocationId", "company_configurations"."showRemoteFlag" AS "showRemoteFlag", "company_configurations"."showAutomateFlag" AS "showAutomateFlag", "company_configurations"."needsRenewalFlag" AS "needsRenewalFlag", "company_configurations"."_info.lastUpdated" AS "_info.lastUpdated(company_configurations)", "company_configurations"."_info.updatedBy" AS "_info.updatedBy(company_configurations)", "company_configurations"."_info.dateEntered" AS "_info.dateEntered(company_configurations)", "company_configurations"."_info.enteredBy" AS "_info.enteredBy(company_configurations)", "company_configurations"."backupSuccesses" AS "backupSuccesses", "company_configurations"."backupIncomplete" AS "backupIncomplete", "company_configurations"."backupFailed" AS "backupFailed", "company_configurations"."backupRestores" AS "backupRestores", "company_configurations"."backupBillableSpaceGb" AS "backupBillableSpaceGb", "company_configurations"."backupYear" AS "backupYear", "company_configurations"."backupMonth" AS "backupMonth", "service_tickets"."id" AS "id(service_tickets)", "service_tickets"."summary" AS "summary", "service_tickets"."recordType" AS "recordType", "service_tickets"."board.id" AS "board.id", "service_tickets"."board.name" AS "board.name", "service_tickets"."board._info.board_href" AS "board._info.board_href", "service_tickets"."status.id" AS "status.id(service_tickets)", "service_tickets"."status.name" AS "status.name(service_tickets)", "service_tickets"."status.Sort" AS "status.Sort", "service_tickets"."status._info.status_href" AS "status._info.status_href(service_tickets)", "service_tickets"."company.id" AS "company.id(service_tickets)", "service_tickets"."company.identifier" AS "company.identifier(service_tickets)", "service_tickets"."company.name" AS "company.name(service_tickets)", "service_tickets"."company._info.company_href" AS "company._info.company_href(service_tickets)", "service_tickets"."company._info.mobileGuid" AS "company._info.mobileGuid", "service_tickets"."site.id" AS "site.id(service_tickets)", "service_tickets"."site.name" AS "site.name(service_tickets)", "service_tickets"."site._info.site_href" AS "site._info.site_href(service_tickets)", "service_tickets"."site._info.mobileGuid" AS "site._info.mobileGuid", "service_tickets"."addressLine1" AS "addressLine1(service_tickets)", "service_tickets"."addressLine2" AS "addressLine2(service_tickets)", "service_tickets"."city" AS "city(service_tickets)", "service_tickets"."stateIdentifier" AS "stateIdentifier", "service_tickets"."zip" AS "zip(service_tickets)", "service_tickets"."contact.id" AS "contact.id(service_tickets)", "service_tickets"."contact.name" AS "contact.name(service_tickets)", "service_tickets"."contact._info.mobileGuid" AS "contact._info.mobileGuid", "service_tickets"."contact._info.contact_href" AS "contact._info.contact_href(service_tickets)", "service_tickets"."contactName" AS "contactName", "service_tickets"."contactPhoneNumber" AS "contactPhoneNumber", "service_tickets"."contactPhoneExtension" AS "contactPhoneExtension", "service_tickets"."contactEmailAddress" AS "contactEmailAddress", "service_tickets"."team.id" AS "team.id", "service_tickets"."team.name" AS "team.name", "service_tickets"."team._info.team_href" AS "team._info.team_href", "service_tickets"."priority.id" AS "priority.id", "service_tickets"."priority.name" AS "priority.name", "service_tickets"."priority.sort" AS "priority.sort", "service_tickets"."priority._info.priority_href" AS "priority._info.priority_href", "service_tickets"."priority._info.image_href" AS "priority._info.image_href", "service_tickets"."serviceLocation.id" AS "serviceLocation.id", "service_tickets"."serviceLocation.name" AS "serviceLocation.name", "service_tickets"."serviceLocation._info.location_href" AS "serviceLocation._info.location_href", "service_tickets"."source.id" AS "source.id", "service_tickets"."source.name" AS "source.name", "service_tickets"."source._info.source_href" AS "source._info.source_href", "service_tickets"."agreement.id" AS "agreement.id", "service_tickets"."agreement.name" AS "agreement.name", "service_tickets"."agreement._info.agreement_href" AS "agreement._info.agreement_href", "service_tickets"."severity" AS "severity", "service_tickets"."impact" AS "impact", "service_tickets"."allowAllClientsPortalView" AS "allowAllClientsPortalView", "service_tickets"."customerUpdatedFlag" AS "customerUpdatedFlag", "service_tickets"."automaticEmailContactFlag" AS "automaticEmailContactFlag", "service_tickets"."automaticEmailResourceFlag" AS "automaticEmailResourceFlag", "service_tickets"."automaticEmailCcFlag" AS "automaticEmailCcFlag", "service_tickets"."closedDate" AS "closedDate", "service_tickets"."closedBy" AS "closedBy", "service_tickets"."closedFlag" AS "closedFlag", "service_tickets"."actualHours" AS "actualHours", "service_tickets"."approved" AS "approved", "service_tickets"."estimatedExpenseCost" AS "estimatedExpenseCost", "service_tickets"."estimatedExpenseRevenue" AS "estimatedExpenseRevenue", "service_tickets"."estimatedProductCost" AS "estimatedProductCost", "service_tickets"."estimatedProductRevenue" AS "estimatedProductRevenue", "service_tickets"."estimatedTimeCost" AS "estimatedTimeCost", "service_tickets"."estimatedTimeRevenue" AS "estimatedTimeRevenue", "service_tickets"."billingMethod" AS "billingMethod", "service_tickets"."dateResplan" AS "dateResplan", "service_tickets"."dateResponded" AS "dateResponded", "service_tickets"."resolveMinutes" AS "resolveMinutes", "service_tickets"."resPlanMinutes" AS "resPlanMinutes", "service_tickets"."respondMinutes" AS "respondMinutes", "service_tickets"."isInSla" AS "isInSla", "service_tickets"."hasChildTicket" AS "hasChildTicket", "service_tickets"."hasMergedChildTicketFlag" AS "hasMergedChildTicketFlag", "service_tickets"."billTime" AS "billTime", "service_tickets"."billExpenses" AS "billExpenses", "service_tickets"."billProducts" AS "billProducts", "service_tickets"."location.id" AS "location.id(service_tickets)", "service_tickets"."location.name" AS "location.name(service_tickets)", "service_tickets"."location._info.location_href" AS "location._info.location_href(service_tickets)", "service_tickets"."department.id" AS "department.id(service_tickets)", "service_tickets"."department.identifier" AS "department.identifier(service_tickets)", "service_tickets"."department.name" AS "department.name(service_tickets)", "service_tickets"."department._info.department_href" AS "department._info.department_href(service_tickets)", "service_tickets"."mobileGuid" AS "mobileGuid(service_tickets)", "service_tickets"."sla.id" AS "sla.id", "service_tickets"."sla.name" AS "sla.name", "service_tickets"."sla._info.sla_href" AS "sla._info.sla_href", "service_tickets"."currency.id" AS "currency.id", "service_tickets"."currency.symbol" AS "currency.symbol", "service_tickets"."currency.currencyCode" AS "currency.currencyCode", "service_tickets"."currency.decimalSeparator" AS "currency.decimalSeparator", "service_tickets"."currency.numberOfDecimals" AS "currency.numberOfDecimals", "service_tickets"."currency.thousandsSeparator" AS "currency.thousandsSeparator", "service_tickets"."currency.negativeParenthesesFlag" AS "currency.negativeParenthesesFlag", "service_tickets"."currency.displaySymbolFlag" AS "currency.displaySymbolFlag", "service_tickets"."currency.currencyIdentifier" AS "currency.currencyIdentifier", "service_tickets"."currency.displayIdFlag" AS "currency.displayIdFlag", "service_tickets"."currency.rightAlign" AS "currency.rightAlign", "service_tickets"."currency.name" AS "currency.name", "service_tickets"."currency._info.currency_href" AS "currency._info.currency_href", "service_tickets"."_info.lastUpdated" AS "_info.lastUpdated(service_tickets)", "service_tickets"."_info.updatedBy" AS "_info.updatedBy(service_tickets)", "service_tickets"."_info.dateEntered" AS "_info.dateEntered(service_tickets)", "service_tickets"."_info.enteredBy" AS "_info.enteredBy(service_tickets)", "service_tickets"."_info.activities_href" AS "_info.activities_href(service_tickets)", "service_tickets"."_info.scheduleentries_href" AS "_info.scheduleentries_href", "service_tickets"."_info.documents_href" AS "_info.documents_href(service_tickets)", "service_tickets"."_info.configurations_href" AS "_info.configurations_href(service_tickets)", "service_tickets"."_info.tasks_href" AS "_info.tasks_href", "service_tickets"."_info.notes_href" AS "_info.notes_href(service_tickets)", "service_tickets"."_info.products_href" AS "_info.products_href", "service_tickets"."_info.timeentries_href" AS "_info.timeentries_href", "service_tickets"."_info.expenseEntries_href" AS "_info.expenseEntries_href", "service_tickets"."escalationStartDateUTC" AS "escalationStartDateUTC", "service_tickets"."escalationLevel" AS "escalationLevel", "service_tickets"."minutesBeforeWaiting" AS "minutesBeforeWaiting", "service_tickets"."respondedSkippedMinutes" AS "respondedSkippedMinutes", "service_tickets"."resplanSkippedMinutes" AS "resplanSkippedMinutes", "service_tickets"."respondedHours" AS "respondedHours", "service_tickets"."respondedBy" AS "respondedBy", "service_tickets"."resplanHours" AS "resplanHours", "service_tickets"."resplanBy" AS "resplanBy", "service_tickets"."resolutionHours" AS "resolutionHours", "service_tickets"."minutesWaiting" AS "minutesWaiting", "service_tickets"."workType.id" AS "workType.id", "service_tickets"."workType.name" AS "workType.name", "service_tickets"."workType._info.workType_href" AS "workType._info.workType_href", "service_tickets"."resources" AS "resources", "service_tickets"."workRole.id" AS "workRole.id", "service_tickets"."workRole.name" AS "workRole.name", "service_tickets"."workRole._info.workRole_href" AS "workRole._info.workRole_href", "service_tickets"."type.id" AS "type.id(service_tickets)", "service_tickets"."type.name" AS "type.name(service_tickets)", "service_tickets"."type._info.type_href" AS "type._info.type_href(service_tickets)", "service_tickets"."requiredDate" AS "requiredDate", "service_tickets"."budgetHours" AS "budgetHours", "service_tickets"."requestForChangeFlag" AS "requestForChangeFlag" FROM "Halops_Dash"."company_companies" AS "company_companies" INNER JOIN "Halops_Dash"."company_configurations" AS "company_configurations" ON "company_companies"."id" = "company_configurations"."id" INNER JOIN "Halops_Dash"."service_tickets" AS "service_tickets" ON "company_companies"."id" = "service_tickets"."id") temp_table GROUP BY "name", "estimatedProductCost", "name", "estimatedProductCost", "billTime", "billProducts", "currency.name" ORDER BY "name" ASC NULLS FIRST'''

shft_q3 = '''SELECT "name(company_configurations)" AS "name(company_configurations)", COUNT(DISTINCT "escalationLevel") AS "CNTD(escalationLevel)", CASE WHEN "approved" THEN 'True' ELSE 'False' END AS "approved", "severity" AS "severity" FROM (SELECT "company_companies"."id" AS "id", "company_companies"."identifier" AS "identifier", "company_companies"."name" AS "name", "company_companies"."status.id" AS "status.id", "company_companies"."status.name" AS "status.name", "company_companies"."status._info.status_href" AS "status._info.status_href", "company_companies"."country.id" AS "country.id", "company_companies"."country.name" AS "country.name", "company_companies"."country._info.country_href" AS "country._info.country_href", "company_companies"."phoneNumber" AS "phoneNumber", "company_companies"."website" AS "website", "company_companies"."territory.id" AS "territory.id", "company_companies"."territory.name" AS "territory.name", "company_companies"."territory._info.location_href" AS "territory._info.location_href", "company_companies"."market.id" AS "market.id", "company_companies"."market.name" AS "market.name", "company_companies"."market._info.Market_href" AS "market._info.Market_href", "company_companies"."defaultContact.id" AS "defaultContact.id", "company_companies"."defaultContact.name" AS "defaultContact.name", "company_companies"."defaultContact._info.contact_href" AS "defaultContact._info.contact_href", "company_companies"."dateAcquired" AS "dateAcquired", "company_companies"."annualRevenue" AS "annualRevenue", "company_companies"."timeZoneSetup.id" AS "timeZoneSetup.id", "company_companies"."timeZoneSetup.name" AS "timeZoneSetup.name", "company_companies"."timeZoneSetup._info.timeZoneSetup_href" AS "timeZoneSetup._info.timeZoneSetup_href", "company_companies"."leadFlag" AS "leadFlag", "company_companies"."unsubscribeFlag" AS "unsubscribeFlag", "company_companies"."taxCode.id" AS "taxCode.id", "company_companies"."taxCode.name" AS "taxCode.name", "company_companies"."taxCode._info.taxCode_href" AS "taxCode._info.taxCode_href", "company_companies"."billingTerms.id" AS "billingTerms.id", "company_companies"."billingTerms.name" AS "billingTerms.name", "company_companies"."billToCompany.id" AS "billToCompany.id", "company_companies"."billToCompany.identifier" AS "billToCompany.identifier", "company_companies"."billToCompany.name" AS "billToCompany.name", "company_companies"."billToCompany._info.company_href" AS "billToCompany._info.company_href", "company_companies"."invoiceDeliveryMethod.id" AS "invoiceDeliveryMethod.id", "company_companies"."invoiceDeliveryMethod.name" AS "invoiceDeliveryMethod.name", "company_companies"."deletedFlag" AS "deletedFlag", "company_companies"."mobileGuid" AS "mobileGuid", "company_companies"."isVendorFlag" AS "isVendorFlag", "company_companies"."types[0].id" AS "types[0].id", "company_companies"."types[0].name" AS "types[0].name", "company_companies"."types[0]._info.type_href" AS "types[0]._info.type_href", "company_companies"."site.id" AS "site.id", "company_companies"."site.name" AS "site.name", "company_companies"."site._info.site_href" AS "site._info.site_href", "company_companies"."_info.lastUpdated" AS "_info.lastUpdated", "company_companies"."_info.updatedBy" AS "_info.updatedBy", "company_companies"."_info.dateEntered" AS "_info.dateEntered", "company_companies"."_info.enteredBy" AS "_info.enteredBy", "company_companies"."_info.contacts_href" AS "_info.contacts_href", "company_companies"."_info.agreements_href" AS "_info.agreements_href", "company_companies"."_info.tickets_href" AS "_info.tickets_href", "company_companies"."_info.opportunities_href" AS "_info.opportunities_href", "company_companies"."_info.activities_href" AS "_info.activities_href", "company_companies"."_info.projects_href" AS "_info.projects_href", "company_companies"."_info.configurations_href" AS "_info.configurations_href", "company_companies"."_info.orders_href" AS "_info.orders_href", "company_companies"."_info.documents_href" AS "_info.documents_href", "company_companies"."_info.sites_href" AS "_info.sites_href", "company_companies"."_info.teams_href" AS "_info.teams_href", "company_companies"."_info.reports_href" AS "_info.reports_href", "company_companies"."_info.notes_href" AS "_info.notes_href", "company_companies"."addressLine1" AS "addressLine1", "company_companies"."addressLine2" AS "addressLine2", "company_companies"."city" AS "city", "company_companies"."state" AS "state", "company_companies"."zip" AS "zip", "company_companies"."faxNumber" AS "faxNumber", "company_companies"."accountNumber" AS "accountNumber", "company_companies"."numberOfEmployees" AS "numberOfEmployees", "company_companies"."leadSource" AS "leadSource", "company_companies"."billingContact.id" AS "billingContact.id", "company_companies"."billingContact.name" AS "billingContact.name", "company_companies"."billingContact._info.contact_href" AS "billingContact._info.contact_href", "company_companies"."invoiceToEmailAddress" AS "invoiceToEmailAddress", "company_companies"."billingSite.id" AS "billingSite.id", "company_companies"."billingSite.name" AS "billingSite.name", "company_companies"."billingSite._info.site_href" AS "billingSite._info.site_href", "company_configurations"."id" AS "id(company_configurations)", "company_configurations"."name" AS "name(company_configurations)", "company_configurations"."type.id" AS "type.id", "company_configurations"."type.name" AS "type.name", "company_configurations"."type._info.type_href" AS "type._info.type_href", "company_configurations"."status.id" AS "status.id(company_configurations)", "company_configurations"."status.name" AS "status.name(company_configurations)", "company_configurations"."status._info.status_href" AS "status._info.status_href(company_configurations)", "company_configurations"."company.id" AS "company.id", "company_configurations"."company.identifier" AS "company.identifier", "company_configurations"."company.name" AS "company.name", "company_configurations"."company._info.company_href" AS "company._info.company_href", "company_configurations"."contact.id" AS "contact.id", "company_configurations"."contact.name" AS "contact.name", "company_configurations"."contact._info.contact_href" AS "contact._info.contact_href", "company_configurations"."site.id" AS "site.id(company_configurations)", "company_configurations"."site.name" AS "site.name(company_configurations)", "company_configurations"."site._info.site_href" AS "site._info.site_href(company_configurations)", "company_configurations"."locationId" AS "locationId", "company_configurations"."location.id" AS "location.id", "company_configurations"."location.name" AS "location.name", "company_configurations"."location._info.location_href" AS "location._info.location_href", "company_configurations"."businessUnitId" AS "businessUnitId", "company_configurations"."department.id" AS "department.id", "company_configurations"."department.identifier" AS "department.identifier", "company_configurations"."department.name" AS "department.name", "company_configurations"."department._info.department_href" AS "department._info.department_href", "company_configurations"."serialNumber" AS "serialNumber", "company_configurations"."modelNumber" AS "modelNumber", "company_configurations"."tagNumber" AS "tagNumber", "company_configurations"."warrantyExpirationDate" AS "warrantyExpirationDate", "company_configurations"."notes" AS "notes", "company_configurations"."billFlag" AS "billFlag", "company_configurations"."vendor.id" AS "vendor.id", "company_configurations"."vendor.identifier" AS "vendor.identifier", "company_configurations"."vendor.name" AS "vendor.name", "company_configurations"."vendor._info.company_href" AS "vendor._info.company_href", "company_configurations"."activeFlag" AS "activeFlag", "company_configurations"."mobileGuid" AS "mobileGuid(company_configurations)", "company_configurations"."companyLocationId" AS "companyLocationId", "company_configurations"."showRemoteFlag" AS "showRemoteFlag", "company_configurations"."showAutomateFlag" AS "showAutomateFlag", "company_configurations"."needsRenewalFlag" AS "needsRenewalFlag", "company_configurations"."_info.lastUpdated" AS "_info.lastUpdated(company_configurations)", "company_configurations"."_info.updatedBy" AS "_info.updatedBy(company_configurations)", "company_configurations"."_info.dateEntered" AS "_info.dateEntered(company_configurations)", "company_configurations"."_info.enteredBy" AS "_info.enteredBy(company_configurations)", "company_configurations"."backupSuccesses" AS "backupSuccesses", "company_configurations"."backupIncomplete" AS "backupIncomplete", "company_configurations"."backupFailed" AS "backupFailed", "company_configurations"."backupRestores" AS "backupRestores", "company_configurations"."backupBillableSpaceGb" AS "backupBillableSpaceGb", "company_configurations"."backupYear" AS "backupYear", "company_configurations"."backupMonth" AS "backupMonth", "service_tickets"."id" AS "id(service_tickets)", "service_tickets"."summary" AS "summary", "service_tickets"."recordType" AS "recordType", "service_tickets"."board.id" AS "board.id", "service_tickets"."board.name" AS "board.name", "service_tickets"."board._info.board_href" AS "board._info.board_href", "service_tickets"."status.id" AS "status.id(service_tickets)", "service_tickets"."status.name" AS "status.name(service_tickets)", "service_tickets"."status.Sort" AS "status.Sort", "service_tickets"."status._info.status_href" AS "status._info.status_href(service_tickets)", "service_tickets"."company.id" AS "company.id(service_tickets)", "service_tickets"."company.identifier" AS "company.identifier(service_tickets)", "service_tickets"."company.name" AS "company.name(service_tickets)", "service_tickets"."company._info.company_href" AS "company._info.company_href(service_tickets)", "service_tickets"."company._info.mobileGuid" AS "company._info.mobileGuid", "service_tickets"."site.id" AS "site.id(service_tickets)", "service_tickets"."site.name" AS "site.name(service_tickets)", "service_tickets"."site._info.site_href" AS "site._info.site_href(service_tickets)", "service_tickets"."site._info.mobileGuid" AS "site._info.mobileGuid", "service_tickets"."addressLine1" AS "addressLine1(service_tickets)", "service_tickets"."addressLine2" AS "addressLine2(service_tickets)", "service_tickets"."city" AS "city(service_tickets)", "service_tickets"."stateIdentifier" AS "stateIdentifier", "service_tickets"."zip" AS "zip(service_tickets)", "service_tickets"."contact.id" AS "contact.id(service_tickets)", "service_tickets"."contact.name" AS "contact.name(service_tickets)", "service_tickets"."contact._info.mobileGuid" AS "contact._info.mobileGuid", "service_tickets"."contact._info.contact_href" AS "contact._info.contact_href(service_tickets)", "service_tickets"."contactName" AS "contactName", "service_tickets"."contactPhoneNumber" AS "contactPhoneNumber", "service_tickets"."contactPhoneExtension" AS "contactPhoneExtension", "service_tickets"."contactEmailAddress" AS "contactEmailAddress", "service_tickets"."team.id" AS "team.id", "service_tickets"."team.name" AS "team.name", "service_tickets"."team._info.team_href" AS "team._info.team_href", "service_tickets"."priority.id" AS "priority.id", "service_tickets"."priority.name" AS "priority.name", "service_tickets"."priority.sort" AS "priority.sort", "service_tickets"."priority._info.priority_href" AS "priority._info.priority_href", "service_tickets"."priority._info.image_href" AS "priority._info.image_href", "service_tickets"."serviceLocation.id" AS "serviceLocation.id", "service_tickets"."serviceLocation.name" AS "serviceLocation.name", "service_tickets"."serviceLocation._info.location_href" AS "serviceLocation._info.location_href", "service_tickets"."source.id" AS "source.id", "service_tickets"."source.name" AS "source.name", "service_tickets"."source._info.source_href" AS "source._info.source_href", "service_tickets"."agreement.id" AS "agreement.id", "service_tickets"."agreement.name" AS "agreement.name", "service_tickets"."agreement._info.agreement_href" AS "agreement._info.agreement_href", "service_tickets"."severity" AS "severity", "service_tickets"."impact" AS "impact", "service_tickets"."allowAllClientsPortalView" AS "allowAllClientsPortalView", "service_tickets"."customerUpdatedFlag" AS "customerUpdatedFlag", "service_tickets"."automaticEmailContactFlag" AS "automaticEmailContactFlag", "service_tickets"."automaticEmailResourceFlag" AS "automaticEmailResourceFlag", "service_tickets"."automaticEmailCcFlag" AS "automaticEmailCcFlag", "service_tickets"."closedDate" AS "closedDate", "service_tickets"."closedBy" AS "closedBy", "service_tickets"."closedFlag" AS "closedFlag", "service_tickets"."actualHours" AS "actualHours", "service_tickets"."approved" AS "approved", "service_tickets"."estimatedExpenseCost" AS "estimatedExpenseCost", "service_tickets"."estimatedExpenseRevenue" AS "estimatedExpenseRevenue", "service_tickets"."estimatedProductCost" AS "estimatedProductCost", "service_tickets"."estimatedProductRevenue" AS "estimatedProductRevenue", "service_tickets"."estimatedTimeCost" AS "estimatedTimeCost", "service_tickets"."estimatedTimeRevenue" AS "estimatedTimeRevenue", "service_tickets"."billingMethod" AS "billingMethod", "service_tickets"."dateResplan" AS "dateResplan", "service_tickets"."dateResponded" AS "dateResponded", "service_tickets"."resolveMinutes" AS "resolveMinutes", "service_tickets"."resPlanMinutes" AS "resPlanMinutes", "service_tickets"."respondMinutes" AS "respondMinutes", "service_tickets"."isInSla" AS "isInSla", "service_tickets"."hasChildTicket" AS "hasChildTicket", "service_tickets"."hasMergedChildTicketFlag" AS "hasMergedChildTicketFlag", "service_tickets"."billTime" AS "billTime", "service_tickets"."billExpenses" AS "billExpenses", "service_tickets"."billProducts" AS "billProducts", "service_tickets"."location.id" AS "location.id(service_tickets)", "service_tickets"."location.name" AS "location.name(service_tickets)", "service_tickets"."location._info.location_href" AS "location._info.location_href(service_tickets)", "service_tickets"."department.id" AS "department.id(service_tickets)", "service_tickets"."department.identifier" AS "department.identifier(service_tickets)", "service_tickets"."department.name" AS "department.name(service_tickets)", "service_tickets"."department._info.department_href" AS "department._info.department_href(service_tickets)", "service_tickets"."mobileGuid" AS "mobileGuid(service_tickets)", "service_tickets"."sla.id" AS "sla.id", "service_tickets"."sla.name" AS "sla.name", "service_tickets"."sla._info.sla_href" AS "sla._info.sla_href", "service_tickets"."currency.id" AS "currency.id", "service_tickets"."currency.symbol" AS "currency.symbol", "service_tickets"."currency.currencyCode" AS "currency.currencyCode", "service_tickets"."currency.decimalSeparator" AS "currency.decimalSeparator", "service_tickets"."currency.numberOfDecimals" AS "currency.numberOfDecimals", "service_tickets"."currency.thousandsSeparator" AS "currency.thousandsSeparator", "service_tickets"."currency.negativeParenthesesFlag" AS "currency.negativeParenthesesFlag", "service_tickets"."currency.displaySymbolFlag" AS "currency.displaySymbolFlag", "service_tickets"."currency.currencyIdentifier" AS "currency.currencyIdentifier", "service_tickets"."currency.displayIdFlag" AS "currency.displayIdFlag", "service_tickets"."currency.rightAlign" AS "currency.rightAlign", "service_tickets"."currency.name" AS "currency.name", "service_tickets"."currency._info.currency_href" AS "currency._info.currency_href", "service_tickets"."_info.lastUpdated" AS "_info.lastUpdated(service_tickets)", "service_tickets"."_info.updatedBy" AS "_info.updatedBy(service_tickets)", "service_tickets"."_info.dateEntered" AS "_info.dateEntered(service_tickets)", "service_tickets"."_info.enteredBy" AS "_info.enteredBy(service_tickets)", "service_tickets"."_info.activities_href" AS "_info.activities_href(service_tickets)", "service_tickets"."_info.scheduleentries_href" AS "_info.scheduleentries_href", "service_tickets"."_info.documents_href" AS "_info.documents_href(service_tickets)", "service_tickets"."_info.configurations_href" AS "_info.configurations_href(service_tickets)", "service_tickets"."_info.tasks_href" AS "_info.tasks_href", "service_tickets"."_info.notes_href" AS "_info.notes_href(service_tickets)", "service_tickets"."_info.products_href" AS "_info.products_href", "service_tickets"."_info.timeentries_href" AS "_info.timeentries_href", "service_tickets"."_info.expenseEntries_href" AS "_info.expenseEntries_href", "service_tickets"."escalationStartDateUTC" AS "escalationStartDateUTC", "service_tickets"."escalationLevel" AS "escalationLevel", "service_tickets"."minutesBeforeWaiting" AS "minutesBeforeWaiting", "service_tickets"."respondedSkippedMinutes" AS "respondedSkippedMinutes", "service_tickets"."resplanSkippedMinutes" AS "resplanSkippedMinutes", "service_tickets"."respondedHours" AS "respondedHours", "service_tickets"."respondedBy" AS "respondedBy", "service_tickets"."resplanHours" AS "resplanHours", "service_tickets"."resplanBy" AS "resplanBy", "service_tickets"."resolutionHours" AS "resolutionHours", "service_tickets"."minutesWaiting" AS "minutesWaiting", "service_tickets"."workType.id" AS "workType.id", "service_tickets"."workType.name" AS "workType.name", "service_tickets"."workType._info.workType_href" AS "workType._info.workType_href", "service_tickets"."resources" AS "resources", "service_tickets"."workRole.id" AS "workRole.id", "service_tickets"."workRole.name" AS "workRole.name", "service_tickets"."workRole._info.workRole_href" AS "workRole._info.workRole_href", "service_tickets"."type.id" AS "type.id(service_tickets)", "service_tickets"."type.name" AS "type.name(service_tickets)", "service_tickets"."type._info.type_href" AS "type._info.type_href(service_tickets)", "service_tickets"."requiredDate" AS "requiredDate", "service_tickets"."budgetHours" AS "budgetHours", "service_tickets"."requestForChangeFlag" AS "requestForChangeFlag" FROM "Halops_Dash"."company_companies" AS "company_companies" INNER JOIN "Halops_Dash"."company_configurations" AS "company_configurations" ON "company_companies"."id" = "company_configurations"."id" INNER JOIN "Halops_Dash"."service_tickets" AS "service_tickets" ON "company_companies"."id" = "service_tickets"."id") temp_table GROUP BY "name(company_configurations)", "name(company_configurations)", "approved", "severity" ORDER BY "name(company_configurations)" ASC NULLS FIRST'''

shft_q4 = '''SELECT "name(company_configurations)" AS "name(company_configurations)", COUNT("actualHours") AS "count(actualHours)", COUNT("respondedHours") AS "count(respondedHours)", COUNT("budgetHours") AS "count(budgetHours)" FROM (SELECT "company_companies"."id" AS "id", "company_companies"."identifier" AS "identifier", "company_companies"."name" AS "name", "company_companies"."status.id" AS "status.id", "company_companies"."status.name" AS "status.name", "company_companies"."status._info.status_href" AS "status._info.status_href", "company_companies"."country.id" AS "country.id", "company_companies"."country.name" AS "country.name", "company_companies"."country._info.country_href" AS "country._info.country_href", "company_companies"."phoneNumber" AS "phoneNumber", "company_companies"."website" AS "website", "company_companies"."territory.id" AS "territory.id", "company_companies"."territory.name" AS "territory.name", "company_companies"."territory._info.location_href" AS "territory._info.location_href", "company_companies"."market.id" AS "market.id", "company_companies"."market.name" AS "market.name", "company_companies"."market._info.Market_href" AS "market._info.Market_href", "company_companies"."defaultContact.id" AS "defaultContact.id", "company_companies"."defaultContact.name" AS "defaultContact.name", "company_companies"."defaultContact._info.contact_href" AS "defaultContact._info.contact_href", "company_companies"."dateAcquired" AS "dateAcquired", "company_companies"."annualRevenue" AS "annualRevenue", "company_companies"."timeZoneSetup.id" AS "timeZoneSetup.id", "company_companies"."timeZoneSetup.name" AS "timeZoneSetup.name", "company_companies"."timeZoneSetup._info.timeZoneSetup_href" AS "timeZoneSetup._info.timeZoneSetup_href", "company_companies"."leadFlag" AS "leadFlag", "company_companies"."unsubscribeFlag" AS "unsubscribeFlag", "company_companies"."taxCode.id" AS "taxCode.id", "company_companies"."taxCode.name" AS "taxCode.name", "company_companies"."taxCode._info.taxCode_href" AS "taxCode._info.taxCode_href", "company_companies"."billingTerms.id" AS "billingTerms.id", "company_companies"."billingTerms.name" AS "billingTerms.name", "company_companies"."billToCompany.id" AS "billToCompany.id", "company_companies"."billToCompany.identifier" AS "billToCompany.identifier", "company_companies"."billToCompany.name" AS "billToCompany.name", "company_companies"."billToCompany._info.company_href" AS "billToCompany._info.company_href", "company_companies"."invoiceDeliveryMethod.id" AS "invoiceDeliveryMethod.id", "company_companies"."invoiceDeliveryMethod.name" AS "invoiceDeliveryMethod.name", "company_companies"."deletedFlag" AS "deletedFlag", "company_companies"."mobileGuid" AS "mobileGuid", "company_companies"."isVendorFlag" AS "isVendorFlag", "company_companies"."types[0].id" AS "types[0].id", "company_companies"."types[0].name" AS "types[0].name", "company_companies"."types[0]._info.type_href" AS "types[0]._info.type_href", "company_companies"."site.id" AS "site.id", "company_companies"."site.name" AS "site.name", "company_companies"."site._info.site_href" AS "site._info.site_href", "company_companies"."_info.lastUpdated" AS "_info.lastUpdated", "company_companies"."_info.updatedBy" AS "_info.updatedBy", "company_companies"."_info.dateEntered" AS "_info.dateEntered", "company_companies"."_info.enteredBy" AS "_info.enteredBy", "company_companies"."_info.contacts_href" AS "_info.contacts_href", "company_companies"."_info.agreements_href" AS "_info.agreements_href", "company_companies"."_info.tickets_href" AS "_info.tickets_href", "company_companies"."_info.opportunities_href" AS "_info.opportunities_href", "company_companies"."_info.activities_href" AS "_info.activities_href", "company_companies"."_info.projects_href" AS "_info.projects_href", "company_companies"."_info.configurations_href" AS "_info.configurations_href", "company_companies"."_info.orders_href" AS "_info.orders_href", "company_companies"."_info.documents_href" AS "_info.documents_href", "company_companies"."_info.sites_href" AS "_info.sites_href", "company_companies"."_info.teams_href" AS "_info.teams_href", "company_companies"."_info.reports_href" AS "_info.reports_href", "company_companies"."_info.notes_href" AS "_info.notes_href", "company_companies"."addressLine1" AS "addressLine1", "company_companies"."addressLine2" AS "addressLine2", "company_companies"."city" AS "city", "company_companies"."state" AS "state", "company_companies"."zip" AS "zip", "company_companies"."faxNumber" AS "faxNumber", "company_companies"."accountNumber" AS "accountNumber", "company_companies"."numberOfEmployees" AS "numberOfEmployees", "company_companies"."leadSource" AS "leadSource", "company_companies"."billingContact.id" AS "billingContact.id", "company_companies"."billingContact.name" AS "billingContact.name", "company_companies"."billingContact._info.contact_href" AS "billingContact._info.contact_href", "company_companies"."invoiceToEmailAddress" AS "invoiceToEmailAddress", "company_companies"."billingSite.id" AS "billingSite.id", "company_companies"."billingSite.name" AS "billingSite.name", "company_companies"."billingSite._info.site_href" AS "billingSite._info.site_href", "company_configurations"."id" AS "id(company_configurations)", "company_configurations"."name" AS "name(company_configurations)", "company_configurations"."type.id" AS "type.id", "company_configurations"."type.name" AS "type.name", "company_configurations"."type._info.type_href" AS "type._info.type_href", "company_configurations"."status.id" AS "status.id(company_configurations)", "company_configurations"."status.name" AS "status.name(company_configurations)", "company_configurations"."status._info.status_href" AS "status._info.status_href(company_configurations)", "company_configurations"."company.id" AS "company.id", "company_configurations"."company.identifier" AS "company.identifier", "company_configurations"."company.name" AS "company.name", "company_configurations"."company._info.company_href" AS "company._info.company_href", "company_configurations"."contact.id" AS "contact.id", "company_configurations"."contact.name" AS "contact.name", "company_configurations"."contact._info.contact_href" AS "contact._info.contact_href", "company_configurations"."site.id" AS "site.id(company_configurations)", "company_configurations"."site.name" AS "site.name(company_configurations)", "company_configurations"."site._info.site_href" AS "site._info.site_href(company_configurations)", "company_configurations"."locationId" AS "locationId", "company_configurations"."location.id" AS "location.id", "company_configurations"."location.name" AS "location.name", "company_configurations"."location._info.location_href" AS "location._info.location_href", "company_configurations"."businessUnitId" AS "businessUnitId", "company_configurations"."department.id" AS "department.id", "company_configurations"."department.identifier" AS "department.identifier", "company_configurations"."department.name" AS "department.name", "company_configurations"."department._info.department_href" AS "department._info.department_href", "company_configurations"."serialNumber" AS "serialNumber", "company_configurations"."modelNumber" AS "modelNumber", "company_configurations"."tagNumber" AS "tagNumber", "company_configurations"."warrantyExpirationDate" AS "warrantyExpirationDate", "company_configurations"."notes" AS "notes", "company_configurations"."billFlag" AS "billFlag", "company_configurations"."vendor.id" AS "vendor.id", "company_configurations"."vendor.identifier" AS "vendor.identifier", "company_configurations"."vendor.name" AS "vendor.name", "company_configurations"."vendor._info.company_href" AS "vendor._info.company_href", "company_configurations"."activeFlag" AS "activeFlag", "company_configurations"."mobileGuid" AS "mobileGuid(company_configurations)", "company_configurations"."companyLocationId" AS "companyLocationId", "company_configurations"."showRemoteFlag" AS "showRemoteFlag", "company_configurations"."showAutomateFlag" AS "showAutomateFlag", "company_configurations"."needsRenewalFlag" AS "needsRenewalFlag", "company_configurations"."_info.lastUpdated" AS "_info.lastUpdated(company_configurations)", "company_configurations"."_info.updatedBy" AS "_info.updatedBy(company_configurations)", "company_configurations"."_info.dateEntered" AS "_info.dateEntered(company_configurations)", "company_configurations"."_info.enteredBy" AS "_info.enteredBy(company_configurations)", "company_configurations"."backupSuccesses" AS "backupSuccesses", "company_configurations"."backupIncomplete" AS "backupIncomplete", "company_configurations"."backupFailed" AS "backupFailed", "company_configurations"."backupRestores" AS "backupRestores", "company_configurations"."backupBillableSpaceGb" AS "backupBillableSpaceGb", "company_configurations"."backupYear" AS "backupYear", "company_configurations"."backupMonth" AS "backupMonth", "service_tickets"."id" AS "id(service_tickets)", "service_tickets"."summary" AS "summary", "service_tickets"."recordType" AS "recordType", "service_tickets"."board.id" AS "board.id", "service_tickets"."board.name" AS "board.name", "service_tickets"."board._info.board_href" AS "board._info.board_href", "service_tickets"."status.id" AS "status.id(service_tickets)", "service_tickets"."status.name" AS "status.name(service_tickets)", "service_tickets"."status.Sort" AS "status.Sort", "service_tickets"."status._info.status_href" AS "status._info.status_href(service_tickets)", "service_tickets"."company.id" AS "company.id(service_tickets)", "service_tickets"."company.identifier" AS "company.identifier(service_tickets)", "service_tickets"."company.name" AS "company.name(service_tickets)", "service_tickets"."company._info.company_href" AS "company._info.company_href(service_tickets)", "service_tickets"."company._info.mobileGuid" AS "company._info.mobileGuid", "service_tickets"."site.id" AS "site.id(service_tickets)", "service_tickets"."site.name" AS "site.name(service_tickets)", "service_tickets"."site._info.site_href" AS "site._info.site_href(service_tickets)", "service_tickets"."site._info.mobileGuid" AS "site._info.mobileGuid", "service_tickets"."addressLine1" AS "addressLine1(service_tickets)", "service_tickets"."addressLine2" AS "addressLine2(service_tickets)", "service_tickets"."city" AS "city(service_tickets)", "service_tickets"."stateIdentifier" AS "stateIdentifier", "service_tickets"."zip" AS "zip(service_tickets)", "service_tickets"."contact.id" AS "contact.id(service_tickets)", "service_tickets"."contact.name" AS "contact.name(service_tickets)", "service_tickets"."contact._info.mobileGuid" AS "contact._info.mobileGuid", "service_tickets"."contact._info.contact_href" AS "contact._info.contact_href(service_tickets)", "service_tickets"."contactName" AS "contactName", "service_tickets"."contactPhoneNumber" AS "contactPhoneNumber", "service_tickets"."contactPhoneExtension" AS "contactPhoneExtension", "service_tickets"."contactEmailAddress" AS "contactEmailAddress", "service_tickets"."team.id" AS "team.id", "service_tickets"."team.name" AS "team.name", "service_tickets"."team._info.team_href" AS "team._info.team_href", "service_tickets"."priority.id" AS "priority.id", "service_tickets"."priority.name" AS "priority.name", "service_tickets"."priority.sort" AS "priority.sort", "service_tickets"."priority._info.priority_href" AS "priority._info.priority_href", "service_tickets"."priority._info.image_href" AS "priority._info.image_href", "service_tickets"."serviceLocation.id" AS "serviceLocation.id", "service_tickets"."serviceLocation.name" AS "serviceLocation.name", "service_tickets"."serviceLocation._info.location_href" AS "serviceLocation._info.location_href", "service_tickets"."source.id" AS "source.id", "service_tickets"."source.name" AS "source.name", "service_tickets"."source._info.source_href" AS "source._info.source_href", "service_tickets"."agreement.id" AS "agreement.id", "service_tickets"."agreement.name" AS "agreement.name", "service_tickets"."agreement._info.agreement_href" AS "agreement._info.agreement_href", "service_tickets"."severity" AS "severity", "service_tickets"."impact" AS "impact", "service_tickets"."allowAllClientsPortalView" AS "allowAllClientsPortalView", "service_tickets"."customerUpdatedFlag" AS "customerUpdatedFlag", "service_tickets"."automaticEmailContactFlag" AS "automaticEmailContactFlag", "service_tickets"."automaticEmailResourceFlag" AS "automaticEmailResourceFlag", "service_tickets"."automaticEmailCcFlag" AS "automaticEmailCcFlag", "service_tickets"."closedDate" AS "closedDate", "service_tickets"."closedBy" AS "closedBy", "service_tickets"."closedFlag" AS "closedFlag", "service_tickets"."actualHours" AS "actualHours", "service_tickets"."approved" AS "approved", "service_tickets"."estimatedExpenseCost" AS "estimatedExpenseCost", "service_tickets"."estimatedExpenseRevenue" AS "estimatedExpenseRevenue", "service_tickets"."estimatedProductCost" AS "estimatedProductCost", "service_tickets"."estimatedProductRevenue" AS "estimatedProductRevenue", "service_tickets"."estimatedTimeCost" AS "estimatedTimeCost", "service_tickets"."estimatedTimeRevenue" AS "estimatedTimeRevenue", "service_tickets"."billingMethod" AS "billingMethod", "service_tickets"."dateResplan" AS "dateResplan", "service_tickets"."dateResponded" AS "dateResponded", "service_tickets"."resolveMinutes" AS "resolveMinutes", "service_tickets"."resPlanMinutes" AS "resPlanMinutes", "service_tickets"."respondMinutes" AS "respondMinutes", "service_tickets"."isInSla" AS "isInSla", "service_tickets"."hasChildTicket" AS "hasChildTicket", "service_tickets"."hasMergedChildTicketFlag" AS "hasMergedChildTicketFlag", "service_tickets"."billTime" AS "billTime", "service_tickets"."billExpenses" AS "billExpenses", "service_tickets"."billProducts" AS "billProducts", "service_tickets"."location.id" AS "location.id(service_tickets)", "service_tickets"."location.name" AS "location.name(service_tickets)", "service_tickets"."location._info.location_href" AS "location._info.location_href(service_tickets)", "service_tickets"."department.id" AS "department.id(service_tickets)", "service_tickets"."department.identifier" AS "department.identifier(service_tickets)", "service_tickets"."department.name" AS "department.name(service_tickets)", "service_tickets"."department._info.department_href" AS "department._info.department_href(service_tickets)", "service_tickets"."mobileGuid" AS "mobileGuid(service_tickets)", "service_tickets"."sla.id" AS "sla.id", "service_tickets"."sla.name" AS "sla.name", "service_tickets"."sla._info.sla_href" AS "sla._info.sla_href", "service_tickets"."currency.id" AS "currency.id", "service_tickets"."currency.symbol" AS "currency.symbol", "service_tickets"."currency.currencyCode" AS "currency.currencyCode", "service_tickets"."currency.decimalSeparator" AS "currency.decimalSeparator", "service_tickets"."currency.numberOfDecimals" AS "currency.numberOfDecimals", "service_tickets"."currency.thousandsSeparator" AS "currency.thousandsSeparator", "service_tickets"."currency.negativeParenthesesFlag" AS "currency.negativeParenthesesFlag", "service_tickets"."currency.displaySymbolFlag" AS "currency.displaySymbolFlag", "service_tickets"."currency.currencyIdentifier" AS "currency.currencyIdentifier", "service_tickets"."currency.displayIdFlag" AS "currency.displayIdFlag", "service_tickets"."currency.rightAlign" AS "currency.rightAlign", "service_tickets"."currency.name" AS "currency.name", "service_tickets"."currency._info.currency_href" AS "currency._info.currency_href", "service_tickets"."_info.lastUpdated" AS "_info.lastUpdated(service_tickets)", "service_tickets"."_info.updatedBy" AS "_info.updatedBy(service_tickets)", "service_tickets"."_info.dateEntered" AS "_info.dateEntered(service_tickets)", "service_tickets"."_info.enteredBy" AS "_info.enteredBy(service_tickets)", "service_tickets"."_info.activities_href" AS "_info.activities_href(service_tickets)", "service_tickets"."_info.scheduleentries_href" AS "_info.scheduleentries_href", "service_tickets"."_info.documents_href" AS "_info.documents_href(service_tickets)", "service_tickets"."_info.configurations_href" AS "_info.configurations_href(service_tickets)", "service_tickets"."_info.tasks_href" AS "_info.tasks_href", "service_tickets"."_info.notes_href" AS "_info.notes_href(service_tickets)", "service_tickets"."_info.products_href" AS "_info.products_href", "service_tickets"."_info.timeentries_href" AS "_info.timeentries_href", "service_tickets"."_info.expenseEntries_href" AS "_info.expenseEntries_href", "service_tickets"."escalationStartDateUTC" AS "escalationStartDateUTC", "service_tickets"."escalationLevel" AS "escalationLevel", "service_tickets"."minutesBeforeWaiting" AS "minutesBeforeWaiting", "service_tickets"."respondedSkippedMinutes" AS "respondedSkippedMinutes", "service_tickets"."resplanSkippedMinutes" AS "resplanSkippedMinutes", "service_tickets"."respondedHours" AS "respondedHours", "service_tickets"."respondedBy" AS "respondedBy", "service_tickets"."resplanHours" AS "resplanHours", "service_tickets"."resplanBy" AS "resplanBy", "service_tickets"."resolutionHours" AS "resolutionHours", "service_tickets"."minutesWaiting" AS "minutesWaiting", "service_tickets"."workType.id" AS "workType.id", "service_tickets"."workType.name" AS "workType.name", "service_tickets"."workType._info.workType_href" AS "workType._info.workType_href", "service_tickets"."resources" AS "resources", "service_tickets"."workRole.id" AS "workRole.id", "service_tickets"."workRole.name" AS "workRole.name", "service_tickets"."workRole._info.workRole_href" AS "workRole._info.workRole_href", "service_tickets"."type.id" AS "type.id(service_tickets)", "service_tickets"."type.name" AS "type.name(service_tickets)", "service_tickets"."type._info.type_href" AS "type._info.type_href(service_tickets)", "service_tickets"."requiredDate" AS "requiredDate", "service_tickets"."budgetHours" AS "budgetHours", "service_tickets"."requestForChangeFlag" AS "requestForChangeFlag" FROM "Halops_Dash"."company_companies" AS "company_companies" INNER JOIN "Halops_Dash"."company_configurations" AS "company_configurations" ON "company_companies"."id" = "company_configurations"."id" INNER JOIN "Halops_Dash"."service_tickets" AS "service_tickets" ON "company_companies"."id" = "service_tickets"."id") temp_table GROUP BY "name(company_configurations)", "name(company_configurations)" ORDER BY "name(company_configurations)" ASC NULLS FIRST'''

shft_q5 = '''SELECT "name" AS "name", SUM("annualRevenue") AS "sum(annualRevenue)" FROM (SELECT "company_companies"."id" AS "id", "company_companies"."identifier" AS "identifier", "company_companies"."name" AS "name", "company_companies"."status.id" AS "status.id", "company_companies"."status.name" AS "status.name", "company_companies"."status._info.status_href" AS "status._info.status_href", "company_companies"."country.id" AS "country.id", "company_companies"."country.name" AS "country.name", "company_companies"."country._info.country_href" AS "country._info.country_href", "company_companies"."phoneNumber" AS "phoneNumber", "company_companies"."website" AS "website", "company_companies"."territory.id" AS "territory.id", "company_companies"."territory.name" AS "territory.name", "company_companies"."territory._info.location_href" AS "territory._info.location_href", "company_companies"."market.id" AS "market.id", "company_companies"."market.name" AS "market.name", "company_companies"."market._info.Market_href" AS "market._info.Market_href", "company_companies"."defaultContact.id" AS "defaultContact.id", "company_companies"."defaultContact.name" AS "defaultContact.name", "company_companies"."defaultContact._info.contact_href" AS "defaultContact._info.contact_href", "company_companies"."dateAcquired" AS "dateAcquired", "company_companies"."annualRevenue" AS "annualRevenue", "company_companies"."timeZoneSetup.id" AS "timeZoneSetup.id", "company_companies"."timeZoneSetup.name" AS "timeZoneSetup.name", "company_companies"."timeZoneSetup._info.timeZoneSetup_href" AS "timeZoneSetup._info.timeZoneSetup_href", "company_companies"."leadFlag" AS "leadFlag", "company_companies"."unsubscribeFlag" AS "unsubscribeFlag", "company_companies"."taxCode.id" AS "taxCode.id", "company_companies"."taxCode.name" AS "taxCode.name", "company_companies"."taxCode._info.taxCode_href" AS "taxCode._info.taxCode_href", "company_companies"."billingTerms.id" AS "billingTerms.id", "company_companies"."billingTerms.name" AS "billingTerms.name", "company_companies"."billToCompany.id" AS "billToCompany.id", "company_companies"."billToCompany.identifier" AS "billToCompany.identifier", "company_companies"."billToCompany.name" AS "billToCompany.name", "company_companies"."billToCompany._info.company_href" AS "billToCompany._info.company_href", "company_companies"."invoiceDeliveryMethod.id" AS "invoiceDeliveryMethod.id", "company_companies"."invoiceDeliveryMethod.name" AS "invoiceDeliveryMethod.name", "company_companies"."deletedFlag" AS "deletedFlag", "company_companies"."mobileGuid" AS "mobileGuid", "company_companies"."isVendorFlag" AS "isVendorFlag", "company_companies"."types[0].id" AS "types[0].id", "company_companies"."types[0].name" AS "types[0].name", "company_companies"."types[0]._info.type_href" AS "types[0]._info.type_href", "company_companies"."site.id" AS "site.id", "company_companies"."site.name" AS "site.name", "company_companies"."site._info.site_href" AS "site._info.site_href", "company_companies"."_info.lastUpdated" AS "_info.lastUpdated", "company_companies"."_info.updatedBy" AS "_info.updatedBy", "company_companies"."_info.dateEntered" AS "_info.dateEntered", "company_companies"."_info.enteredBy" AS "_info.enteredBy", "company_companies"."_info.contacts_href" AS "_info.contacts_href", "company_companies"."_info.agreements_href" AS "_info.agreements_href", "company_companies"."_info.tickets_href" AS "_info.tickets_href", "company_companies"."_info.opportunities_href" AS "_info.opportunities_href", "company_companies"."_info.activities_href" AS "_info.activities_href", "company_companies"."_info.projects_href" AS "_info.projects_href", "company_companies"."_info.configurations_href" AS "_info.configurations_href", "company_companies"."_info.orders_href" AS "_info.orders_href", "company_companies"."_info.documents_href" AS "_info.documents_href", "company_companies"."_info.sites_href" AS "_info.sites_href", "company_companies"."_info.teams_href" AS "_info.teams_href", "company_companies"."_info.reports_href" AS "_info.reports_href", "company_companies"."_info.notes_href" AS "_info.notes_href", "company_companies"."addressLine1" AS "addressLine1", "company_companies"."addressLine2" AS "addressLine2", "company_companies"."city" AS "city", "company_companies"."state" AS "state", "company_companies"."zip" AS "zip", "company_companies"."faxNumber" AS "faxNumber", "company_companies"."accountNumber" AS "accountNumber", "company_companies"."numberOfEmployees" AS "numberOfEmployees", "company_companies"."leadSource" AS "leadSource", "company_companies"."billingContact.id" AS "billingContact.id", "company_companies"."billingContact.name" AS "billingContact.name", "company_companies"."billingContact._info.contact_href" AS "billingContact._info.contact_href", "company_companies"."invoiceToEmailAddress" AS "invoiceToEmailAddress", "company_companies"."billingSite.id" AS "billingSite.id", "company_companies"."billingSite.name" AS "billingSite.name", "company_companies"."billingSite._info.site_href" AS "billingSite._info.site_href", "company_configurations"."id" AS "id(company_configurations)", "company_configurations"."name" AS "name(company_configurations)", "company_configurations"."type.id" AS "type.id", "company_configurations"."type.name" AS "type.name", "company_configurations"."type._info.type_href" AS "type._info.type_href", "company_configurations"."status.id" AS "status.id(company_configurations)", "company_configurations"."status.name" AS "status.name(company_configurations)", "company_configurations"."status._info.status_href" AS "status._info.status_href(company_configurations)", "company_configurations"."company.id" AS "company.id", "company_configurations"."company.identifier" AS "company.identifier", "company_configurations"."company.name" AS "company.name", "company_configurations"."company._info.company_href" AS "company._info.company_href", "company_configurations"."contact.id" AS "contact.id", "company_configurations"."contact.name" AS "contact.name", "company_configurations"."contact._info.contact_href" AS "contact._info.contact_href", "company_configurations"."site.id" AS "site.id(company_configurations)", "company_configurations"."site.name" AS "site.name(company_configurations)", "company_configurations"."site._info.site_href" AS "site._info.site_href(company_configurations)", "company_configurations"."locationId" AS "locationId", "company_configurations"."location.id" AS "location.id", "company_configurations"."location.name" AS "location.name", "company_configurations"."location._info.location_href" AS "location._info.location_href", "company_configurations"."businessUnitId" AS "businessUnitId", "company_configurations"."department.id" AS "department.id", "company_configurations"."department.identifier" AS "department.identifier", "company_configurations"."department.name" AS "department.name", "company_configurations"."department._info.department_href" AS "department._info.department_href", "company_configurations"."serialNumber" AS "serialNumber", "company_configurations"."modelNumber" AS "modelNumber", "company_configurations"."tagNumber" AS "tagNumber", "company_configurations"."warrantyExpirationDate" AS "warrantyExpirationDate", "company_configurations"."notes" AS "notes", "company_configurations"."billFlag" AS "billFlag", "company_configurations"."vendor.id" AS "vendor.id", "company_configurations"."vendor.identifier" AS "vendor.identifier", "company_configurations"."vendor.name" AS "vendor.name", "company_configurations"."vendor._info.company_href" AS "vendor._info.company_href", "company_configurations"."activeFlag" AS "activeFlag", "company_configurations"."mobileGuid" AS "mobileGuid(company_configurations)", "company_configurations"."companyLocationId" AS "companyLocationId", "company_configurations"."showRemoteFlag" AS "showRemoteFlag", "company_configurations"."showAutomateFlag" AS "showAutomateFlag", "company_configurations"."needsRenewalFlag" AS "needsRenewalFlag", "company_configurations"."_info.lastUpdated" AS "_info.lastUpdated(company_configurations)", "company_configurations"."_info.updatedBy" AS "_info.updatedBy(company_configurations)", "company_configurations"."_info.dateEntered" AS "_info.dateEntered(company_configurations)", "company_configurations"."_info.enteredBy" AS "_info.enteredBy(company_configurations)", "company_configurations"."backupSuccesses" AS "backupSuccesses", "company_configurations"."backupIncomplete" AS "backupIncomplete", "company_configurations"."backupFailed" AS "backupFailed", "company_configurations"."backupRestores" AS "backupRestores", "company_configurations"."backupBillableSpaceGb" AS "backupBillableSpaceGb", "company_configurations"."backupYear" AS "backupYear", "company_configurations"."backupMonth" AS "backupMonth", "service_tickets"."id" AS "id(service_tickets)", "service_tickets"."summary" AS "summary", "service_tickets"."recordType" AS "recordType", "service_tickets"."board.id" AS "board.id", "service_tickets"."board.name" AS "board.name", "service_tickets"."board._info.board_href" AS "board._info.board_href", "service_tickets"."status.id" AS "status.id(service_tickets)", "service_tickets"."status.name" AS "status.name(service_tickets)", "service_tickets"."status.Sort" AS "status.Sort", "service_tickets"."status._info.status_href" AS "status._info.status_href(service_tickets)", "service_tickets"."company.id" AS "company.id(service_tickets)", "service_tickets"."company.identifier" AS "company.identifier(service_tickets)", "service_tickets"."company.name" AS "company.name(service_tickets)", "service_tickets"."company._info.company_href" AS "company._info.company_href(service_tickets)", "service_tickets"."company._info.mobileGuid" AS "company._info.mobileGuid", "service_tickets"."site.id" AS "site.id(service_tickets)", "service_tickets"."site.name" AS "site.name(service_tickets)", "service_tickets"."site._info.site_href" AS "site._info.site_href(service_tickets)", "service_tickets"."site._info.mobileGuid" AS "site._info.mobileGuid", "service_tickets"."addressLine1" AS "addressLine1(service_tickets)", "service_tickets"."addressLine2" AS "addressLine2(service_tickets)", "service_tickets"."city" AS "city(service_tickets)", "service_tickets"."stateIdentifier" AS "stateIdentifier", "service_tickets"."zip" AS "zip(service_tickets)", "service_tickets"."contact.id" AS "contact.id(service_tickets)", "service_tickets"."contact.name" AS "contact.name(service_tickets)", "service_tickets"."contact._info.mobileGuid" AS "contact._info.mobileGuid", "service_tickets"."contact._info.contact_href" AS "contact._info.contact_href(service_tickets)", "service_tickets"."contactName" AS "contactName", "service_tickets"."contactPhoneNumber" AS "contactPhoneNumber", "service_tickets"."contactPhoneExtension" AS "contactPhoneExtension", "service_tickets"."contactEmailAddress" AS "contactEmailAddress", "service_tickets"."team.id" AS "team.id", "service_tickets"."team.name" AS "team.name", "service_tickets"."team._info.team_href" AS "team._info.team_href", "service_tickets"."priority.id" AS "priority.id", "service_tickets"."priority.name" AS "priority.name", "service_tickets"."priority.sort" AS "priority.sort", "service_tickets"."priority._info.priority_href" AS "priority._info.priority_href", "service_tickets"."priority._info.image_href" AS "priority._info.image_href", "service_tickets"."serviceLocation.id" AS "serviceLocation.id", "service_tickets"."serviceLocation.name" AS "serviceLocation.name", "service_tickets"."serviceLocation._info.location_href" AS "serviceLocation._info.location_href", "service_tickets"."source.id" AS "source.id", "service_tickets"."source.name" AS "source.name", "service_tickets"."source._info.source_href" AS "source._info.source_href", "service_tickets"."agreement.id" AS "agreement.id", "service_tickets"."agreement.name" AS "agreement.name", "service_tickets"."agreement._info.agreement_href" AS "agreement._info.agreement_href", "service_tickets"."severity" AS "severity", "service_tickets"."impact" AS "impact", "service_tickets"."allowAllClientsPortalView" AS "allowAllClientsPortalView", "service_tickets"."customerUpdatedFlag" AS "customerUpdatedFlag", "service_tickets"."automaticEmailContactFlag" AS "automaticEmailContactFlag", "service_tickets"."automaticEmailResourceFlag" AS "automaticEmailResourceFlag", "service_tickets"."automaticEmailCcFlag" AS "automaticEmailCcFlag", "service_tickets"."closedDate" AS "closedDate", "service_tickets"."closedBy" AS "closedBy", "service_tickets"."closedFlag" AS "closedFlag", "service_tickets"."actualHours" AS "actualHours", "service_tickets"."approved" AS "approved", "service_tickets"."estimatedExpenseCost" AS "estimatedExpenseCost", "service_tickets"."estimatedExpenseRevenue" AS "estimatedExpenseRevenue", "service_tickets"."estimatedProductCost" AS "estimatedProductCost", "service_tickets"."estimatedProductRevenue" AS "estimatedProductRevenue", "service_tickets"."estimatedTimeCost" AS "estimatedTimeCost", "service_tickets"."estimatedTimeRevenue" AS "estimatedTimeRevenue", "service_tickets"."billingMethod" AS "billingMethod", "service_tickets"."dateResplan" AS "dateResplan", "service_tickets"."dateResponded" AS "dateResponded", "service_tickets"."resolveMinutes" AS "resolveMinutes", "service_tickets"."resPlanMinutes" AS "resPlanMinutes", "service_tickets"."respondMinutes" AS "respondMinutes", "service_tickets"."isInSla" AS "isInSla", "service_tickets"."hasChildTicket" AS "hasChildTicket", "service_tickets"."hasMergedChildTicketFlag" AS "hasMergedChildTicketFlag", "service_tickets"."billTime" AS "billTime", "service_tickets"."billExpenses" AS "billExpenses", "service_tickets"."billProducts" AS "billProducts", "service_tickets"."location.id" AS "location.id(service_tickets)", "service_tickets"."location.name" AS "location.name(service_tickets)", "service_tickets"."location._info.location_href" AS "location._info.location_href(service_tickets)", "service_tickets"."department.id" AS "department.id(service_tickets)", "service_tickets"."department.identifier" AS "department.identifier(service_tickets)", "service_tickets"."department.name" AS "department.name(service_tickets)", "service_tickets"."department._info.department_href" AS "department._info.department_href(service_tickets)", "service_tickets"."mobileGuid" AS "mobileGuid(service_tickets)", "service_tickets"."sla.id" AS "sla.id", "service_tickets"."sla.name" AS "sla.name", "service_tickets"."sla._info.sla_href" AS "sla._info.sla_href", "service_tickets"."currency.id" AS "currency.id", "service_tickets"."currency.symbol" AS "currency.symbol", "service_tickets"."currency.currencyCode" AS "currency.currencyCode", "service_tickets"."currency.decimalSeparator" AS "currency.decimalSeparator", "service_tickets"."currency.numberOfDecimals" AS "currency.numberOfDecimals", "service_tickets"."currency.thousandsSeparator" AS "currency.thousandsSeparator", "service_tickets"."currency.negativeParenthesesFlag" AS "currency.negativeParenthesesFlag", "service_tickets"."currency.displaySymbolFlag" AS "currency.displaySymbolFlag", "service_tickets"."currency.currencyIdentifier" AS "currency.currencyIdentifier", "service_tickets"."currency.displayIdFlag" AS "currency.displayIdFlag", "service_tickets"."currency.rightAlign" AS "currency.rightAlign", "service_tickets"."currency.name" AS "currency.name", "service_tickets"."currency._info.currency_href" AS "currency._info.currency_href", "service_tickets"."_info.lastUpdated" AS "_info.lastUpdated(service_tickets)", "service_tickets"."_info.updatedBy" AS "_info.updatedBy(service_tickets)", "service_tickets"."_info.dateEntered" AS "_info.dateEntered(service_tickets)", "service_tickets"."_info.enteredBy" AS "_info.enteredBy(service_tickets)", "service_tickets"."_info.activities_href" AS "_info.activities_href(service_tickets)", "service_tickets"."_info.scheduleentries_href" AS "_info.scheduleentries_href", "service_tickets"."_info.documents_href" AS "_info.documents_href(service_tickets)", "service_tickets"."_info.configurations_href" AS "_info.configurations_href(service_tickets)", "service_tickets"."_info.tasks_href" AS "_info.tasks_href", "service_tickets"."_info.notes_href" AS "_info.notes_href(service_tickets)", "service_tickets"."_info.products_href" AS "_info.products_href", "service_tickets"."_info.timeentries_href" AS "_info.timeentries_href", "service_tickets"."_info.expenseEntries_href" AS "_info.expenseEntries_href", "service_tickets"."escalationStartDateUTC" AS "escalationStartDateUTC", "service_tickets"."escalationLevel" AS "escalationLevel", "service_tickets"."minutesBeforeWaiting" AS "minutesBeforeWaiting", "service_tickets"."respondedSkippedMinutes" AS "respondedSkippedMinutes", "service_tickets"."resplanSkippedMinutes" AS "resplanSkippedMinutes", "service_tickets"."respondedHours" AS "respondedHours", "service_tickets"."respondedBy" AS "respondedBy", "service_tickets"."resplanHours" AS "resplanHours", "service_tickets"."resplanBy" AS "resplanBy", "service_tickets"."resolutionHours" AS "resolutionHours", "service_tickets"."minutesWaiting" AS "minutesWaiting", "service_tickets"."workType.id" AS "workType.id", "service_tickets"."workType.name" AS "workType.name", "service_tickets"."workType._info.workType_href" AS "workType._info.workType_href", "service_tickets"."resources" AS "resources", "service_tickets"."workRole.id" AS "workRole.id", "service_tickets"."workRole.name" AS "workRole.name", "service_tickets"."workRole._info.workRole_href" AS "workRole._info.workRole_href", "service_tickets"."type.id" AS "type.id(service_tickets)", "service_tickets"."type.name" AS "type.name(service_tickets)", "service_tickets"."type._info.type_href" AS "type._info.type_href(service_tickets)", "service_tickets"."requiredDate" AS "requiredDate", "service_tickets"."budgetHours" AS "budgetHours", "service_tickets"."requestForChangeFlag" AS "requestForChangeFlag" FROM "Halops_Dash"."company_companies" AS "company_companies" INNER JOIN "Halops_Dash"."company_configurations" AS "company_configurations" ON "company_companies"."id" = "company_configurations"."id" INNER JOIN "Halops_Dash"."service_tickets" AS "service_tickets" ON "company_companies"."id" = "service_tickets"."id") temp_table GROUP BY "name", "name" ORDER BY "name" ASC NULLS FIRST'''

shft_q6 = '''SELECT COUNT(DISTINCT "numberOfEmployees") AS "CNTD(numberOfEmployees)" FROM (SELECT "company_companies"."id" AS "id", "company_companies"."identifier" AS "identifier", "company_companies"."name" AS "name", "company_companies"."status.id" AS "status.id", "company_companies"."status.name" AS "status.name", "company_companies"."status._info.status_href" AS "status._info.status_href", "company_companies"."country.id" AS "country.id", "company_companies"."country.name" AS "country.name", "company_companies"."country._info.country_href" AS "country._info.country_href", "company_companies"."phoneNumber" AS "phoneNumber", "company_companies"."website" AS "website", "company_companies"."territory.id" AS "territory.id", "company_companies"."territory.name" AS "territory.name", "company_companies"."territory._info.location_href" AS "territory._info.location_href", "company_companies"."market.id" AS "market.id", "company_companies"."market.name" AS "market.name", "company_companies"."market._info.Market_href" AS "market._info.Market_href", "company_companies"."defaultContact.id" AS "defaultContact.id", "company_companies"."defaultContact.name" AS "defaultContact.name", "company_companies"."defaultContact._info.contact_href" AS "defaultContact._info.contact_href", "company_companies"."dateAcquired" AS "dateAcquired", "company_companies"."annualRevenue" AS "annualRevenue", "company_companies"."timeZoneSetup.id" AS "timeZoneSetup.id", "company_companies"."timeZoneSetup.name" AS "timeZoneSetup.name", "company_companies"."timeZoneSetup._info.timeZoneSetup_href" AS "timeZoneSetup._info.timeZoneSetup_href", "company_companies"."leadFlag" AS "leadFlag", "company_companies"."unsubscribeFlag" AS "unsubscribeFlag", "company_companies"."taxCode.id" AS "taxCode.id", "company_companies"."taxCode.name" AS "taxCode.name", "company_companies"."taxCode._info.taxCode_href" AS "taxCode._info.taxCode_href", "company_companies"."billingTerms.id" AS "billingTerms.id", "company_companies"."billingTerms.name" AS "billingTerms.name", "company_companies"."billToCompany.id" AS "billToCompany.id", "company_companies"."billToCompany.identifier" AS "billToCompany.identifier", "company_companies"."billToCompany.name" AS "billToCompany.name", "company_companies"."billToCompany._info.company_href" AS "billToCompany._info.company_href", "company_companies"."invoiceDeliveryMethod.id" AS "invoiceDeliveryMethod.id", "company_companies"."invoiceDeliveryMethod.name" AS "invoiceDeliveryMethod.name", "company_companies"."deletedFlag" AS "deletedFlag", "company_companies"."mobileGuid" AS "mobileGuid", "company_companies"."isVendorFlag" AS "isVendorFlag", "company_companies"."types[0].id" AS "types[0].id", "company_companies"."types[0].name" AS "types[0].name", "company_companies"."types[0]._info.type_href" AS "types[0]._info.type_href", "company_companies"."site.id" AS "site.id", "company_companies"."site.name" AS "site.name", "company_companies"."site._info.site_href" AS "site._info.site_href", "company_companies"."_info.lastUpdated" AS "_info.lastUpdated", "company_companies"."_info.updatedBy" AS "_info.updatedBy", "company_companies"."_info.dateEntered" AS "_info.dateEntered", "company_companies"."_info.enteredBy" AS "_info.enteredBy", "company_companies"."_info.contacts_href" AS "_info.contacts_href", "company_companies"."_info.agreements_href" AS "_info.agreements_href", "company_companies"."_info.tickets_href" AS "_info.tickets_href", "company_companies"."_info.opportunities_href" AS "_info.opportunities_href", "company_companies"."_info.activities_href" AS "_info.activities_href", "company_companies"."_info.projects_href" AS "_info.projects_href", "company_companies"."_info.configurations_href" AS "_info.configurations_href", "company_companies"."_info.orders_href" AS "_info.orders_href", "company_companies"."_info.documents_href" AS "_info.documents_href", "company_companies"."_info.sites_href" AS "_info.sites_href", "company_companies"."_info.teams_href" AS "_info.teams_href", "company_companies"."_info.reports_href" AS "_info.reports_href", "company_companies"."_info.notes_href" AS "_info.notes_href", "company_companies"."addressLine1" AS "addressLine1", "company_companies"."addressLine2" AS "addressLine2", "company_companies"."city" AS "city", "company_companies"."state" AS "state", "company_companies"."zip" AS "zip", "company_companies"."faxNumber" AS "faxNumber", "company_companies"."accountNumber" AS "accountNumber", "company_companies"."numberOfEmployees" AS "numberOfEmployees", "company_companies"."leadSource" AS "leadSource", "company_companies"."billingContact.id" AS "billingContact.id", "company_companies"."billingContact.name" AS "billingContact.name", "company_companies"."billingContact._info.contact_href" AS "billingContact._info.contact_href", "company_companies"."invoiceToEmailAddress" AS "invoiceToEmailAddress", "company_companies"."billingSite.id" AS "billingSite.id", "company_companies"."billingSite.name" AS "billingSite.name", "company_companies"."billingSite._info.site_href" AS "billingSite._info.site_href", "company_configurations"."id" AS "id(company_configurations)", "company_configurations"."name" AS "name(company_configurations)", "company_configurations"."type.id" AS "type.id", "company_configurations"."type.name" AS "type.name", "company_configurations"."type._info.type_href" AS "type._info.type_href", "company_configurations"."status.id" AS "status.id(company_configurations)", "company_configurations"."status.name" AS "status.name(company_configurations)", "company_configurations"."status._info.status_href" AS "status._info.status_href(company_configurations)", "company_configurations"."company.id" AS "company.id", "company_configurations"."company.identifier" AS "company.identifier", "company_configurations"."company.name" AS "company.name", "company_configurations"."company._info.company_href" AS "company._info.company_href", "company_configurations"."contact.id" AS "contact.id", "company_configurations"."contact.name" AS "contact.name", "company_configurations"."contact._info.contact_href" AS "contact._info.contact_href", "company_configurations"."site.id" AS "site.id(company_configurations)", "company_configurations"."site.name" AS "site.name(company_configurations)", "company_configurations"."site._info.site_href" AS "site._info.site_href(company_configurations)", "company_configurations"."locationId" AS "locationId", "company_configurations"."location.id" AS "location.id", "company_configurations"."location.name" AS "location.name", "company_configurations"."location._info.location_href" AS "location._info.location_href", "company_configurations"."businessUnitId" AS "businessUnitId", "company_configurations"."department.id" AS "department.id", "company_configurations"."department.identifier" AS "department.identifier", "company_configurations"."department.name" AS "department.name", "company_configurations"."department._info.department_href" AS "department._info.department_href", "company_configurations"."serialNumber" AS "serialNumber", "company_configurations"."modelNumber" AS "modelNumber", "company_configurations"."tagNumber" AS "tagNumber", "company_configurations"."warrantyExpirationDate" AS "warrantyExpirationDate", "company_configurations"."notes" AS "notes", "company_configurations"."billFlag" AS "billFlag", "company_configurations"."vendor.id" AS "vendor.id", "company_configurations"."vendor.identifier" AS "vendor.identifier", "company_configurations"."vendor.name" AS "vendor.name", "company_configurations"."vendor._info.company_href" AS "vendor._info.company_href", "company_configurations"."activeFlag" AS "activeFlag", "company_configurations"."mobileGuid" AS "mobileGuid(company_configurations)", "company_configurations"."companyLocationId" AS "companyLocationId", "company_configurations"."showRemoteFlag" AS "showRemoteFlag", "company_configurations"."showAutomateFlag" AS "showAutomateFlag", "company_configurations"."needsRenewalFlag" AS "needsRenewalFlag", "company_configurations"."_info.lastUpdated" AS "_info.lastUpdated(company_configurations)", "company_configurations"."_info.updatedBy" AS "_info.updatedBy(company_configurations)", "company_configurations"."_info.dateEntered" AS "_info.dateEntered(company_configurations)", "company_configurations"."_info.enteredBy" AS "_info.enteredBy(company_configurations)", "company_configurations"."backupSuccesses" AS "backupSuccesses", "company_configurations"."backupIncomplete" AS "backupIncomplete", "company_configurations"."backupFailed" AS "backupFailed", "company_configurations"."backupRestores" AS "backupRestores", "company_configurations"."backupBillableSpaceGb" AS "backupBillableSpaceGb", "company_configurations"."backupYear" AS "backupYear", "company_configurations"."backupMonth" AS "backupMonth", "service_tickets"."id" AS "id(service_tickets)", "service_tickets"."summary" AS "summary", "service_tickets"."recordType" AS "recordType", "service_tickets"."board.id" AS "board.id", "service_tickets"."board.name" AS "board.name", "service_tickets"."board._info.board_href" AS "board._info.board_href", "service_tickets"."status.id" AS "status.id(service_tickets)", "service_tickets"."status.name" AS "status.name(service_tickets)", "service_tickets"."status.Sort" AS "status.Sort", "service_tickets"."status._info.status_href" AS "status._info.status_href(service_tickets)", "service_tickets"."company.id" AS "company.id(service_tickets)", "service_tickets"."company.identifier" AS "company.identifier(service_tickets)", "service_tickets"."company.name" AS "company.name(service_tickets)", "service_tickets"."company._info.company_href" AS "company._info.company_href(service_tickets)", "service_tickets"."company._info.mobileGuid" AS "company._info.mobileGuid", "service_tickets"."site.id" AS "site.id(service_tickets)", "service_tickets"."site.name" AS "site.name(service_tickets)", "service_tickets"."site._info.site_href" AS "site._info.site_href(service_tickets)", "service_tickets"."site._info.mobileGuid" AS "site._info.mobileGuid", "service_tickets"."addressLine1" AS "addressLine1(service_tickets)", "service_tickets"."addressLine2" AS "addressLine2(service_tickets)", "service_tickets"."city" AS "city(service_tickets)", "service_tickets"."stateIdentifier" AS "stateIdentifier", "service_tickets"."zip" AS "zip(service_tickets)", "service_tickets"."contact.id" AS "contact.id(service_tickets)", "service_tickets"."contact.name" AS "contact.name(service_tickets)", "service_tickets"."contact._info.mobileGuid" AS "contact._info.mobileGuid", "service_tickets"."contact._info.contact_href" AS "contact._info.contact_href(service_tickets)", "service_tickets"."contactName" AS "contactName", "service_tickets"."contactPhoneNumber" AS "contactPhoneNumber", "service_tickets"."contactPhoneExtension" AS "contactPhoneExtension", "service_tickets"."contactEmailAddress" AS "contactEmailAddress", "service_tickets"."team.id" AS "team.id", "service_tickets"."team.name" AS "team.name", "service_tickets"."team._info.team_href" AS "team._info.team_href", "service_tickets"."priority.id" AS "priority.id", "service_tickets"."priority.name" AS "priority.name", "service_tickets"."priority.sort" AS "priority.sort", "service_tickets"."priority._info.priority_href" AS "priority._info.priority_href", "service_tickets"."priority._info.image_href" AS "priority._info.image_href", "service_tickets"."serviceLocation.id" AS "serviceLocation.id", "service_tickets"."serviceLocation.name" AS "serviceLocation.name", "service_tickets"."serviceLocation._info.location_href" AS "serviceLocation._info.location_href", "service_tickets"."source.id" AS "source.id", "service_tickets"."source.name" AS "source.name", "service_tickets"."source._info.source_href" AS "source._info.source_href", "service_tickets"."agreement.id" AS "agreement.id", "service_tickets"."agreement.name" AS "agreement.name", "service_tickets"."agreement._info.agreement_href" AS "agreement._info.agreement_href", "service_tickets"."severity" AS "severity", "service_tickets"."impact" AS "impact", "service_tickets"."allowAllClientsPortalView" AS "allowAllClientsPortalView", "service_tickets"."customerUpdatedFlag" AS "customerUpdatedFlag", "service_tickets"."automaticEmailContactFlag" AS "automaticEmailContactFlag", "service_tickets"."automaticEmailResourceFlag" AS "automaticEmailResourceFlag", "service_tickets"."automaticEmailCcFlag" AS "automaticEmailCcFlag", "service_tickets"."closedDate" AS "closedDate", "service_tickets"."closedBy" AS "closedBy", "service_tickets"."closedFlag" AS "closedFlag", "service_tickets"."actualHours" AS "actualHours", "service_tickets"."approved" AS "approved", "service_tickets"."estimatedExpenseCost" AS "estimatedExpenseCost", "service_tickets"."estimatedExpenseRevenue" AS "estimatedExpenseRevenue", "service_tickets"."estimatedProductCost" AS "estimatedProductCost", "service_tickets"."estimatedProductRevenue" AS "estimatedProductRevenue", "service_tickets"."estimatedTimeCost" AS "estimatedTimeCost", "service_tickets"."estimatedTimeRevenue" AS "estimatedTimeRevenue", "service_tickets"."billingMethod" AS "billingMethod", "service_tickets"."dateResplan" AS "dateResplan", "service_tickets"."dateResponded" AS "dateResponded", "service_tickets"."resolveMinutes" AS "resolveMinutes", "service_tickets"."resPlanMinutes" AS "resPlanMinutes", "service_tickets"."respondMinutes" AS "respondMinutes", "service_tickets"."isInSla" AS "isInSla", "service_tickets"."hasChildTicket" AS "hasChildTicket", "service_tickets"."hasMergedChildTicketFlag" AS "hasMergedChildTicketFlag", "service_tickets"."billTime" AS "billTime", "service_tickets"."billExpenses" AS "billExpenses", "service_tickets"."billProducts" AS "billProducts", "service_tickets"."location.id" AS "location.id(service_tickets)", "service_tickets"."location.name" AS "location.name(service_tickets)", "service_tickets"."location._info.location_href" AS "location._info.location_href(service_tickets)", "service_tickets"."department.id" AS "department.id(service_tickets)", "service_tickets"."department.identifier" AS "department.identifier(service_tickets)", "service_tickets"."department.name" AS "department.name(service_tickets)", "service_tickets"."department._info.department_href" AS "department._info.department_href(service_tickets)", "service_tickets"."mobileGuid" AS "mobileGuid(service_tickets)", "service_tickets"."sla.id" AS "sla.id", "service_tickets"."sla.name" AS "sla.name", "service_tickets"."sla._info.sla_href" AS "sla._info.sla_href", "service_tickets"."currency.id" AS "currency.id", "service_tickets"."currency.symbol" AS "currency.symbol", "service_tickets"."currency.currencyCode" AS "currency.currencyCode", "service_tickets"."currency.decimalSeparator" AS "currency.decimalSeparator", "service_tickets"."currency.numberOfDecimals" AS "currency.numberOfDecimals", "service_tickets"."currency.thousandsSeparator" AS "currency.thousandsSeparator", "service_tickets"."currency.negativeParenthesesFlag" AS "currency.negativeParenthesesFlag", "service_tickets"."currency.displaySymbolFlag" AS "currency.displaySymbolFlag", "service_tickets"."currency.currencyIdentifier" AS "currency.currencyIdentifier", "service_tickets"."currency.displayIdFlag" AS "currency.displayIdFlag", "service_tickets"."currency.rightAlign" AS "currency.rightAlign", "service_tickets"."currency.name" AS "currency.name", "service_tickets"."currency._info.currency_href" AS "currency._info.currency_href", "service_tickets"."_info.lastUpdated" AS "_info.lastUpdated(service_tickets)", "service_tickets"."_info.updatedBy" AS "_info.updatedBy(service_tickets)", "service_tickets"."_info.dateEntered" AS "_info.dateEntered(service_tickets)", "service_tickets"."_info.enteredBy" AS "_info.enteredBy(service_tickets)", "service_tickets"."_info.activities_href" AS "_info.activities_href(service_tickets)", "service_tickets"."_info.scheduleentries_href" AS "_info.scheduleentries_href", "service_tickets"."_info.documents_href" AS "_info.documents_href(service_tickets)", "service_tickets"."_info.configurations_href" AS "_info.configurations_href(service_tickets)", "service_tickets"."_info.tasks_href" AS "_info.tasks_href", "service_tickets"."_info.notes_href" AS "_info.notes_href(service_tickets)", "service_tickets"."_info.products_href" AS "_info.products_href", "service_tickets"."_info.timeentries_href" AS "_info.timeentries_href", "service_tickets"."_info.expenseEntries_href" AS "_info.expenseEntries_href", "service_tickets"."escalationStartDateUTC" AS "escalationStartDateUTC", "service_tickets"."escalationLevel" AS "escalationLevel", "service_tickets"."minutesBeforeWaiting" AS "minutesBeforeWaiting", "service_tickets"."respondedSkippedMinutes" AS "respondedSkippedMinutes", "service_tickets"."resplanSkippedMinutes" AS "resplanSkippedMinutes", "service_tickets"."respondedHours" AS "respondedHours", "service_tickets"."respondedBy" AS "respondedBy", "service_tickets"."resplanHours" AS "resplanHours", "service_tickets"."resplanBy" AS "resplanBy", "service_tickets"."resolutionHours" AS "resolutionHours", "service_tickets"."minutesWaiting" AS "minutesWaiting", "service_tickets"."workType.id" AS "workType.id", "service_tickets"."workType.name" AS "workType.name", "service_tickets"."workType._info.workType_href" AS "workType._info.workType_href", "service_tickets"."resources" AS "resources", "service_tickets"."workRole.id" AS "workRole.id", "service_tickets"."workRole.name" AS "workRole.name", "service_tickets"."workRole._info.workRole_href" AS "workRole._info.workRole_href", "service_tickets"."type.id" AS "type.id(service_tickets)", "service_tickets"."type.name" AS "type.name(service_tickets)", "service_tickets"."type._info.type_href" AS "type._info.type_href(service_tickets)", "service_tickets"."requiredDate" AS "requiredDate", "service_tickets"."budgetHours" AS "budgetHours", "service_tickets"."requestForChangeFlag" AS "requestForChangeFlag" FROM "Halops_Dash"."company_companies" AS "company_companies" INNER JOIN "Halops_Dash"."company_configurations" AS "company_configurations" ON "company_companies"."id" = "company_configurations"."id" INNER JOIN "Halops_Dash"."service_tickets" AS "service_tickets" ON "company_companies"."id" = "service_tickets"."id") temp_table ORDER BY "CNTD(numberOfEmployees)" ASC NULLS FIRST'''

shft_q7 = '''SELECT COUNT(DISTINCT "id(service_tickets)") AS "CNTD(id(service_tickets))" FROM (SELECT "company_companies"."id" AS "id", "company_companies"."identifier" AS "identifier", "company_companies"."name" AS "name", "company_companies"."status.id" AS "status.id", "company_companies"."status.name" AS "status.name", "company_companies"."status._info.status_href" AS "status._info.status_href", "company_companies"."country.id" AS "country.id", "company_companies"."country.name" AS "country.name", "company_companies"."country._info.country_href" AS "country._info.country_href", "company_companies"."phoneNumber" AS "phoneNumber", "company_companies"."website" AS "website", "company_companies"."territory.id" AS "territory.id", "company_companies"."territory.name" AS "territory.name", "company_companies"."territory._info.location_href" AS "territory._info.location_href", "company_companies"."market.id" AS "market.id", "company_companies"."market.name" AS "market.name", "company_companies"."market._info.Market_href" AS "market._info.Market_href", "company_companies"."defaultContact.id" AS "defaultContact.id", "company_companies"."defaultContact.name" AS "defaultContact.name", "company_companies"."defaultContact._info.contact_href" AS "defaultContact._info.contact_href", "company_companies"."dateAcquired" AS "dateAcquired", "company_companies"."annualRevenue" AS "annualRevenue", "company_companies"."timeZoneSetup.id" AS "timeZoneSetup.id", "company_companies"."timeZoneSetup.name" AS "timeZoneSetup.name", "company_companies"."timeZoneSetup._info.timeZoneSetup_href" AS "timeZoneSetup._info.timeZoneSetup_href", "company_companies"."leadFlag" AS "leadFlag", "company_companies"."unsubscribeFlag" AS "unsubscribeFlag", "company_companies"."taxCode.id" AS "taxCode.id", "company_companies"."taxCode.name" AS "taxCode.name", "company_companies"."taxCode._info.taxCode_href" AS "taxCode._info.taxCode_href", "company_companies"."billingTerms.id" AS "billingTerms.id", "company_companies"."billingTerms.name" AS "billingTerms.name", "company_companies"."billToCompany.id" AS "billToCompany.id", "company_companies"."billToCompany.identifier" AS "billToCompany.identifier", "company_companies"."billToCompany.name" AS "billToCompany.name", "company_companies"."billToCompany._info.company_href" AS "billToCompany._info.company_href", "company_companies"."invoiceDeliveryMethod.id" AS "invoiceDeliveryMethod.id", "company_companies"."invoiceDeliveryMethod.name" AS "invoiceDeliveryMethod.name", "company_companies"."deletedFlag" AS "deletedFlag", "company_companies"."mobileGuid" AS "mobileGuid", "company_companies"."isVendorFlag" AS "isVendorFlag", "company_companies"."types[0].id" AS "types[0].id", "company_companies"."types[0].name" AS "types[0].name", "company_companies"."types[0]._info.type_href" AS "types[0]._info.type_href", "company_companies"."site.id" AS "site.id", "company_companies"."site.name" AS "site.name", "company_companies"."site._info.site_href" AS "site._info.site_href", "company_companies"."_info.lastUpdated" AS "_info.lastUpdated", "company_companies"."_info.updatedBy" AS "_info.updatedBy", "company_companies"."_info.dateEntered" AS "_info.dateEntered", "company_companies"."_info.enteredBy" AS "_info.enteredBy", "company_companies"."_info.contacts_href" AS "_info.contacts_href", "company_companies"."_info.agreements_href" AS "_info.agreements_href", "company_companies"."_info.tickets_href" AS "_info.tickets_href", "company_companies"."_info.opportunities_href" AS "_info.opportunities_href", "company_companies"."_info.activities_href" AS "_info.activities_href", "company_companies"."_info.projects_href" AS "_info.projects_href", "company_companies"."_info.configurations_href" AS "_info.configurations_href", "company_companies"."_info.orders_href" AS "_info.orders_href", "company_companies"."_info.documents_href" AS "_info.documents_href", "company_companies"."_info.sites_href" AS "_info.sites_href", "company_companies"."_info.teams_href" AS "_info.teams_href", "company_companies"."_info.reports_href" AS "_info.reports_href", "company_companies"."_info.notes_href" AS "_info.notes_href", "company_companies"."addressLine1" AS "addressLine1", "company_companies"."addressLine2" AS "addressLine2", "company_companies"."city" AS "city", "company_companies"."state" AS "state", "company_companies"."zip" AS "zip", "company_companies"."faxNumber" AS "faxNumber", "company_companies"."accountNumber" AS "accountNumber", "company_companies"."numberOfEmployees" AS "numberOfEmployees", "company_companies"."leadSource" AS "leadSource", "company_companies"."billingContact.id" AS "billingContact.id", "company_companies"."billingContact.name" AS "billingContact.name", "company_companies"."billingContact._info.contact_href" AS "billingContact._info.contact_href", "company_companies"."invoiceToEmailAddress" AS "invoiceToEmailAddress", "company_companies"."billingSite.id" AS "billingSite.id", "company_companies"."billingSite.name" AS "billingSite.name", "company_companies"."billingSite._info.site_href" AS "billingSite._info.site_href", "company_configurations"."id" AS "id(company_configurations)", "company_configurations"."name" AS "name(company_configurations)", "company_configurations"."type.id" AS "type.id", "company_configurations"."type.name" AS "type.name", "company_configurations"."type._info.type_href" AS "type._info.type_href", "company_configurations"."status.id" AS "status.id(company_configurations)", "company_configurations"."status.name" AS "status.name(company_configurations)", "company_configurations"."status._info.status_href" AS "status._info.status_href(company_configurations)", "company_configurations"."company.id" AS "company.id", "company_configurations"."company.identifier" AS "company.identifier", "company_configurations"."company.name" AS "company.name", "company_configurations"."company._info.company_href" AS "company._info.company_href", "company_configurations"."contact.id" AS "contact.id", "company_configurations"."contact.name" AS "contact.name", "company_configurations"."contact._info.contact_href" AS "contact._info.contact_href", "company_configurations"."site.id" AS "site.id(company_configurations)", "company_configurations"."site.name" AS "site.name(company_configurations)", "company_configurations"."site._info.site_href" AS "site._info.site_href(company_configurations)", "company_configurations"."locationId" AS "locationId", "company_configurations"."location.id" AS "location.id", "company_configurations"."location.name" AS "location.name", "company_configurations"."location._info.location_href" AS "location._info.location_href", "company_configurations"."businessUnitId" AS "businessUnitId", "company_configurations"."department.id" AS "department.id", "company_configurations"."department.identifier" AS "department.identifier", "company_configurations"."department.name" AS "department.name", "company_configurations"."department._info.department_href" AS "department._info.department_href", "company_configurations"."serialNumber" AS "serialNumber", "company_configurations"."modelNumber" AS "modelNumber", "company_configurations"."tagNumber" AS "tagNumber", "company_configurations"."warrantyExpirationDate" AS "warrantyExpirationDate", "company_configurations"."notes" AS "notes", "company_configurations"."billFlag" AS "billFlag", "company_configurations"."vendor.id" AS "vendor.id", "company_configurations"."vendor.identifier" AS "vendor.identifier", "company_configurations"."vendor.name" AS "vendor.name", "company_configurations"."vendor._info.company_href" AS "vendor._info.company_href", "company_configurations"."activeFlag" AS "activeFlag", "company_configurations"."mobileGuid" AS "mobileGuid(company_configurations)", "company_configurations"."companyLocationId" AS "companyLocationId", "company_configurations"."showRemoteFlag" AS "showRemoteFlag", "company_configurations"."showAutomateFlag" AS "showAutomateFlag", "company_configurations"."needsRenewalFlag" AS "needsRenewalFlag", "company_configurations"."_info.lastUpdated" AS "_info.lastUpdated(company_configurations)", "company_configurations"."_info.updatedBy" AS "_info.updatedBy(company_configurations)", "company_configurations"."_info.dateEntered" AS "_info.dateEntered(company_configurations)", "company_configurations"."_info.enteredBy" AS "_info.enteredBy(company_configurations)", "company_configurations"."backupSuccesses" AS "backupSuccesses", "company_configurations"."backupIncomplete" AS "backupIncomplete", "company_configurations"."backupFailed" AS "backupFailed", "company_configurations"."backupRestores" AS "backupRestores", "company_configurations"."backupBillableSpaceGb" AS "backupBillableSpaceGb", "company_configurations"."backupYear" AS "backupYear", "company_configurations"."backupMonth" AS "backupMonth", "service_tickets"."id" AS "id(service_tickets)", "service_tickets"."summary" AS "summary", "service_tickets"."recordType" AS "recordType", "service_tickets"."board.id" AS "board.id", "service_tickets"."board.name" AS "board.name", "service_tickets"."board._info.board_href" AS "board._info.board_href", "service_tickets"."status.id" AS "status.id(service_tickets)", "service_tickets"."status.name" AS "status.name(service_tickets)", "service_tickets"."status.Sort" AS "status.Sort", "service_tickets"."status._info.status_href" AS "status._info.status_href(service_tickets)", "service_tickets"."company.id" AS "company.id(service_tickets)", "service_tickets"."company.identifier" AS "company.identifier(service_tickets)", "service_tickets"."company.name" AS "company.name(service_tickets)", "service_tickets"."company._info.company_href" AS "company._info.company_href(service_tickets)", "service_tickets"."company._info.mobileGuid" AS "company._info.mobileGuid", "service_tickets"."site.id" AS "site.id(service_tickets)", "service_tickets"."site.name" AS "site.name(service_tickets)", "service_tickets"."site._info.site_href" AS "site._info.site_href(service_tickets)", "service_tickets"."site._info.mobileGuid" AS "site._info.mobileGuid", "service_tickets"."addressLine1" AS "addressLine1(service_tickets)", "service_tickets"."addressLine2" AS "addressLine2(service_tickets)", "service_tickets"."city" AS "city(service_tickets)", "service_tickets"."stateIdentifier" AS "stateIdentifier", "service_tickets"."zip" AS "zip(service_tickets)", "service_tickets"."contact.id" AS "contact.id(service_tickets)", "service_tickets"."contact.name" AS "contact.name(service_tickets)", "service_tickets"."contact._info.mobileGuid" AS "contact._info.mobileGuid", "service_tickets"."contact._info.contact_href" AS "contact._info.contact_href(service_tickets)", "service_tickets"."contactName" AS "contactName", "service_tickets"."contactPhoneNumber" AS "contactPhoneNumber", "service_tickets"."contactPhoneExtension" AS "contactPhoneExtension", "service_tickets"."contactEmailAddress" AS "contactEmailAddress", "service_tickets"."team.id" AS "team.id", "service_tickets"."team.name" AS "team.name", "service_tickets"."team._info.team_href" AS "team._info.team_href", "service_tickets"."priority.id" AS "priority.id", "service_tickets"."priority.name" AS "priority.name", "service_tickets"."priority.sort" AS "priority.sort", "service_tickets"."priority._info.priority_href" AS "priority._info.priority_href", "service_tickets"."priority._info.image_href" AS "priority._info.image_href", "service_tickets"."serviceLocation.id" AS "serviceLocation.id", "service_tickets"."serviceLocation.name" AS "serviceLocation.name", "service_tickets"."serviceLocation._info.location_href" AS "serviceLocation._info.location_href", "service_tickets"."source.id" AS "source.id", "service_tickets"."source.name" AS "source.name", "service_tickets"."source._info.source_href" AS "source._info.source_href", "service_tickets"."agreement.id" AS "agreement.id", "service_tickets"."agreement.name" AS "agreement.name", "service_tickets"."agreement._info.agreement_href" AS "agreement._info.agreement_href", "service_tickets"."severity" AS "severity", "service_tickets"."impact" AS "impact", "service_tickets"."allowAllClientsPortalView" AS "allowAllClientsPortalView", "service_tickets"."customerUpdatedFlag" AS "customerUpdatedFlag", "service_tickets"."automaticEmailContactFlag" AS "automaticEmailContactFlag", "service_tickets"."automaticEmailResourceFlag" AS "automaticEmailResourceFlag", "service_tickets"."automaticEmailCcFlag" AS "automaticEmailCcFlag", "service_tickets"."closedDate" AS "closedDate", "service_tickets"."closedBy" AS "closedBy", "service_tickets"."closedFlag" AS "closedFlag", "service_tickets"."actualHours" AS "actualHours", "service_tickets"."approved" AS "approved", "service_tickets"."estimatedExpenseCost" AS "estimatedExpenseCost", "service_tickets"."estimatedExpenseRevenue" AS "estimatedExpenseRevenue", "service_tickets"."estimatedProductCost" AS "estimatedProductCost", "service_tickets"."estimatedProductRevenue" AS "estimatedProductRevenue", "service_tickets"."estimatedTimeCost" AS "estimatedTimeCost", "service_tickets"."estimatedTimeRevenue" AS "estimatedTimeRevenue", "service_tickets"."billingMethod" AS "billingMethod", "service_tickets"."dateResplan" AS "dateResplan", "service_tickets"."dateResponded" AS "dateResponded", "service_tickets"."resolveMinutes" AS "resolveMinutes", "service_tickets"."resPlanMinutes" AS "resPlanMinutes", "service_tickets"."respondMinutes" AS "respondMinutes", "service_tickets"."isInSla" AS "isInSla", "service_tickets"."hasChildTicket" AS "hasChildTicket", "service_tickets"."hasMergedChildTicketFlag" AS "hasMergedChildTicketFlag", "service_tickets"."billTime" AS "billTime", "service_tickets"."billExpenses" AS "billExpenses", "service_tickets"."billProducts" AS "billProducts", "service_tickets"."location.id" AS "location.id(service_tickets)", "service_tickets"."location.name" AS "location.name(service_tickets)", "service_tickets"."location._info.location_href" AS "location._info.location_href(service_tickets)", "service_tickets"."department.id" AS "department.id(service_tickets)", "service_tickets"."department.identifier" AS "department.identifier(service_tickets)", "service_tickets"."department.name" AS "department.name(service_tickets)", "service_tickets"."department._info.department_href" AS "department._info.department_href(service_tickets)", "service_tickets"."mobileGuid" AS "mobileGuid(service_tickets)", "service_tickets"."sla.id" AS "sla.id", "service_tickets"."sla.name" AS "sla.name", "service_tickets"."sla._info.sla_href" AS "sla._info.sla_href", "service_tickets"."currency.id" AS "currency.id", "service_tickets"."currency.symbol" AS "currency.symbol", "service_tickets"."currency.currencyCode" AS "currency.currencyCode", "service_tickets"."currency.decimalSeparator" AS "currency.decimalSeparator", "service_tickets"."currency.numberOfDecimals" AS "currency.numberOfDecimals", "service_tickets"."currency.thousandsSeparator" AS "currency.thousandsSeparator", "service_tickets"."currency.negativeParenthesesFlag" AS "currency.negativeParenthesesFlag", "service_tickets"."currency.displaySymbolFlag" AS "currency.displaySymbolFlag", "service_tickets"."currency.currencyIdentifier" AS "currency.currencyIdentifier", "service_tickets"."currency.displayIdFlag" AS "currency.displayIdFlag", "service_tickets"."currency.rightAlign" AS "currency.rightAlign", "service_tickets"."currency.name" AS "currency.name", "service_tickets"."currency._info.currency_href" AS "currency._info.currency_href", "service_tickets"."_info.lastUpdated" AS "_info.lastUpdated(service_tickets)", "service_tickets"."_info.updatedBy" AS "_info.updatedBy(service_tickets)", "service_tickets"."_info.dateEntered" AS "_info.dateEntered(service_tickets)", "service_tickets"."_info.enteredBy" AS "_info.enteredBy(service_tickets)", "service_tickets"."_info.activities_href" AS "_info.activities_href(service_tickets)", "service_tickets"."_info.scheduleentries_href" AS "_info.scheduleentries_href", "service_tickets"."_info.documents_href" AS "_info.documents_href(service_tickets)", "service_tickets"."_info.configurations_href" AS "_info.configurations_href(service_tickets)", "service_tickets"."_info.tasks_href" AS "_info.tasks_href", "service_tickets"."_info.notes_href" AS "_info.notes_href(service_tickets)", "service_tickets"."_info.products_href" AS "_info.products_href", "service_tickets"."_info.timeentries_href" AS "_info.timeentries_href", "service_tickets"."_info.expenseEntries_href" AS "_info.expenseEntries_href", "service_tickets"."escalationStartDateUTC" AS "escalationStartDateUTC", "service_tickets"."escalationLevel" AS "escalationLevel", "service_tickets"."minutesBeforeWaiting" AS "minutesBeforeWaiting", "service_tickets"."respondedSkippedMinutes" AS "respondedSkippedMinutes", "service_tickets"."resplanSkippedMinutes" AS "resplanSkippedMinutes", "service_tickets"."respondedHours" AS "respondedHours", "service_tickets"."respondedBy" AS "respondedBy", "service_tickets"."resplanHours" AS "resplanHours", "service_tickets"."resplanBy" AS "resplanBy", "service_tickets"."resolutionHours" AS "resolutionHours", "service_tickets"."minutesWaiting" AS "minutesWaiting", "service_tickets"."workType.id" AS "workType.id", "service_tickets"."workType.name" AS "workType.name", "service_tickets"."workType._info.workType_href" AS "workType._info.workType_href", "service_tickets"."resources" AS "resources", "service_tickets"."workRole.id" AS "workRole.id", "service_tickets"."workRole.name" AS "workRole.name", "service_tickets"."workRole._info.workRole_href" AS "workRole._info.workRole_href", "service_tickets"."type.id" AS "type.id(service_tickets)", "service_tickets"."type.name" AS "type.name(service_tickets)", "service_tickets"."type._info.type_href" AS "type._info.type_href(service_tickets)", "service_tickets"."requiredDate" AS "requiredDate", "service_tickets"."budgetHours" AS "budgetHours", "service_tickets"."requestForChangeFlag" AS "requestForChangeFlag" FROM "Halops_Dash"."company_companies" AS "company_companies" INNER JOIN "Halops_Dash"."company_configurations" AS "company_configurations" ON "company_companies"."id" = "company_configurations"."id" INNER JOIN "Halops_Dash"."service_tickets" AS "service_tickets" ON "company_companies"."id" = "service_tickets"."id") temp_table ORDER BY "CNTD(id(service_tickets))" ASC NULLS FIRST'''

shft_q8 = '''SELECT COUNT(DISTINCT "annualRevenue") AS "CNTD(annualRevenue)" FROM (SELECT "company_companies"."id" AS "id", "company_companies"."identifier" AS "identifier", "company_companies"."name" AS "name", "company_companies"."status.id" AS "status.id", "company_companies"."status.name" AS "status.name", "company_companies"."status._info.status_href" AS "status._info.status_href", "company_companies"."country.id" AS "country.id", "company_companies"."country.name" AS "country.name", "company_companies"."country._info.country_href" AS "country._info.country_href", "company_companies"."phoneNumber" AS "phoneNumber", "company_companies"."website" AS "website", "company_companies"."territory.id" AS "territory.id", "company_companies"."territory.name" AS "territory.name", "company_companies"."territory._info.location_href" AS "territory._info.location_href", "company_companies"."market.id" AS "market.id", "company_companies"."market.name" AS "market.name", "company_companies"."market._info.Market_href" AS "market._info.Market_href", "company_companies"."defaultContact.id" AS "defaultContact.id", "company_companies"."defaultContact.name" AS "defaultContact.name", "company_companies"."defaultContact._info.contact_href" AS "defaultContact._info.contact_href", "company_companies"."dateAcquired" AS "dateAcquired", "company_companies"."annualRevenue" AS "annualRevenue", "company_companies"."timeZoneSetup.id" AS "timeZoneSetup.id", "company_companies"."timeZoneSetup.name" AS "timeZoneSetup.name", "company_companies"."timeZoneSetup._info.timeZoneSetup_href" AS "timeZoneSetup._info.timeZoneSetup_href", "company_companies"."leadFlag" AS "leadFlag", "company_companies"."unsubscribeFlag" AS "unsubscribeFlag", "company_companies"."taxCode.id" AS "taxCode.id", "company_companies"."taxCode.name" AS "taxCode.name", "company_companies"."taxCode._info.taxCode_href" AS "taxCode._info.taxCode_href", "company_companies"."billingTerms.id" AS "billingTerms.id", "company_companies"."billingTerms.name" AS "billingTerms.name", "company_companies"."billToCompany.id" AS "billToCompany.id", "company_companies"."billToCompany.identifier" AS "billToCompany.identifier", "company_companies"."billToCompany.name" AS "billToCompany.name", "company_companies"."billToCompany._info.company_href" AS "billToCompany._info.company_href", "company_companies"."invoiceDeliveryMethod.id" AS "invoiceDeliveryMethod.id", "company_companies"."invoiceDeliveryMethod.name" AS "invoiceDeliveryMethod.name", "company_companies"."deletedFlag" AS "deletedFlag", "company_companies"."mobileGuid" AS "mobileGuid", "company_companies"."isVendorFlag" AS "isVendorFlag", "company_companies"."types[0].id" AS "types[0].id", "company_companies"."types[0].name" AS "types[0].name", "company_companies"."types[0]._info.type_href" AS "types[0]._info.type_href", "company_companies"."site.id" AS "site.id", "company_companies"."site.name" AS "site.name", "company_companies"."site._info.site_href" AS "site._info.site_href", "company_companies"."_info.lastUpdated" AS "_info.lastUpdated", "company_companies"."_info.updatedBy" AS "_info.updatedBy", "company_companies"."_info.dateEntered" AS "_info.dateEntered", "company_companies"."_info.enteredBy" AS "_info.enteredBy", "company_companies"."_info.contacts_href" AS "_info.contacts_href", "company_companies"."_info.agreements_href" AS "_info.agreements_href", "company_companies"."_info.tickets_href" AS "_info.tickets_href", "company_companies"."_info.opportunities_href" AS "_info.opportunities_href", "company_companies"."_info.activities_href" AS "_info.activities_href", "company_companies"."_info.projects_href" AS "_info.projects_href", "company_companies"."_info.configurations_href" AS "_info.configurations_href", "company_companies"."_info.orders_href" AS "_info.orders_href", "company_companies"."_info.documents_href" AS "_info.documents_href", "company_companies"."_info.sites_href" AS "_info.sites_href", "company_companies"."_info.teams_href" AS "_info.teams_href", "company_companies"."_info.reports_href" AS "_info.reports_href", "company_companies"."_info.notes_href" AS "_info.notes_href", "company_companies"."addressLine1" AS "addressLine1", "company_companies"."addressLine2" AS "addressLine2", "company_companies"."city" AS "city", "company_companies"."state" AS "state", "company_companies"."zip" AS "zip", "company_companies"."faxNumber" AS "faxNumber", "company_companies"."accountNumber" AS "accountNumber", "company_companies"."numberOfEmployees" AS "numberOfEmployees", "company_companies"."leadSource" AS "leadSource", "company_companies"."billingContact.id" AS "billingContact.id", "company_companies"."billingContact.name" AS "billingContact.name", "company_companies"."billingContact._info.contact_href" AS "billingContact._info.contact_href", "company_companies"."invoiceToEmailAddress" AS "invoiceToEmailAddress", "company_companies"."billingSite.id" AS "billingSite.id", "company_companies"."billingSite.name" AS "billingSite.name", "company_companies"."billingSite._info.site_href" AS "billingSite._info.site_href", "company_configurations"."id" AS "id(company_configurations)", "company_configurations"."name" AS "name(company_configurations)", "company_configurations"."type.id" AS "type.id", "company_configurations"."type.name" AS "type.name", "company_configurations"."type._info.type_href" AS "type._info.type_href", "company_configurations"."status.id" AS "status.id(company_configurations)", "company_configurations"."status.name" AS "status.name(company_configurations)", "company_configurations"."status._info.status_href" AS "status._info.status_href(company_configurations)", "company_configurations"."company.id" AS "company.id", "company_configurations"."company.identifier" AS "company.identifier", "company_configurations"."company.name" AS "company.name", "company_configurations"."company._info.company_href" AS "company._info.company_href", "company_configurations"."contact.id" AS "contact.id", "company_configurations"."contact.name" AS "contact.name", "company_configurations"."contact._info.contact_href" AS "contact._info.contact_href", "company_configurations"."site.id" AS "site.id(company_configurations)", "company_configurations"."site.name" AS "site.name(company_configurations)", "company_configurations"."site._info.site_href" AS "site._info.site_href(company_configurations)", "company_configurations"."locationId" AS "locationId", "company_configurations"."location.id" AS "location.id", "company_configurations"."location.name" AS "location.name", "company_configurations"."location._info.location_href" AS "location._info.location_href", "company_configurations"."businessUnitId" AS "businessUnitId", "company_configurations"."department.id" AS "department.id", "company_configurations"."department.identifier" AS "department.identifier", "company_configurations"."department.name" AS "department.name", "company_configurations"."department._info.department_href" AS "department._info.department_href", "company_configurations"."serialNumber" AS "serialNumber", "company_configurations"."modelNumber" AS "modelNumber", "company_configurations"."tagNumber" AS "tagNumber", "company_configurations"."warrantyExpirationDate" AS "warrantyExpirationDate", "company_configurations"."notes" AS "notes", "company_configurations"."billFlag" AS "billFlag", "company_configurations"."vendor.id" AS "vendor.id", "company_configurations"."vendor.identifier" AS "vendor.identifier", "company_configurations"."vendor.name" AS "vendor.name", "company_configurations"."vendor._info.company_href" AS "vendor._info.company_href", "company_configurations"."activeFlag" AS "activeFlag", "company_configurations"."mobileGuid" AS "mobileGuid(company_configurations)", "company_configurations"."companyLocationId" AS "companyLocationId", "company_configurations"."showRemoteFlag" AS "showRemoteFlag", "company_configurations"."showAutomateFlag" AS "showAutomateFlag", "company_configurations"."needsRenewalFlag" AS "needsRenewalFlag", "company_configurations"."_info.lastUpdated" AS "_info.lastUpdated(company_configurations)", "company_configurations"."_info.updatedBy" AS "_info.updatedBy(company_configurations)", "company_configurations"."_info.dateEntered" AS "_info.dateEntered(company_configurations)", "company_configurations"."_info.enteredBy" AS "_info.enteredBy(company_configurations)", "company_configurations"."backupSuccesses" AS "backupSuccesses", "company_configurations"."backupIncomplete" AS "backupIncomplete", "company_configurations"."backupFailed" AS "backupFailed", "company_configurations"."backupRestores" AS "backupRestores", "company_configurations"."backupBillableSpaceGb" AS "backupBillableSpaceGb", "company_configurations"."backupYear" AS "backupYear", "company_configurations"."backupMonth" AS "backupMonth", "service_tickets"."id" AS "id(service_tickets)", "service_tickets"."summary" AS "summary", "service_tickets"."recordType" AS "recordType", "service_tickets"."board.id" AS "board.id", "service_tickets"."board.name" AS "board.name", "service_tickets"."board._info.board_href" AS "board._info.board_href", "service_tickets"."status.id" AS "status.id(service_tickets)", "service_tickets"."status.name" AS "status.name(service_tickets)", "service_tickets"."status.Sort" AS "status.Sort", "service_tickets"."status._info.status_href" AS "status._info.status_href(service_tickets)", "service_tickets"."company.id" AS "company.id(service_tickets)", "service_tickets"."company.identifier" AS "company.identifier(service_tickets)", "service_tickets"."company.name" AS "company.name(service_tickets)", "service_tickets"."company._info.company_href" AS "company._info.company_href(service_tickets)", "service_tickets"."company._info.mobileGuid" AS "company._info.mobileGuid", "service_tickets"."site.id" AS "site.id(service_tickets)", "service_tickets"."site.name" AS "site.name(service_tickets)", "service_tickets"."site._info.site_href" AS "site._info.site_href(service_tickets)", "service_tickets"."site._info.mobileGuid" AS "site._info.mobileGuid", "service_tickets"."addressLine1" AS "addressLine1(service_tickets)", "service_tickets"."addressLine2" AS "addressLine2(service_tickets)", "service_tickets"."city" AS "city(service_tickets)", "service_tickets"."stateIdentifier" AS "stateIdentifier", "service_tickets"."zip" AS "zip(service_tickets)", "service_tickets"."contact.id" AS "contact.id(service_tickets)", "service_tickets"."contact.name" AS "contact.name(service_tickets)", "service_tickets"."contact._info.mobileGuid" AS "contact._info.mobileGuid", "service_tickets"."contact._info.contact_href" AS "contact._info.contact_href(service_tickets)", "service_tickets"."contactName" AS "contactName", "service_tickets"."contactPhoneNumber" AS "contactPhoneNumber", "service_tickets"."contactPhoneExtension" AS "contactPhoneExtension", "service_tickets"."contactEmailAddress" AS "contactEmailAddress", "service_tickets"."team.id" AS "team.id", "service_tickets"."team.name" AS "team.name", "service_tickets"."team._info.team_href" AS "team._info.team_href", "service_tickets"."priority.id" AS "priority.id", "service_tickets"."priority.name" AS "priority.name", "service_tickets"."priority.sort" AS "priority.sort", "service_tickets"."priority._info.priority_href" AS "priority._info.priority_href", "service_tickets"."priority._info.image_href" AS "priority._info.image_href", "service_tickets"."serviceLocation.id" AS "serviceLocation.id", "service_tickets"."serviceLocation.name" AS "serviceLocation.name", "service_tickets"."serviceLocation._info.location_href" AS "serviceLocation._info.location_href", "service_tickets"."source.id" AS "source.id", "service_tickets"."source.name" AS "source.name", "service_tickets"."source._info.source_href" AS "source._info.source_href", "service_tickets"."agreement.id" AS "agreement.id", "service_tickets"."agreement.name" AS "agreement.name", "service_tickets"."agreement._info.agreement_href" AS "agreement._info.agreement_href", "service_tickets"."severity" AS "severity", "service_tickets"."impact" AS "impact", "service_tickets"."allowAllClientsPortalView" AS "allowAllClientsPortalView", "service_tickets"."customerUpdatedFlag" AS "customerUpdatedFlag", "service_tickets"."automaticEmailContactFlag" AS "automaticEmailContactFlag", "service_tickets"."automaticEmailResourceFlag" AS "automaticEmailResourceFlag", "service_tickets"."automaticEmailCcFlag" AS "automaticEmailCcFlag", "service_tickets"."closedDate" AS "closedDate", "service_tickets"."closedBy" AS "closedBy", "service_tickets"."closedFlag" AS "closedFlag", "service_tickets"."actualHours" AS "actualHours", "service_tickets"."approved" AS "approved", "service_tickets"."estimatedExpenseCost" AS "estimatedExpenseCost", "service_tickets"."estimatedExpenseRevenue" AS "estimatedExpenseRevenue", "service_tickets"."estimatedProductCost" AS "estimatedProductCost", "service_tickets"."estimatedProductRevenue" AS "estimatedProductRevenue", "service_tickets"."estimatedTimeCost" AS "estimatedTimeCost", "service_tickets"."estimatedTimeRevenue" AS "estimatedTimeRevenue", "service_tickets"."billingMethod" AS "billingMethod", "service_tickets"."dateResplan" AS "dateResplan", "service_tickets"."dateResponded" AS "dateResponded", "service_tickets"."resolveMinutes" AS "resolveMinutes", "service_tickets"."resPlanMinutes" AS "resPlanMinutes", "service_tickets"."respondMinutes" AS "respondMinutes", "service_tickets"."isInSla" AS "isInSla", "service_tickets"."hasChildTicket" AS "hasChildTicket", "service_tickets"."hasMergedChildTicketFlag" AS "hasMergedChildTicketFlag", "service_tickets"."billTime" AS "billTime", "service_tickets"."billExpenses" AS "billExpenses", "service_tickets"."billProducts" AS "billProducts", "service_tickets"."location.id" AS "location.id(service_tickets)", "service_tickets"."location.name" AS "location.name(service_tickets)", "service_tickets"."location._info.location_href" AS "location._info.location_href(service_tickets)", "service_tickets"."department.id" AS "department.id(service_tickets)", "service_tickets"."department.identifier" AS "department.identifier(service_tickets)", "service_tickets"."department.name" AS "department.name(service_tickets)", "service_tickets"."department._info.department_href" AS "department._info.department_href(service_tickets)", "service_tickets"."mobileGuid" AS "mobileGuid(service_tickets)", "service_tickets"."sla.id" AS "sla.id", "service_tickets"."sla.name" AS "sla.name", "service_tickets"."sla._info.sla_href" AS "sla._info.sla_href", "service_tickets"."currency.id" AS "currency.id", "service_tickets"."currency.symbol" AS "currency.symbol", "service_tickets"."currency.currencyCode" AS "currency.currencyCode", "service_tickets"."currency.decimalSeparator" AS "currency.decimalSeparator", "service_tickets"."currency.numberOfDecimals" AS "currency.numberOfDecimals", "service_tickets"."currency.thousandsSeparator" AS "currency.thousandsSeparator", "service_tickets"."currency.negativeParenthesesFlag" AS "currency.negativeParenthesesFlag", "service_tickets"."currency.displaySymbolFlag" AS "currency.displaySymbolFlag", "service_tickets"."currency.currencyIdentifier" AS "currency.currencyIdentifier", "service_tickets"."currency.displayIdFlag" AS "currency.displayIdFlag", "service_tickets"."currency.rightAlign" AS "currency.rightAlign", "service_tickets"."currency.name" AS "currency.name", "service_tickets"."currency._info.currency_href" AS "currency._info.currency_href", "service_tickets"."_info.lastUpdated" AS "_info.lastUpdated(service_tickets)", "service_tickets"."_info.updatedBy" AS "_info.updatedBy(service_tickets)", "service_tickets"."_info.dateEntered" AS "_info.dateEntered(service_tickets)", "service_tickets"."_info.enteredBy" AS "_info.enteredBy(service_tickets)", "service_tickets"."_info.activities_href" AS "_info.activities_href(service_tickets)", "service_tickets"."_info.scheduleentries_href" AS "_info.scheduleentries_href", "service_tickets"."_info.documents_href" AS "_info.documents_href(service_tickets)", "service_tickets"."_info.configurations_href" AS "_info.configurations_href(service_tickets)", "service_tickets"."_info.tasks_href" AS "_info.tasks_href", "service_tickets"."_info.notes_href" AS "_info.notes_href(service_tickets)", "service_tickets"."_info.products_href" AS "_info.products_href", "service_tickets"."_info.timeentries_href" AS "_info.timeentries_href", "service_tickets"."_info.expenseEntries_href" AS "_info.expenseEntries_href", "service_tickets"."escalationStartDateUTC" AS "escalationStartDateUTC", "service_tickets"."escalationLevel" AS "escalationLevel", "service_tickets"."minutesBeforeWaiting" AS "minutesBeforeWaiting", "service_tickets"."respondedSkippedMinutes" AS "respondedSkippedMinutes", "service_tickets"."resplanSkippedMinutes" AS "resplanSkippedMinutes", "service_tickets"."respondedHours" AS "respondedHours", "service_tickets"."respondedBy" AS "respondedBy", "service_tickets"."resplanHours" AS "resplanHours", "service_tickets"."resplanBy" AS "resplanBy", "service_tickets"."resolutionHours" AS "resolutionHours", "service_tickets"."minutesWaiting" AS "minutesWaiting", "service_tickets"."workType.id" AS "workType.id", "service_tickets"."workType.name" AS "workType.name", "service_tickets"."workType._info.workType_href" AS "workType._info.workType_href", "service_tickets"."resources" AS "resources", "service_tickets"."workRole.id" AS "workRole.id", "service_tickets"."workRole.name" AS "workRole.name", "service_tickets"."workRole._info.workRole_href" AS "workRole._info.workRole_href", "service_tickets"."type.id" AS "type.id(service_tickets)", "service_tickets"."type.name" AS "type.name(service_tickets)", "service_tickets"."type._info.type_href" AS "type._info.type_href(service_tickets)", "service_tickets"."requiredDate" AS "requiredDate", "service_tickets"."budgetHours" AS "budgetHours", "service_tickets"."requestForChangeFlag" AS "requestForChangeFlag" FROM "Halops_Dash"."company_companies" AS "company_companies" INNER JOIN "Halops_Dash"."company_configurations" AS "company_configurations" ON "company_companies"."id" = "company_configurations"."id" INNER JOIN "Halops_Dash"."service_tickets" AS "service_tickets" ON "company_companies"."id" = "service_tickets"."id") temp_table ORDER BY "CNTD(annualRevenue)" ASC NULLS FIRST'''

shft_q9 = '''SELECT COUNT(DISTINCT "id") AS "CNTD(id)" FROM (SELECT "company_companies"."id" AS "id", "company_companies"."identifier" AS "identifier", "company_companies"."name" AS "name", "company_companies"."status.id" AS "status.id", "company_companies"."status.name" AS "status.name", "company_companies"."status._info.status_href" AS "status._info.status_href", "company_companies"."country.id" AS "country.id", "company_companies"."country.name" AS "country.name", "company_companies"."country._info.country_href" AS "country._info.country_href", "company_companies"."phoneNumber" AS "phoneNumber", "company_companies"."website" AS "website", "company_companies"."territory.id" AS "territory.id", "company_companies"."territory.name" AS "territory.name", "company_companies"."territory._info.location_href" AS "territory._info.location_href", "company_companies"."market.id" AS "market.id", "company_companies"."market.name" AS "market.name", "company_companies"."market._info.Market_href" AS "market._info.Market_href", "company_companies"."defaultContact.id" AS "defaultContact.id", "company_companies"."defaultContact.name" AS "defaultContact.name", "company_companies"."defaultContact._info.contact_href" AS "defaultContact._info.contact_href", "company_companies"."dateAcquired" AS "dateAcquired", "company_companies"."annualRevenue" AS "annualRevenue", "company_companies"."timeZoneSetup.id" AS "timeZoneSetup.id", "company_companies"."timeZoneSetup.name" AS "timeZoneSetup.name", "company_companies"."timeZoneSetup._info.timeZoneSetup_href" AS "timeZoneSetup._info.timeZoneSetup_href", "company_companies"."leadFlag" AS "leadFlag", "company_companies"."unsubscribeFlag" AS "unsubscribeFlag", "company_companies"."taxCode.id" AS "taxCode.id", "company_companies"."taxCode.name" AS "taxCode.name", "company_companies"."taxCode._info.taxCode_href" AS "taxCode._info.taxCode_href", "company_companies"."billingTerms.id" AS "billingTerms.id", "company_companies"."billingTerms.name" AS "billingTerms.name", "company_companies"."billToCompany.id" AS "billToCompany.id", "company_companies"."billToCompany.identifier" AS "billToCompany.identifier", "company_companies"."billToCompany.name" AS "billToCompany.name", "company_companies"."billToCompany._info.company_href" AS "billToCompany._info.company_href", "company_companies"."invoiceDeliveryMethod.id" AS "invoiceDeliveryMethod.id", "company_companies"."invoiceDeliveryMethod.name" AS "invoiceDeliveryMethod.name", "company_companies"."deletedFlag" AS "deletedFlag", "company_companies"."mobileGuid" AS "mobileGuid", "company_companies"."isVendorFlag" AS "isVendorFlag", "company_companies"."types[0].id" AS "types[0].id", "company_companies"."types[0].name" AS "types[0].name", "company_companies"."types[0]._info.type_href" AS "types[0]._info.type_href", "company_companies"."site.id" AS "site.id", "company_companies"."site.name" AS "site.name", "company_companies"."site._info.site_href" AS "site._info.site_href", "company_companies"."_info.lastUpdated" AS "_info.lastUpdated", "company_companies"."_info.updatedBy" AS "_info.updatedBy", "company_companies"."_info.dateEntered" AS "_info.dateEntered", "company_companies"."_info.enteredBy" AS "_info.enteredBy", "company_companies"."_info.contacts_href" AS "_info.contacts_href", "company_companies"."_info.agreements_href" AS "_info.agreements_href", "company_companies"."_info.tickets_href" AS "_info.tickets_href", "company_companies"."_info.opportunities_href" AS "_info.opportunities_href", "company_companies"."_info.activities_href" AS "_info.activities_href", "company_companies"."_info.projects_href" AS "_info.projects_href", "company_companies"."_info.configurations_href" AS "_info.configurations_href", "company_companies"."_info.orders_href" AS "_info.orders_href", "company_companies"."_info.documents_href" AS "_info.documents_href", "company_companies"."_info.sites_href" AS "_info.sites_href", "company_companies"."_info.teams_href" AS "_info.teams_href", "company_companies"."_info.reports_href" AS "_info.reports_href", "company_companies"."_info.notes_href" AS "_info.notes_href", "company_companies"."addressLine1" AS "addressLine1", "company_companies"."addressLine2" AS "addressLine2", "company_companies"."city" AS "city", "company_companies"."state" AS "state", "company_companies"."zip" AS "zip", "company_companies"."faxNumber" AS "faxNumber", "company_companies"."accountNumber" AS "accountNumber", "company_companies"."numberOfEmployees" AS "numberOfEmployees", "company_companies"."leadSource" AS "leadSource", "company_companies"."billingContact.id" AS "billingContact.id", "company_companies"."billingContact.name" AS "billingContact.name", "company_companies"."billingContact._info.contact_href" AS "billingContact._info.contact_href", "company_companies"."invoiceToEmailAddress" AS "invoiceToEmailAddress", "company_companies"."billingSite.id" AS "billingSite.id", "company_companies"."billingSite.name" AS "billingSite.name", "company_companies"."billingSite._info.site_href" AS "billingSite._info.site_href", "company_configurations"."id" AS "id(company_configurations)", "company_configurations"."name" AS "name(company_configurations)", "company_configurations"."type.id" AS "type.id", "company_configurations"."type.name" AS "type.name", "company_configurations"."type._info.type_href" AS "type._info.type_href", "company_configurations"."status.id" AS "status.id(company_configurations)", "company_configurations"."status.name" AS "status.name(company_configurations)", "company_configurations"."status._info.status_href" AS "status._info.status_href(company_configurations)", "company_configurations"."company.id" AS "company.id", "company_configurations"."company.identifier" AS "company.identifier", "company_configurations"."company.name" AS "company.name", "company_configurations"."company._info.company_href" AS "company._info.company_href", "company_configurations"."contact.id" AS "contact.id", "company_configurations"."contact.name" AS "contact.name", "company_configurations"."contact._info.contact_href" AS "contact._info.contact_href", "company_configurations"."site.id" AS "site.id(company_configurations)", "company_configurations"."site.name" AS "site.name(company_configurations)", "company_configurations"."site._info.site_href" AS "site._info.site_href(company_configurations)", "company_configurations"."locationId" AS "locationId", "company_configurations"."location.id" AS "location.id", "company_configurations"."location.name" AS "location.name", "company_configurations"."location._info.location_href" AS "location._info.location_href", "company_configurations"."businessUnitId" AS "businessUnitId", "company_configurations"."department.id" AS "department.id", "company_configurations"."department.identifier" AS "department.identifier", "company_configurations"."department.name" AS "department.name", "company_configurations"."department._info.department_href" AS "department._info.department_href", "company_configurations"."serialNumber" AS "serialNumber", "company_configurations"."modelNumber" AS "modelNumber", "company_configurations"."tagNumber" AS "tagNumber", "company_configurations"."warrantyExpirationDate" AS "warrantyExpirationDate", "company_configurations"."notes" AS "notes", "company_configurations"."billFlag" AS "billFlag", "company_configurations"."vendor.id" AS "vendor.id", "company_configurations"."vendor.identifier" AS "vendor.identifier", "company_configurations"."vendor.name" AS "vendor.name", "company_configurations"."vendor._info.company_href" AS "vendor._info.company_href", "company_configurations"."activeFlag" AS "activeFlag", "company_configurations"."mobileGuid" AS "mobileGuid(company_configurations)", "company_configurations"."companyLocationId" AS "companyLocationId", "company_configurations"."showRemoteFlag" AS "showRemoteFlag", "company_configurations"."showAutomateFlag" AS "showAutomateFlag", "company_configurations"."needsRenewalFlag" AS "needsRenewalFlag", "company_configurations"."_info.lastUpdated" AS "_info.lastUpdated(company_configurations)", "company_configurations"."_info.updatedBy" AS "_info.updatedBy(company_configurations)", "company_configurations"."_info.dateEntered" AS "_info.dateEntered(company_configurations)", "company_configurations"."_info.enteredBy" AS "_info.enteredBy(company_configurations)", "company_configurations"."backupSuccesses" AS "backupSuccesses", "company_configurations"."backupIncomplete" AS "backupIncomplete", "company_configurations"."backupFailed" AS "backupFailed", "company_configurations"."backupRestores" AS "backupRestores", "company_configurations"."backupBillableSpaceGb" AS "backupBillableSpaceGb", "company_configurations"."backupYear" AS "backupYear", "company_configurations"."backupMonth" AS "backupMonth", "service_tickets"."id" AS "id(service_tickets)", "service_tickets"."summary" AS "summary", "service_tickets"."recordType" AS "recordType", "service_tickets"."board.id" AS "board.id", "service_tickets"."board.name" AS "board.name", "service_tickets"."board._info.board_href" AS "board._info.board_href", "service_tickets"."status.id" AS "status.id(service_tickets)", "service_tickets"."status.name" AS "status.name(service_tickets)", "service_tickets"."status.Sort" AS "status.Sort", "service_tickets"."status._info.status_href" AS "status._info.status_href(service_tickets)", "service_tickets"."company.id" AS "company.id(service_tickets)", "service_tickets"."company.identifier" AS "company.identifier(service_tickets)", "service_tickets"."company.name" AS "company.name(service_tickets)", "service_tickets"."company._info.company_href" AS "company._info.company_href(service_tickets)", "service_tickets"."company._info.mobileGuid" AS "company._info.mobileGuid", "service_tickets"."site.id" AS "site.id(service_tickets)", "service_tickets"."site.name" AS "site.name(service_tickets)", "service_tickets"."site._info.site_href" AS "site._info.site_href(service_tickets)", "service_tickets"."site._info.mobileGuid" AS "site._info.mobileGuid", "service_tickets"."addressLine1" AS "addressLine1(service_tickets)", "service_tickets"."addressLine2" AS "addressLine2(service_tickets)", "service_tickets"."city" AS "city(service_tickets)", "service_tickets"."stateIdentifier" AS "stateIdentifier", "service_tickets"."zip" AS "zip(service_tickets)", "service_tickets"."contact.id" AS "contact.id(service_tickets)", "service_tickets"."contact.name" AS "contact.name(service_tickets)", "service_tickets"."contact._info.mobileGuid" AS "contact._info.mobileGuid", "service_tickets"."contact._info.contact_href" AS "contact._info.contact_href(service_tickets)", "service_tickets"."contactName" AS "contactName", "service_tickets"."contactPhoneNumber" AS "contactPhoneNumber", "service_tickets"."contactPhoneExtension" AS "contactPhoneExtension", "service_tickets"."contactEmailAddress" AS "contactEmailAddress", "service_tickets"."team.id" AS "team.id", "service_tickets"."team.name" AS "team.name", "service_tickets"."team._info.team_href" AS "team._info.team_href", "service_tickets"."priority.id" AS "priority.id", "service_tickets"."priority.name" AS "priority.name", "service_tickets"."priority.sort" AS "priority.sort", "service_tickets"."priority._info.priority_href" AS "priority._info.priority_href", "service_tickets"."priority._info.image_href" AS "priority._info.image_href", "service_tickets"."serviceLocation.id" AS "serviceLocation.id", "service_tickets"."serviceLocation.name" AS "serviceLocation.name", "service_tickets"."serviceLocation._info.location_href" AS "serviceLocation._info.location_href", "service_tickets"."source.id" AS "source.id", "service_tickets"."source.name" AS "source.name", "service_tickets"."source._info.source_href" AS "source._info.source_href", "service_tickets"."agreement.id" AS "agreement.id", "service_tickets"."agreement.name" AS "agreement.name", "service_tickets"."agreement._info.agreement_href" AS "agreement._info.agreement_href", "service_tickets"."severity" AS "severity", "service_tickets"."impact" AS "impact", "service_tickets"."allowAllClientsPortalView" AS "allowAllClientsPortalView", "service_tickets"."customerUpdatedFlag" AS "customerUpdatedFlag", "service_tickets"."automaticEmailContactFlag" AS "automaticEmailContactFlag", "service_tickets"."automaticEmailResourceFlag" AS "automaticEmailResourceFlag", "service_tickets"."automaticEmailCcFlag" AS "automaticEmailCcFlag", "service_tickets"."closedDate" AS "closedDate", "service_tickets"."closedBy" AS "closedBy", "service_tickets"."closedFlag" AS "closedFlag", "service_tickets"."actualHours" AS "actualHours", "service_tickets"."approved" AS "approved", "service_tickets"."estimatedExpenseCost" AS "estimatedExpenseCost", "service_tickets"."estimatedExpenseRevenue" AS "estimatedExpenseRevenue", "service_tickets"."estimatedProductCost" AS "estimatedProductCost", "service_tickets"."estimatedProductRevenue" AS "estimatedProductRevenue", "service_tickets"."estimatedTimeCost" AS "estimatedTimeCost", "service_tickets"."estimatedTimeRevenue" AS "estimatedTimeRevenue", "service_tickets"."billingMethod" AS "billingMethod", "service_tickets"."dateResplan" AS "dateResplan", "service_tickets"."dateResponded" AS "dateResponded", "service_tickets"."resolveMinutes" AS "resolveMinutes", "service_tickets"."resPlanMinutes" AS "resPlanMinutes", "service_tickets"."respondMinutes" AS "respondMinutes", "service_tickets"."isInSla" AS "isInSla", "service_tickets"."hasChildTicket" AS "hasChildTicket", "service_tickets"."hasMergedChildTicketFlag" AS "hasMergedChildTicketFlag", "service_tickets"."billTime" AS "billTime", "service_tickets"."billExpenses" AS "billExpenses", "service_tickets"."billProducts" AS "billProducts", "service_tickets"."location.id" AS "location.id(service_tickets)", "service_tickets"."location.name" AS "location.name(service_tickets)", "service_tickets"."location._info.location_href" AS "location._info.location_href(service_tickets)", "service_tickets"."department.id" AS "department.id(service_tickets)", "service_tickets"."department.identifier" AS "department.identifier(service_tickets)", "service_tickets"."department.name" AS "department.name(service_tickets)", "service_tickets"."department._info.department_href" AS "department._info.department_href(service_tickets)", "service_tickets"."mobileGuid" AS "mobileGuid(service_tickets)", "service_tickets"."sla.id" AS "sla.id", "service_tickets"."sla.name" AS "sla.name", "service_tickets"."sla._info.sla_href" AS "sla._info.sla_href", "service_tickets"."currency.id" AS "currency.id", "service_tickets"."currency.symbol" AS "currency.symbol", "service_tickets"."currency.currencyCode" AS "currency.currencyCode", "service_tickets"."currency.decimalSeparator" AS "currency.decimalSeparator", "service_tickets"."currency.numberOfDecimals" AS "currency.numberOfDecimals", "service_tickets"."currency.thousandsSeparator" AS "currency.thousandsSeparator", "service_tickets"."currency.negativeParenthesesFlag" AS "currency.negativeParenthesesFlag", "service_tickets"."currency.displaySymbolFlag" AS "currency.displaySymbolFlag", "service_tickets"."currency.currencyIdentifier" AS "currency.currencyIdentifier", "service_tickets"."currency.displayIdFlag" AS "currency.displayIdFlag", "service_tickets"."currency.rightAlign" AS "currency.rightAlign", "service_tickets"."currency.name" AS "currency.name", "service_tickets"."currency._info.currency_href" AS "currency._info.currency_href", "service_tickets"."_info.lastUpdated" AS "_info.lastUpdated(service_tickets)", "service_tickets"."_info.updatedBy" AS "_info.updatedBy(service_tickets)", "service_tickets"."_info.dateEntered" AS "_info.dateEntered(service_tickets)", "service_tickets"."_info.enteredBy" AS "_info.enteredBy(service_tickets)", "service_tickets"."_info.activities_href" AS "_info.activities_href(service_tickets)", "service_tickets"."_info.scheduleentries_href" AS "_info.scheduleentries_href", "service_tickets"."_info.documents_href" AS "_info.documents_href(service_tickets)", "service_tickets"."_info.configurations_href" AS "_info.configurations_href(service_tickets)", "service_tickets"."_info.tasks_href" AS "_info.tasks_href", "service_tickets"."_info.notes_href" AS "_info.notes_href(service_tickets)", "service_tickets"."_info.products_href" AS "_info.products_href", "service_tickets"."_info.timeentries_href" AS "_info.timeentries_href", "service_tickets"."_info.expenseEntries_href" AS "_info.expenseEntries_href", "service_tickets"."escalationStartDateUTC" AS "escalationStartDateUTC", "service_tickets"."escalationLevel" AS "escalationLevel", "service_tickets"."minutesBeforeWaiting" AS "minutesBeforeWaiting", "service_tickets"."respondedSkippedMinutes" AS "respondedSkippedMinutes", "service_tickets"."resplanSkippedMinutes" AS "resplanSkippedMinutes", "service_tickets"."respondedHours" AS "respondedHours", "service_tickets"."respondedBy" AS "respondedBy", "service_tickets"."resplanHours" AS "resplanHours", "service_tickets"."resplanBy" AS "resplanBy", "service_tickets"."resolutionHours" AS "resolutionHours", "service_tickets"."minutesWaiting" AS "minutesWaiting", "service_tickets"."workType.id" AS "workType.id", "service_tickets"."workType.name" AS "workType.name", "service_tickets"."workType._info.workType_href" AS "workType._info.workType_href", "service_tickets"."resources" AS "resources", "service_tickets"."workRole.id" AS "workRole.id", "service_tickets"."workRole.name" AS "workRole.name", "service_tickets"."workRole._info.workRole_href" AS "workRole._info.workRole_href", "service_tickets"."type.id" AS "type.id(service_tickets)", "service_tickets"."type.name" AS "type.name(service_tickets)", "service_tickets"."type._info.type_href" AS "type._info.type_href(service_tickets)", "service_tickets"."requiredDate" AS "requiredDate", "service_tickets"."budgetHours" AS "budgetHours", "service_tickets"."requestForChangeFlag" AS "requestForChangeFlag" FROM "Halops_Dash"."company_companies" AS "company_companies" INNER JOIN "Halops_Dash"."company_configurations" AS "company_configurations" ON "company_companies"."id" = "company_configurations"."id" INNER JOIN "Halops_Dash"."service_tickets" AS "service_tickets" ON "company_companies"."id" = "service_tickets"."id") temp_table ORDER BY "CNTD(id)" ASC NULLS FIRST'''


def query_form(tok1,hierarchy_id,display_name):
    table_names=[[f'{display_name}', 'company_companies', 'company_companies'], [f'{display_name}', 'company_configurations', 'company_configurations'], [f'{display_name}', 'service_tickets', 'service_tickets']]
    # updated_data = [[(display_name if element == 'display_name' else element) for element in sublist] for sublist in table_names]
    quer_tb=dshb_models.QuerySets.objects.create(
        user_id=tok1['user_id'],
        hierarchy_id=hierarchy_id,
        table_names=table_names,
        join_type=['inner', 'inner'],
        joining_conditions=[[{'table1': 'company_companies', 'firstcolumn': 'id', 'operator': '=', 'secondcolumn': 'id', 'table2': 'company_configurations'}], [{'table1': 'company_companies', 'firstcolumn': 'id', 'operator': '=', 'secondcolumn': 'id', 'table2': 'service_tickets'}], []],
        is_custom_sql=False,
        custom_query = query_table.replace('"', '\\"').replace('Halops_Dash',f'{display_name}'),
        query_name="template_connectwise_query",
        created_at=datetime.datetime.now(),
        updated_at=datetime.datetime.now(),
        is_sample=False,
        datasource_path=None,
        datasource_json=None
    )
    quer_tb.save()
    return quer_tb


def sheets_list(queryset_id,tok1,hierarchy_id,display_name):
    sheetFilterQuerySetData=[
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "name"'],
            "rows": [' "leadFlag"', ' "deletedFlag"', ' "unsubscribeFlag"', ' "isVendorFlag"'],
            # "custom_query": shft_q1.replace('"','\\"'),
            "custom_query" : shft_q1.replace('"','\\"').replace('Halops_Dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "name"', ' "estimatedProductCost"'],
            "rows": [' "billTime"', ' "billProducts"', '"sum(estimatedProductCost)"', ' "currency.name"', '"sum(estimatedTimeCost)"'],
            "custom_query": shft_q2.replace('"','\\"').replace('Halops_Dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "name(company_configurations)"'],
            "rows": [' "CNTD(escalationLevel)"', ' "approved"', ' "severity"'],
            "custom_query": shft_q3.replace('"','\\"').replace('Halops_Dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "name(company_configurations)"'],
            "rows": ['"count(actualHours)"', '"count(respondedHours)"', '"count(budgetHours)"'],
            "custom_query": shft_q4.replace('"','\\"').replace('Halops_Dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [' "name"'],
            "rows": ['"sum(annualRevenue)"'],
            "custom_query": shft_q5.replace('"','\\"').replace('Halops_Dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": [' "CNTD(numberOfEmployees)"'],
            "custom_query": shft_q6.replace('"','\\"').replace('Halops_Dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": [' "CNTD(id(service_tickets))"'],
            "custom_query": shft_q7.replace('"','\\"').replace('Halops_Dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": [' "CNTD(annualRevenue)"'],
            "custom_query": shft_q8.replace('"','\\"').replace('Halops_Dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "datasource_querysetid": "",
            "queryset_id": queryset_id,
            "user_id": tok1['user_id'],
            "hierarchy_id": hierarchy_id,
            "filter_id_list": [],
            "columns": [],
            "rows": [' "CNTD(id)"'],
            "custom_query": shft_q9.replace('"', '\\"').replace('Halops_Dash',f'{display_name}'),
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
    ]
    try:
        for entry in sheetFilterQuerySetData:
            sheetfilter_table_create=dshb_models.SheetFilter_querysets.objects.create(
                datasource_querysetid=int(entry.get("datasource_querysetid") or 0) if entry.get("datasource_querysetid") else None,
                queryset_id=int(entry.get("queryset_id") or 0) if entry.get("queryset_id") else None,
                user_id=entry.get("user_id"),
                hierarchy_id=int(entry.get("hierarchy_id") or 0) if entry.get("hierarchy_id") else None,
                filter_id_list=json.dumps(entry.get("filter_id_list", [])),
                columns=json.dumps(entry.get("columns", [])),
                rows=json.dumps(entry.get("rows", [])),
                custom_query=entry.get("custom_query"),
                created_at=entry.get("created_at", datetime.datetime.now()),
                updated_at=entry.get("updated_at", datetime.datetime.now()),
            )
            sheetfilter_table_create.save()
        # self.stdout.write(self.style.SUCCESS('Successfully imported data into SheetFilter QuerySet'))
    except Exception as e:
        pass
    sheet_filter_queryset_ids_list = dshb_models.SheetFilter_querysets.objects.filter(user_id=tok1['user_id'], queryset_id=queryset_id).values_list('Sheetqueryset_id', flat=True).order_by('Sheetqueryset_id')
    return sheetfilter_table_create,sheet_filter_queryset_ids_list


def sheets_data(queryset_id,tok1,hierarchy_id,display_name):
    sheet_filter_table,sheet_filter_querysets=sheets_list(queryset_id,tok1,hierarchy_id,display_name)
    print("sh_fl",sheet_filter_querysets)
    sheetData = [
        {
            "user_id": tok1['user_id'],
            "chart_id": 1,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Flags Info",
            "sheetfilter_querysets_id": sheet_filter_querysets[0],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Flags Info</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 1,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Ticket Info",
            "sheetfilter_querysets_id": sheet_filter_querysets[1],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Ticket Info</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 1,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Ticket Status",
            "sheetfilter_querysets_id": sheet_filter_querysets[2],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Ticket Status</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 8,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Company wise Hours status",
            "sheetfilter_querysets_id": sheet_filter_querysets[3],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Company wise Hours status</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 24,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Company wise annual revenue",
            "sheetfilter_querysets_id": sheet_filter_querysets[4],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Company wise annual revenue</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Total Employees",
            "sheetfilter_querysets_id": sheet_filter_querysets[5],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Total Employees</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Total Tickets",
            "sheetfilter_querysets_id": sheet_filter_querysets[6],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Total Tickets</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Total Annual Revenue",
            "sheetfilter_querysets_id": sheet_filter_querysets[7],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Total Annual Revenue</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
        {
            "user_id": tok1['user_id'],
            "chart_id": 25,
            "hierarchy_id": hierarchy_id,
            "queryset_id": queryset_id,
            "filter_ids": [],
            "sheet_name": "Total Companies",
            "sheetfilter_querysets_id": sheet_filter_querysets[8],
            "datapath": '',
            "datasrc": "",
            "sheet_tag_name": """<p>Total Companies</p>""",
            "created_at": datetime.datetime.now(),
            "updated_at": datetime.datetime.now()
        },
    ]
    try:
        for data in sheetData:
            sheet_data_instance = dshb_models.sheet_data(
                user_id=data['user_id'],
                chart_id=data['chart_id'],
                hierarchy_id=data['hierarchy_id'],
                is_sample=False,
                queryset_id=data['queryset_id'],
                filter_ids=data['filter_ids'],
                sheet_name=data['sheet_name'],
                sheet_filt_id=data['sheetfilter_querysets_id'],
                datapath=data['datapath'],
                datasrc=data['datasrc'],
                sheet_tag_name=data['sheet_tag_name'],
                created_at=data['created_at'],
                updated_at=data['updated_at'],
            )
            sheet_data_instance.save()
    except Exception as e:
        pass
    # return sheet_data_instance
    sheet_ids_list = list(dshb_models.sheet_data.objects.filter(user_id=tok1['user_id'], queryset_id=queryset_id).values_list('id', flat=True).order_by('-id'))
    return sheet_data_instance,sheet_ids_list


def dashbaord_data(queryset_id,tok1,hierarchy_id,sheet_ids_list):
    dashb_tb = dshb_models.dashboard_data.objects.create(
        user_id=tok1['user_id'],
        hierarchy_id=[hierarchy_id],
        queryset_id=queryset_id,
        sheet_ids=sheet_ids_list,
        selected_sheet_ids=sheet_ids_list,
        height=1800,
        width=1200,
        grid_id=2,
        is_sample=False,
        role_ids=[],
        user_ids=[],
        dashboard_name="templ_connectwise",
        datapath='',
        datasrc='',
        imagepath='',
        imagesrc='',
        dashboard_tag_name="""<p>templ_connectwise</p>""",
        is_public=False,
        created_at=datetime.datetime.now(),
        updated_at=datetime.datetime.now(),
        )
    dashb_tb.save()
    return dashb_tb



@api_view(['GET'])
@transaction.atomic
@csrf_exempt
def connectwise_dashbaord(request,hierarchy_id,token):
    if request.method=='GET':
        tok1 = views.test_token(token)
        if tok1['status']==200:
            try:
                dis_name=Connections.display_name(hierarchy_id)
                database_name=dis_name.display_name
            except:
                return Response({'message':'Invalid Id'},status=status.HTTP_404_NOT_FOUND)
            query_table=query_form(tok1,hierarchy_id,database_name)
            sheets_table,sheets_ids_list=sheets_data(query_table.queryset_id,tok1,hierarchy_id,database_name)
            dashboard_table=dashbaord_data(query_table.queryset_id,tok1,hierarchy_id,sheets_ids_list)
            pr_ids=dshb_models.parent_ids.objects.get(id=hierarchy_id)
            print("queryset_id",query_table.queryset_id)
            print("sheet_ids",sheets_ids_list)
            print("dashboard_id",dashboard_table.id)
            if pr_ids.parameter.upper()=="SERVER":
                srdt=dshb_models.ServerDetails.objects.get(id=pr_ids.table_id)
                srtp=dshb_models.ServerType.objects.get(id=srdt.server_type)
                parameter=srtp.server_type.upper()
            else:
                parameter=pr_ids.parameter.upper()
            dashb_data=quickbooks.temp_dashb_main(tok1,database_name,query_table,sheets_table,sheets_ids_list,dashboard_table,parameter)
            return dashb_data
        else:
            return Response(tok1,status=tok1['status'])
    else:
        return Response({'message':'Method not allowed'},status=status.HTTP_405_METHOD_NOT_ALLOWED)